"use strict";(self.webpackChunknexopos_4x=self.webpackChunknexopos_4x||[]).push([[256,33,409],{4678:(t,e,s)=>{function n(t){POS.changeVisibleSection(t)}s.d(e,{Z:()=>n})},282:(t,e,s)=>{function n(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}s.d(e,{Z:()=>r});var r=function(){function t(e){var s=e.urls,n=e.options;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.printingURL={refund:"refund_printing_url",sale:"sale_printing_url",payment:"payment_printing_url"},this.urls=s,this.options=n}var e,s,r;return e=t,s=[{key:"processRegularPrinting",value:function(t,e){var s=document.querySelector("#printing-section");s&&s.remove();var n=this.urls[this.printingURL[e]].replace("{reference_id}",t),r=document.createElement("iframe");r.id="printing-section",r.className="hidden",r.src=n,document.body.appendChild(r),setTimeout((function(){document.querySelector("#printing-section").remove()}),5e3)}},{key:"process",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"aloud";"default"===this.options.ns_pos_printing_gateway?this.processRegularPrinting(t,e):this.processCustomPrinting(t,this.options.ns_pos_printing_gateway,e,s)}},{key:"processCustomPrinting",value:function(t,e,s){var n={printed:!1,reference_id:t,gateway:e,document:s,mode:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"aloud"};nsHooks.applyFilters("ns-custom-print",{params:n,promise:function(){return new Promise((function(t,e){e({status:"failed",message:__("The selected print gateway doesn't support this type of printing.","NsPrintAdapter")})}))}}).promise().then((function(t){nsSnackBar.success(t.message).subscribe()})).catch((function(t){nsSnackBar.error(t.message||__("An error unexpected occured while printing.")).subscribe()}))}}],s&&n(e.prototype,s),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},5502:(t,e,s)=>{s.d(e,{$:()=>c});var n=s(7700),r=s(3632),i=s(6979),o=s(9958);function a(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.product=e}var e,s,c;return e=t,(s=[{key:"run",value:function(t){var e=this;return new Promise((function(s,a){var c=new i.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),l=e.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===l.$original().stock_management&&"materialized"===l.$original().type){var u=POS.getStockUsage(l.$original().id,t.unit_quantity_id)-(l.quantity||0);if(1>parseFloat(t.$quantities().quantity)-u)return n.kX.error((0,r.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(t.$quantities().quantity-u).toString())).subscribe()}s({quantity:1})}else c.open(o.Z,{resolve:s,reject:a,product:l,data:t})}))}}])&&a(e.prototype,s),c&&a(e,c),Object.defineProperty(e,"prototype",{writable:!1}),t}()},8909:(t,e,s)=>{s.d(e,{Z:()=>i});var n=s(3632);const r={name:"ns-numpad-plus",props:["value","currency","limit"],data:function(){return{screenValue:0,order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keyRows:[[7,8,9].map((function(t){return{identifier:t,value:t}})),[4,5,6].map((function(t){return{identifier:t,value:t}})),[1,2,3].map((function(t){return{identifier:t,value:t}})),[{identifier:".",value:"."},{identifier:0,value:0},{identifier:"backspace",icon:"la-backspace"}],[{identifier:"next",value:(0,n.__)("Enter")}]]}},mounted:function(){var t=this;this.screenValue=this.value||0;var e=new Array(10).fill("").map((function(t,e){return e}));nsHotPress.create("numpad-keys").whenVisible([".is-popup"]).whenPressed(e,(function(e,s){t.inputValue({value:s})})),nsHotPress.create("numpad-backspace").whenVisible([".is-popup"]).whenPressed("backspace",(function(){return t.inputValue({identifier:"backspace"})})),nsHotPress.create("numpad-increase").whenVisible([".is-popup"]).whenPressed("+",(function(){return t.increaseBy({value:1})})),nsHotPress.create("numpad-dot").whenVisible([".is-popup"]).whenPressed(".",(function(){return t.inputValue({identifier:"."})})),nsHotPress.create("numpad-reduce").whenVisible([".is-popup"]).whenPressed("-",(function(){return t.increaseBy({value:-1})})),nsHotPress.create("numpad-save").whenVisible([".is-popup"]).whenPressed("enter",(function(){return t.inputValue({identifier:"next"})}))},watch:{value:function(){this.value.toString().length>0?this.screenValue=this.value:this.screenValue=""}},beforeDestroy:function(){nsHotPress.destroy("numpad-backspace"),nsHotPress.destroy("numpad-increase"),nsHotPress.destroy("numpad-reduce"),nsHotPress.destroy("numpad-save"),nsHotPress.destroy("numpad-dot")},methods:{increaseBy:function(t){this.screenValue=(parseFloat(t.value)+(parseFloat(this.screenValue)||0)).toString(),this.allSelected=!1},inputValue:function(t){if("next"!==t.identifier){if("backspace"===t.identifier)this.allSelected?(this.screenValue="0",this.allSelected=!1):this.screenValue=this.screenValue.toString().substr(0,this.screenValue.length-1);else if("."===t.identifier)this.allSelected?(this.screenValue="0.",this.allSelected=!1):null===this.screenValue.toString().match(/^[0-9][1-9]*\.[0-9]*$/)&&(this.screenValue=this.screenValue+=".");else if(t.value.toString().match(/^\d+$/)){if(this.limit>0&&this.screenValue.length>=this.limit)return;this.allSelected?(this.screenValue=t.value.toString(),this.allSelected=!1):(this.screenValue+=""+t.value.toString(),"percentage"===this.mode&&(this.screenValue=this.screenValue>100?100:this.screenValue))}this.$emit("changed",this.screenValue)}else this.$emit("next",this.screenValue)}}};const i=(0,s(1900).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"numpad-holder"}},t._l(t.keyRows,(function(e,n){return s("div",{key:n},[s("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-1 text-lg",attrs:{id:"numpad"}},[t._l(e,(function(n,r){return s("div",{key:r,staticClass:"select-none ns-numpad-key border-l border-b h-24 font-bold flex items-center justify-center cursor-pointer",class:1===e.length?"col-span-3":"",on:{click:function(e){return t.inputValue(n)}}},[void 0!==n.value?s("span",[t._v(t._s(n.value))]):t._e(),t._v(" "),n.icon?s("i",{staticClass:"las",class:n.icon}):t._e()])})),t._v(" "),t._t("numpad-footer")],2)])})),0)}),[],!1,null,null,null).exports},5256:(t,e,s)=>{s.r(e),s.d(e,{default:()=>xt});var n=s(4687),r=s.n(n),i=s(6979),o=s(2830),a=s(3632);function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,n=new Array(e);s<e;s++)n[s]=t[s];return n}const u={name:"ns-pos-discount-popup",data:function(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[].concat(c([7,8,9].map((function(t){return{identifier:t,value:t}}))),c([4,5,6].map((function(t){return{identifier:t,value:t}}))),c([1,2,3].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var t=this;this.mode=this.$popupParams.reference.discount_type||"percentage",this.type=this.$popupParams.type,"percentage"===this.mode?this.finalValue=this.$popupParams.reference.discount_percentage||1:this.finalValue=this.$popupParams.reference.discount||1,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.$popup.close()}))},methods:{__:a.__,setPercentageType:function(t){this.mode=t},closePopup:function(){this.$popup.close()},inputValue:function(t){"next"===t.identifier?(this.$popupParams.onSubmit({discount_type:this.mode,discount_percentage:"percentage"===this.mode?this.finalValue:void 0,discount:"flat"===this.mode?this.finalValue:void 0}),this.$popup.close()):"backspace"===t.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=t.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+t.value,this.finalValue=parseFloat(this.finalValue),"percentage"===this.mode&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}};var d=s(1900);const p=(0,d.Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative",attrs:{id:"discount-popup"}},[s("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[s("div",["product"===t.type?s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Product Discount")))]):t._e(),t._v(" "),"cart"===t.type?s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Cart Discount")))]):t._e()]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"h-16 ns-box-body text-white flex items-center justify-center",attrs:{id:"screen"}},[s("h1",{staticClass:"font-bold text-3xl"},["flat"===t.mode?s("span",[t._v(t._s(t._f("currency")(t.finalValue)))]):t._e(),t._v(" "),"percentage"===t.mode?s("span",[t._v(t._s(t.finalValue)+"%")]):t._e()])]),t._v(" "),s("div",{staticClass:"flex",attrs:{id:"switch-mode"}},[s("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"flat"===t.mode?"bg-tab-active":"bg-tab-inactive text-tertiary",on:{click:function(e){return t.setPercentageType("flat")}}},[t._v(t._s(t.__("Flat")))]),t._v(" "),s("hr",{staticClass:"border-r border-box-edge"}),t._v(" "),s("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"percentage"===t.mode?"bg-tab-active":"bg-tab-inactive text-tertiary",on:{click:function(e){return t.setPercentageType("percentage")}}},[t._v(t._s(t.__("Percentage")))])]),t._v(" "),s("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},t._l(t.keys,(function(e,n){return s("div",{key:n,staticClass:"text-primary ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer",on:{click:function(s){return t.inputValue(e)}}},[void 0!==e.value?s("span",[t._v(t._s(e.value))]):t._e(),t._v(" "),e.icon?s("i",{staticClass:"las",class:e.icon}):t._e()])})),0)])}),[],!1,null,null,null).exports;var _=s(914),f=s(7700);function v(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,n=new Array(e);s<e;s++)n[s]=t[s];return n}const b={name:"sample-payment",props:["label","identifier"],data:function(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join("")),order:null,settings:{},settingsSubscription:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(v([7,8,9].map((function(t){return{identifier:t,value:t}}))),v([4,5,6].map((function(t){return{identifier:t,value:t}}))),v([1,2,3].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},computed:{amountShortcuts:function(){return null!==nsShortcuts.ns_pos_amount_shortcut?nsShortcuts.ns_pos_amount_shortcut.split("|"):[]}},mounted:function(){var t=this;this.orderSubscription=POS.order.subscribe((function(e){t.order=e})),this.settingsSubscription=POS.settings.subscribe((function(e){t.settings=e}));var e=new Array(10).fill("").map((function(t,e){return e}));nsHotPress.create("numpad-keys").whenVisible([".is-popup"]).whenPressed(e,(function(e,s){t.inputValue({value:s})})),nsHotPress.create("numpad-backspace").whenVisible([".is-popup"]).whenPressed("backspace",(function(){return t.inputValue({identifier:"backspace"})})),nsHotPress.create("numpad-save").whenVisible([".is-popup"]).whenPressed("enter",(function(){""===t.backValue?(t.$emit("submit"),t.backValue=0):t.inputValue({identifier:"next"})}))},beforeDestroy:function(){nsHotPress.destroy("numpad-keys"),nsHotPress.destroy("numpad-backspace"),nsHotPress.destroy("numpad-save")},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:a.__,toggleDiscount:function(){var t=this;if(void 0===this.settings.cart_discount||!0!==this.settings.cart_discount)return f.kX.error((0,a.__)("You're not allowed to add a discount on the cart.")).subscribe();i.G.show(p,{reference:this.order,type:"cart",onSubmit:function(e){POS.updateCart(t.order,e)}})},makeFullPayment:function(){var t=this;i.G.show(_.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("A full payment will be made using {paymentType} for {total}").replace("{paymentType}",this.label).replace("{total}",this.$options.filters.currency(this.order.total)),onAction:function(e){if(e){var s=POS.order.getValue();s.tendered<s.total&&POS.addPayment({value:t.order.total-s.tendered,identifier:t.identifier,selected:!1,label:t.label,readonly:!1}),t.$emit("submit"),t.backValue="0"}}})},increaseBy:function(t){var e=parseInt(1+new Array(this.cursor).fill("").map((function(t){return 0})).join(""));this.backValue=(parseFloat(t.value)*e+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue:function(t){"next"===t.identifier?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):"backspace"===t.identifier?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):t.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=t.value.toString(),this.allSelected=!1):(this.backValue+=t.value.toString(),"percentage"===this.mode&&(this.backValue=this.backValue>100?100:this.backValue))),"0"===this.backValue&&(this.backValue="")}}};const h=(0,d.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-full w-full pt-2"},[t.order?s("div",{staticClass:"pb-5"},[s("div",{staticClass:"grid grid-cols-4 gap-4 mb-4"},[s("div",{staticClass:"flex justify-between items-center payment-card payment-info",attrs:{id:"details"}},[s("span",{staticClass:"payment-card-text"},[t._v(t._s(t.__("Total"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),s("div",{staticClass:"cursor-pointer flex justify-between items-center payment-card payment-red",attrs:{id:"discount"},on:{click:function(e){return t.toggleDiscount()}}},[s("span",{staticClass:"payment-card-text"},[t._v(t._s(t.__("Discount"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.discount)))])]),t._v(" "),s("div",{staticClass:"flex justify-between items-center payment-card payment-success",attrs:{id:"paid"}},[s("span",{staticClass:"payment-card-text"},[t._v(t._s(t.__("Paid"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),s("div",{staticClass:"flex justify-between items-center payment-card payment-yellow",attrs:{id:"change"}},[s("span",{staticClass:"payment-card-text"},[t._v(t._s(t.__("Change"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.change)))])])]),t._v(" "),s("div",{staticClass:"col-span-2 flex screen-background justify-between items-center",attrs:{id:"change"}},[s("span",{staticClass:"screen-text"},[t._v(t._s(t.__("Screen"))+" : ")]),t._v(" "),s("span",{staticClass:"screen-price"},[t._v(t._s(t._f("currency")(t.backValue/t.number)))])])]):t._e(),t._v(" "),s("div",{staticClass:"flex flex-wrap keypad-border"},[s("div",{staticClass:"flex-auto"},[s("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-4 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[t._l(t.keys,(function(e,n){return s("div",{key:n,staticClass:"h-16 flex ns-keypad-box items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(s){return t.inputValue(e)}}},[void 0!==e.value?s("span",[t._v(t._s(e.value))]):t._e(),t._v(" "),e.icon?s("i",{staticClass:"las text-black",class:e.icon}):t._e()])})),t._v(" "),s("div",{staticClass:"green-button col-span-3 mt-3 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.makeFullPayment()}}},[t._v("\n                        "+t._s(t.__("Full Payment")))])],2)])])])}),[],!1,null,null,null).exports,y={name:"cash-payment",props:["identifier","label"],components:{samplePayment:h}};const x=(0,d.Z)(y,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("sample-payment",{attrs:{identifier:t.identifier,label:t.label},on:{submit:function(e){return t.$emit("submit")}}})}),[],!1,null,null,null).exports;const C={name:"creditcart-payment",props:["identifier"]};const w=(0,d.Z)(C,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("h1",[t._v("Credit Card")])}),[],!1,null,null,null).exports;const g={name:"bank-payment",props:["identifier","label"],components:{samplePayment:h}};const P=(0,d.Z)(g,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("sample-payment",{attrs:{identifier:t.identifier,label:t.label},on:{submit:function(e){return t.$emit("submit")}}})}),[],!1,null,null,null).exports;var k=s(7751);const S={name:"ns-account-payment",components:{nsNumpad:k.Z},props:["identifier","label"],data:function(){return{subscription:null,screenValue:0,order:null}},methods:{__:a.__,handleChange:function(t){this.screenValue=t},proceedAddingPayment:function(t){var e=parseFloat(t),s=this.order.payments;return e<=0?f.kX.error((0,a.__)("Please provide a valid payment amount.")).subscribe():s.filter((function(t){return"account-payment"===t.identifier})).length>0?f.kX.error((0,a.__)("The customer account can only be used once per order. Consider deleting the previously used payment.")).subscribe():e>this.order.customer.account_amount?f.kX.error((0,a.__)("Not enough funds to add {amount} as a payment. Available balance {balance}.").replace("{amount}",this.$options.filters.currency(e)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe():(POS.addPayment({value:e,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=e,POS.selectCustomer(this.order.customer),void this.$emit("submit"))},proceedFullPayment:function(){this.proceedAddingPayment(this.order.total)},makeFullPayment:function(){var t=this;Popup.show(_.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:function(e){e&&t.proceedFullPayment()}})}},mounted:function(){var t=this;this.subscription=POS.order.subscribe((function(e){return t.order=e}))},destroyed:function(){this.subscription.unsubscribe()}};const O=(0,d.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-full w-full py-2"},[t.order?s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"grid grid-cols-2 gap-2"},[s("div",{staticClass:"h-16 flex justify-between items-center elevation-surface border info text-xl md:text-3xl p-2",attrs:{id:"details"}},[s("span",[t._v(t._s(t.__("Total"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),s("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center elevation-surface error border text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(e){return t.toggleDiscount()}}},[s("span",[t._v(t._s(t.__("Discount"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.discount)))])]),t._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center elevation-surface success border text-xl md:text-3xl p-2",attrs:{id:"paid"}},[s("span",[t._v(t._s(t.__("Paid"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center elevation-surface warning border text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[t._v(t._s(t.__("Change"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.change)))])]),t._v(" "),s("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border success text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[t._v(t._s(t.__("Current Balance"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.customer.account_amount)))])]),t._v(" "),s("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-primary text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[t._v(t._s(t.__("Screen"))+" : ")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.screenValue)))])])])]):t._e(),t._v(" "),s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"pl-2 pr-1 flex-auto"},[s("ns-numpad",{attrs:{floating:!0},on:{changed:function(e){return t.handleChange(e)},next:function(e){return t.proceedAddingPayment(e)}},scopedSlots:t._u([{key:"numpad-footer",fn:function(){return[s("div",{staticClass:"hover:bg-success-tertiary col-span-3 bg-success-secondary text-2xl text-white border border-success-secondary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.makeFullPayment()}}},[t._v("\n                        "+t._s(t.__("Full Payment")))])]},proxy:!0}])})],1),t._v(" "),s("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[s("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:100})}}},[s("span",[t._v(t._s(t._f("currency")(100)))])]),t._v(" "),s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:500})}}},[s("span",[t._v(t._s(t._f("currency")(500)))])]),t._v(" "),s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:1e3})}}},[s("span",[t._v(t._s(t._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports;var j=s(409),T=s(2614);function $(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function V(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$(Object(s),!0).forEach((function(e){A(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function A(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function Z(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}const D={name:"ns-pos-payment",data:function(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null}},computed:{activePayment:function(){var t;return(t=this.paymentsType.filter((function(t){return t.selected}))).length>0&&t[0]},expectedPayment:function(){var t=this.order.customer.group.minimal_credit_payment;return this.order.total*t/100}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){if("click-overlay"===e.event)t.closePopup()})),this.order=this.$popupParams.order,this.paymentTypesSubscription=POS.paymentsType.subscribe((function(e){t.paymentsType=e,e.filter((function(t){t.selected&&POS.selectedPaymentType.next(t)}))})),nsHooks.doAction("ns-pos-payment-mounted",this)},watch:{activePayment:function(t){this.loadPaymentComponent(t)}},destroyed:function(){this.paymentTypesSubscription.unsubscribe(),nsHooks.doAction("ns-pos-payment-destroyed",this)},methods:{__:a.__,resolveIfQueued:o.Z,loadPaymentComponent:function(t){switch(t.identifier){case"cash-payment":this.currentPaymentComponent=x;break;case"creditcard-payment":this.currentPaymentComponent=w;break;case"bank-payment":this.currentPaymentComponent=P;break;case"account-payment":this.currentPaymentComponent=O;break;default:this.currentPaymentComponent=h}},selectPayment:function(){var t,e=this;return(t=r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,s){i.G.show(T.Z,{label:(0,a.__)("Select Payment Gateway"),options:e.paymentsType.map((function(t){return{label:t.label,value:t.identifier}})),value:e.activePayment.identifier,resolve:t,reject:s})}));case 3:s=t.sent,e.select(e.paymentsType.filter((function(t){return t.identifier===s[0].value}))[0]),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(t){Z(i,n,r,o,a,"next",t)}function a(t){Z(i,n,r,o,a,"throw",t)}o(void 0)}))})()},select:function(t){this.showPayment=!1,POS.setPaymentActive(t)},closePopup:function(){this.$popup.close(),POS.selectedPaymentType.next(null)},deletePayment:function(t){POS.removePayment(t)},selectPaymentAsActive:function(t){this.select(this.paymentsType.filter((function(e){return e.identifier===t.target.value}))[0])},submitOrder:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=i.G.show(j.default);try{var n=V(V({},POS.order.getValue()),e);POS.submitOrder(n).then((function(e){s.close(),f.kX.success(e.message).subscribe(),POS.printOrderReceipt(e.data.order,"silent"),t.$popup.close()}),(function(t){s.close(),f.kX.error(t.message).subscribe()}))}catch(t){s.close(),f.kX.error(error.message).subscribe()}}}};const F=(0,d.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.order?s("div",{staticClass:"shadow-lg rounded modal-customers-width flex flex-col overflow-hidden",attrs:{id:"ns-payment-popup"}},[s("div",{staticClass:"ns-header p-2 flex justify-between items-center border-b"},[s("h3",{staticClass:"font-semibold"},[t._v("Payment")]),t._v(" "),s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1),t._v(" "),s("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[s("div",{staticClass:"flex flex-col flex-auto overflow-hidden pt-5 px-5"},[s("div",{staticClass:"flex justify-between items-center gray-border mb-5"},[s("ul",{staticClass:"hidden lg:flex"},t._l(t.paymentsType,(function(e){return s("li",{key:e.identifier,staticClass:"cursor-pointer ns-payment-gateway",class:e.selected&&!t.showPayment?"ns-visible":"",on:{click:function(s){return t.select(e)}}},[t._v(t._s(e.label))])})),0),t._v(" "),s("div",{staticClass:"cursor-pointer ns-payment-box",class:t.showPayment?"ns-visible":"",on:{click:function(e){t.showPayment=!0}}},[s("span",{staticClass:"mr-3"},[t._v(t._s(t.__("Payment List")))]),t._v(" "),s("span",{staticClass:"rounded-full h-6 w-6 flex items-center justify-center ns-label"},[t._v(t._s(t.order.payments.length))])])]),t._v(" "),s("div"),t._v(" "),t.showPayment?t._e():s("div",{staticClass:"flex flex-auto overflow-y-auto"},[s(t.currentPaymentComponent,{tag:"component",attrs:{label:t.activePayment.label,identifier:t.activePayment.identifier},on:{submit:function(e){return t.submitOrder()}}})],1),t._v(" "),t.showPayment?s("div",{staticClass:"flex flex-auto overflow-y-auto p-2 flex-col"},[s("h3",{staticClass:"text-center font-bold py-2"},[t._v(t._s(t.__("List Of Payments")))]),t._v(" "),s("ul",{staticClass:"flex-auto"},[0===t.order.payments.length?s("li",{staticClass:"p-2 flex justify-center mb-2 items-center"},[s("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("No Payment added.")))])]):t._e(),t._v(" "),t._l(t.order.payments,(function(e,n){return s("li",{key:n,staticClass:"p-2 flex justify-between mb-2 items-center"},[s("span",[t._v(t._s(e.label))]),t._v(" "),s("div",{staticClass:"flex items-center"},[s("span",[t._v(t._s(t._f("currency")(e.value)))]),t._v(" "),s("button",{staticClass:"rounded-full h-8 w-8 flex items-center justify-center ml-2",on:{click:function(s){return t.deletePayment(e)}}},[s("i",{staticClass:"las la-trash-alt"})])])])}))],2)]):t._e()]),t._v(" "),s("div",{staticClass:"flex lg:hidden ns-payment-buttons"},[s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 font-bold ns-payment-type-button",on:{click:function(e){return t.selectPayment()}}},[s("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Payment Type")))])]),t._v(" "),t.order.tendered>=t.order.total?s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-submit-button font-bold",on:{click:function(e){return t.submitOrder()}}},[s("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Submit Payment")))])]):t._e(),t._v(" "),t.order.tendered<t.order.total?s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-layaway-button font-bold",on:{click:function(e){return t.submitOrder({payment_status:"unpaid"})}}},[s("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Layaway")))])]):t._e(),t._v(" "),s("button",{staticClass:"w-1/3 flex ns-payment-button text-2xl flex-auto h-12 items-center justify-center font-bold",on:{click:function(e){t.showPayment=!0}}},[s("span",{staticClass:"text-sm mr-1"},[t._v(t._s(t.__("Payment List")))]),t._v(" "),s("span",{staticClass:"px-2 rounded-full h-6 w-6 text-xs flex items-center justify-center ns-label"},[t._v(t._s(t.order.payments.length))])])]),t._v(" "),s("div",{staticClass:"flex-col sm:flex-row w-full justify-center p-5 hidden lg:flex"},[s("div",{staticClass:"flex justify-end"},[t.order.tendered>=t.order.total?s("ns-button",{attrs:{type:t.order.tendered>=t.order.total?"success":"info"},on:{click:function(e){return t.submitOrder()}}},[s("span",[s("i",{staticClass:"las la-cash-register"}),t._v(" "+t._s(t.__("Submit Payment")))])]):t._e(),t._v(" "),t.order.tendered<t.order.total?s("ns-button",{attrs:{type:t.order.tendered>=t.order.total?"success":"info"},on:{click:function(e){return t.submitOrder({payment_status:"unpaid"})}}},[s("span",[t._v(t._s(t.__("Layaway"))+" — "+t._s(t._f("currency")(t.expectedPayment)))])]):t._e()],1)])])]):t._e()}),[],!1,null,null,null).exports;s(9958);var E=s(5502),R=s(4523),q=s(3815);function N(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var I=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,s,n;return e=t,(s=[{key:"run",value:function(){var t=this;return new Promise((function(e,s){return 0===t.order.products.length?(f.kX.error((0,a.__)("You need to provide some products before proceeding.")).subscribe(),s(!1)):e(!0)}))}}])&&N(e.prototype,s),n&&N(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}window.ProductsQueue=I;var H=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,s,n;return e=t,(s=[{key:"run",value:function(){var t=this;return new Promise((function(e,s){return void 0===t.order.customer?i.G.show(q.Z,{resolve:e,reject:s}):e(!0)}))}}])&&X(e.prototype,s),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Q(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}window.CustomerQueue=H;var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,s,n;return e=t,(s=[{key:"run",value:function(){var t=this;return new Promise((function(e,s){i.G.show(F,{resolve:e,reject:s,order:t.order})}))}}])&&Q(e.prototype,s),n&&Q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function L(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}window.PaymentQueue=G;var U=s(4523).Z,Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,s,n;return e=t,(s=[{key:"run",value:function(){var t=this;return new Promise((function(e,s){if(void 0===t.order.type)return i.G.show(U,{resolve:e,reject:s});e(!0)}))}}])&&L(e.prototype,s),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();window.TypeQueue=Y;var W=s(4678),M=s(6071),z=s(665);const B={name:"ns-pos-hold-orders",data:function(){return{order:{},title:"",show:!0}},mounted:function(){this.popupCloser(),this.show=POS.getHoldPopupEnabled(),this.show||this.$popupParams.resolve({title:this.title}),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.$popupParams.order,this.title=this.$popupParams.order.title||""},methods:{__:a.__,popupCloser:z.Z,submitHold:function(){this.$popup.close(),this.$popupParams.resolve({title:this.title})}}};const J=(0,d.Z)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},[s("div",{staticClass:"p-2 flex ns-box-header justify-between border-b items-center"},[s("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Hold Order")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto ns-box-body"},[s("div",{staticClass:"border-b h-16 flex items-center justify-center"},[s("span",{staticClass:"text-5xl text-primary"},[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),s("div",{staticClass:"p-2"},[s("div",{staticClass:"input-group border-2 info"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],ref:"reference",staticClass:"outline-none rounded border-2 p-2 w-full",attrs:{type:"text",placeholder:"Order Reference"},domProps:{value:t.title},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitHold()},input:function(e){e.target.composing||(t.title=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"p-2"},[s("p",{staticClass:"text-secondary"},[t._v("\n                "+t._s(t.__("The current order will be set on hold. You can retrieve this order from the pending order button. Providing a reference to it might help you to identify the order more quickly."))+"\n            ")])])]),t._v(" "),s("div",{staticClass:"flex ns-box-footer"},[s("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold",on:{click:function(e){return t.submitHold()}}},[t._v("\n            "+t._s(t.__("Confirm"))+"\n        ")]),t._v(" "),s("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-error-secondary text-white font-semibold",on:{click:function(e){return t.$popup.close()}}},[t._v("\n            "+t._s(t.__("Cancel"))+"\n        ")])])])}),[],!1,null,null,null).exports;var K=s(4679);const tt={name:"ns-pos-note-popup",data:function(){return{validation:new K.Z,fields:[{label:(0,a.__)("Note"),name:"note",value:"",description:(0,a.__)("More details about this order"),type:"textarea"},{label:(0,a.__)("Display On Receipt"),name:"note_visibility",value:"",options:[{label:(0,a.__)("Yes"),value:"visible"},{label:(0,a.__)("No"),value:"hidden"}],description:(0,a.__)("Will display the note on the receipt"),type:"switch"}]}},mounted:function(){var t=this;this.popupCloser(),this.fields.forEach((function(e){"note"===e.name?e.value=t.$popupParams.note:"note_visibility"===e.name&&(e.value=t.$popupParams.note_visibility)}))},methods:{__:a.__,popupResolver:o.Z,popupCloser:z.Z,closePopup:function(){this.popupResolver(!1)},saveNote:function(){if(!this.validation.validateFields(this.fields)){var t=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,t),this.$forceUpdate(),console.log(this.fields),f.kX.error((0,a.__)("Unable to proceed the form is not valid.")).subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}};const et=(0,d.Z)(tt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 flex justify-between items-center border-b ns-box-header"},[s("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Order Note")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"p-2"},t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),s("div",{staticClass:"p-2 flex justify-end border-t ns-box-footer"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveNote()}}},[t._v("Save")])],1)])}),[],!1,null,null,null).exports;const st={name:"ns-pos-tax-popup",data:function(){return{validation:new K.Z,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_groups:[],activeTab:"",group_fields:[{label:(0,a.__)("Select Tax"),name:"tax_group_id",description:(0,a.__)("Define the tax that apply to the sale."),type:"select",disabled:!0,value:"",validation:"required",options:[]},{label:(0,a.__)("Type"),name:"tax_type",disabled:!0,value:"",description:(0,a.__)("Define how the tax is computed"),type:"select",validation:"required",options:[{label:(0,a.__)("Exclusive"),value:"exclusive"},{label:(0,a.__)("Inclusive"),value:"inclusive"}]}]}},mounted:function(){var t=this;this.loadGroups(),this.popupCloser(),this.activeTab=this.$popupParams.activeTab||"settings",this.group_fields.forEach((function(e){e.value=t.$popupParams[e.name]||void 0})),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e})),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e,["variable_vat","products_variable_vat"].includes(t.options.ns_pos_vat)&&t.group_fields.forEach((function(t){return t.disabled=!1}))}))},destroyed:function(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:a.__,popupCloser:z.Z,popupResolver:o.Z,changeActive:function(t){this.activeTab=t},closePopup:function(){this.popupResolver(!1)},saveTax:function(){if(!this.validation.validateFields(this.group_fields))return f.kX.error((0,a.__)("Unable to proceed the form is not valid.")).subscribe();var t=this.validation.extractFields(this.group_fields);t.tax_groups=[],this.popupResolver(t)},loadGroups:function(){var t=this;f.ih.get("/api/nexopos/v4/taxes/groups").subscribe((function(e){t.groups=e,t.group_fields.forEach((function(e){"tax_group_id"===e.name&&(e.options=t.groups.map((function(t){return{label:t.name,value:t.id}})))}))}))}}};const nt=(0,d.Z)(st,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 flex justify-between items-center border-b ns-box-header"},[s("h3",{staticClass:"text-blog"},[t._v(t._s(t.__("Tax & Summary")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"p-2 ns-box-body"},[s("ns-tabs",{attrs:{active:t.activeTab},on:{changeTab:function(e){return t.changeActive(e)}}},[s("ns-tabs-item",{attrs:{padding:"0",label:t.__("Settings"),identifier:"settings",active:!0}},[s("div",{staticClass:"p-2 border-b ns-box-body"},t._l(t.group_fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),s("div",{staticClass:"flex justify-end p-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveTax()}}},[t._v(t._s(t.__("Save")))])],1)]),t._v(" "),s("ns-tabs-item",{attrs:{padding:"0",label:t.__("Summary"),identifier:"summary",active:!1}},[t.order?s("div",{staticClass:"p-2"},[t._l(t.order.taxes,(function(e){return s("div",{key:e.id,staticClass:"mb-2 border shadow p-2 w-full flex justify-between items-center elevation-surface",staticStyle:{color:"rgb(0 0 0)"}},[s("span",[t._v(t._s(e.tax_name))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(e.tax_value)))])])})),t._v(" "),0===t.order.taxes.length?s("div",{staticClass:"p-2 text-center text-primary"},[t._v(t._s(t.__("No tax is active")))]):t._e()],2):t._e()]),t._v(" "),s("ns-tabs-item",{attrs:{padding:"0",label:t.__("Product Taxes"),identifier:"product_taxes",active:!1}},[t.order?s("div",{staticClass:"p-2"},[s("div",{staticClass:"border shadow p-2 w-full flex justify-between items-center elevation-surface",staticStyle:{color:"rgb(0 0 0)"}},[s("span",[t._v(t._s(t.__("Exclusive Taxes")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.products_exclusive_tax_value)))])]),t._v(" "),s("div",{staticClass:"border shadow p-2 w-full flex justify-between items-center elevation-surface",staticStyle:{color:"rgb(0 0 0)"}},[s("span",[t._v(t._s(t.__("Inclusive Taxes")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.products_inclusive_tax_value)))])])]):t._e()])],1)],1)])}),[],!1,null,null,null).exports;var rt=s(3630);const it={name:"ns-pos-order-settings",mounted:function(){var t=this;nsHttpClient.get("/api/nexopos/v4/fields/ns.pos-order-settings").subscribe((function(e){e.forEach((function(e){e.value=t.$popupParams.order[e.name]||""})),t.fields=t.validation.createFields(e)}),(function(t){})),this.popupCloser()},data:function(){return{fields:[],validation:new K.Z}},methods:{__,popupCloser,popupResolver,closePopup:function(){this.popupResolver(!1)},saveSettings:function(){var t=this.validation.extractFields(this.fields);this.popupResolver(t)}}};const ot=(0,d.Z)(it,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg flex flex-col ns-box w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 border-b ns-box-header items-center flex justify-between"},[s("h3",{staticClass:"text-semibold"},[t._v(t._s(t.__("Order Settings")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"p-2 flex-auto border-b ns-box-body overflow-y-auto"},t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),s("div",{staticClass:"p-2 flex justify-end ns-box-footer"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveSettings()}}},[t._v(t._s(t.__("Save")))])],1)])}),[],!1,null,null,null).exports;var at=s(8909);const ct={name:"ns-pos-product-price-product",components:{nsNumpad:k.Z,nsNumpadPlus:at.Z},computed:{},data:function(){return{product:{},optionsSubscription:null,options:{}}},mounted:function(){var t=this;this.popupCloser(),this.product=this.$popupParams.product,this.optionsSubscription=POS.options.subscribe((function(e){t.options=e}))},beforeDestroy:function(){this.optionsSubscription.unsubscribe()},methods:{popupResolver,popupCloser,__,updateProductPrice:function(t){this.product.unit_price=t},resolveProductPrice:function(t){this.popupResolver(this.product.unit_price)}}};const lt=(0,d.Z)(ct,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"popup-heading ns-box-header"},[s("h3",[t._v(t._s(t.__("Product Price")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.popupResolver(!1)}}})],1)]),t._v(" "),s("div",{staticClass:"flex flex-col ns-box-body"},[s("div",{staticClass:"h-16 flex items-center justify-center elevation-surface info font-bold"},[s("h2",{staticClass:"text-2xl"},[t._v(t._s(t._f("currency")(t.product.unit_price)))])]),t._v(" "),"default"===t.options.ns_pos_numpad?s("ns-numpad",{attrs:{floating:t.options.ns_pos_allow_decimal_quantities,value:t.product.unit_price},on:{changed:function(e){return t.updateProductPrice(e)},next:function(e){return t.resolveProductPrice(e)}}}):t._e(),t._v(" "),"advanced"===t.options.ns_pos_numpad?s("ns-numpad-plus",{attrs:{value:t.product.unit_price},on:{changed:function(e){return t.updateProductPrice(e)},next:function(e){return t.resolveProductPrice(e)}}}):t._e()],1)])}),[],!1,null,null,null).exports;var ut=s(2277);function dt(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}const pt={name:"ns-pos-quick-product-popup",methods:{__:a.__,popupCloser:z.Z,popupResolver:o.Z,close:function(){this.popupResolver(!1)},addProduct:function(){var t,e=this;return(t=r().mark((function t(){var s,n,i,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.validation.extractFields(e.fields),n=e.fields.filter((function(t){return void 0===t.show||"function"==typeof t.show&&t.show(s)})),e.validation.validateFields(n)){t.next=5;break}return t.abrupt("return",f.kX.error((0,a.__)("Unable to proceed. The form is not valid.")).subscribe());case 5:return(i=e.validation.extractFields(n)).$original=function(){return{stock_management:"disabled",category_id:0,tax_group:e.tax_groups.filter((function(t){return parseInt(t.id)===parseInt(i.tax_group_id)}))[0],tax_group_id:i.tax_group_id,tax_type:i.tax_type}},"product"===i.product_type?(i.unit_name=e.units.filter((function(t){return t.id===i.unit_id}))[0].name,i.quantity=parseFloat(i.quantity),i.unit_price=parseFloat(i.unit_price),i.mode="custom",i.price_with_tax=i.unit_price,i.price_without_tax=i.unit_price,i.tax_value=0):(i.unit_name=(0,a.__)("N/A"),i.unit_price=0,i.quantity=1),t.next=10,POS.defineQuantities(i,e.units);case 10:o=t.sent,i.$quantities=function(){return o},i=POS.computeProductTax(i),POS.addToCart(i),e.close();case 15:case"end":return t.stop()}}),t)})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(t){dt(i,n,r,o,a,"next",t)}function a(t){dt(i,n,r,o,a,"throw",t)}o(void 0)}))})()},loadData:function(){var t=this;this.loaded=!1,(0,ut.D)(nsHttpClient.get("/api/nexopos/v4/units"),nsHttpClient.get("/api/nexopos/v4/taxes/groups")).subscribe({next:function(e){t.units=e[0],t.tax_groups=e[1],t.fields.filter((function(t){"tax_group_id"===t.name&&(t.options=e[1].map((function(t){return{label:t.name,value:t.id}}))),"unit_id"===t.name&&(t.options=e[0].map((function(t){return{label:t.name,value:t.id}})))})),t.buildForm()},error:function(t){}})},buildForm:function(){this.fields=this.validation.createFields(this.fields),this.loaded=!0}},computed:{form:function(){return this.validation.extractFields(this.fields)}},data:function(){return{units:[],tax_groups:[],loaded:!1,validation:new K.Z,fields:[{label:(0,a.__)("Name"),name:"name",type:"text",description:(0,a.__)("Provide a unique name for the product."),validation:"required"},{label:(0,a.__)("Product Type"),name:"product_type",type:"select",description:(0,a.__)("Define the product type."),options:[{label:(0,a.__)("Normal"),value:"product"},{label:(0,a.__)("Dynamic"),value:"dynamic"}],value:"product",validation:"required"},{label:(0,a.__)("Rate"),name:"rate",type:"text",description:(0,a.__)("In case the product is computed based on a percentage, define the rate here."),validation:"required",show:function(t){return"dynamic"===t.product_type}},{label:(0,a.__)("Unit Price"),name:"unit_price",type:"text",description:(0,a.__)("Define what is the sale price of the item."),validation:"",show:function(t){return"product"===t.product_type}},{label:(0,a.__)("Quantity"),name:"quantity",type:"text",value:1,description:(0,a.__)("Set the quantity of the product."),validation:"",show:function(t){return"product"===t.product_type}},{label:(0,a.__)("Unit"),name:"unit_id",type:"select",options:[],description:(0,a.__)("Assign a unit to the product."),validation:"",show:function(t){return"product"===t.product_type}},{label:(0,a.__)("Tax Type"),name:"tax_type",type:"select",options:[{label:(0,a.__)("Disabled"),value:""},{label:(0,a.__)("Inclusive"),value:"inclusive"},{label:(0,a.__)("Exclusive"),value:"exclusive"}],description:(0,a.__)("Define what is tax type of the item."),show:function(t){return"product"===t.product_type}},{label:(0,a.__)("Tax Group"),name:"tax_group_id",type:"select",options:[],description:(0,a.__)("Choose the tax group that should apply to the item."),show:function(t){return"product"===t.product_type}}]}},mounted:function(){this.popupCloser(),this.loadData()}};const _t=(0,d.Z)(pt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-95vw flex flex-col h-95vh shadow-lg md:w-3/5-screen lg:w-2/5-screen md:h-3/5-screen ns-box"},[s("div",{staticClass:"header ns-box-header border-b flex justify-between p-2 items-center"},[s("h3",[t._v(t._s(t.__("Product / Service")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"ns-box-body p-2 flex-auto overflow-y-auto"},[t.loaded?t._e():s("div",{staticClass:"h-full w-full flex justify-center items-center"},[s("ns-spinner")],1),t._v(" "),t.loaded?[t._l(t.fields,(function(e,n){return[e.show&&e.show(t.form)||!e.show?s("ns-field",{key:n,attrs:{field:e}}):t._e()]}))]:t._e()],2),t._v(" "),s("div",{staticClass:"ns-box-footer border-t flex justify-between p-2"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Create")))])],1)])])}),[],!1,null,null,null).exports;function ft(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function vt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(s),!0).forEach((function(e){mt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function mt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function bt(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}function ht(t){return function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(t){bt(i,n,r,o,a,"next",t)}function a(t){bt(i,n,r,o,a,"throw",t)}o(void 0)}))}}const yt={name:"ns-pos-cart",data:function(){return{popup:null,products:[],visibleSection:null,visibleSectionSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:{},productImage:{galleries:[{url:"http://shishkabsa.touchpaysa.com/storage/2023/07/sandw.jpg"}]}}},computed:{selectedType:function(){return this.order.type?this.order.type.label:"N/A"},isVisible:function(){return"cart"===this.visibleSection},customerName:function(){return this.order.customer?this.order.customer.name:"N/A"},couponName:function(){return(0,a.__)("Apply Coupon")}},mounted:function(){var t=this;for(var e in this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),this.typeSubscribe=POS.types.subscribe((function(e){return t.types=e})),this.orderSubscribe=POS.order.subscribe((function(e){t.order=e})),this.productSubscribe=POS.products.subscribe((function(e){t.products=e,t.$forceUpdate()})),this.settingsSubscribe=POS.settings.subscribe((function(e){t.settings=e})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(e){t.visibleSection=e})),nsShortcuts)["ns_pos_keyboard_hold_order"].includes(e)&&nsHotPress.create("ns_pos_keyboard_hold_order").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.holdOrder()})),["ns_pos_keyboard_payment"].includes(e)&&nsHotPress.create("ns_pos_keyboard_payment").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.payOrder()})),["ns_pos_keyboard_shipping"].includes(e)&&nsHotPress.create("ns_pos_keyboard_shipping").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.openShippingPopup()})),["ns_pos_keyboard_note"].includes(e)&&nsHotPress.create("ns_pos_keyboard_note").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.openNotePopup()}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe(),nsHotPress.destroy("ns_pos_keyboard_hold_order"),nsHotPress.destroy("ns_pos_keyboard_payment"),nsHotPress.destroy("ns_pos_keyboard_shipping"),nsHotPress.destroy("ns_pos_keyboard_note")},methods:{__:a.__,switchTo:W.Z,openAddQuickProduct:function(){new Promise((function(t,e){i.G.show(_t,{resolve:t,reject:e})})).then((function(t){})).catch((function(t){}))},getHttpsUrl:function(t){return t.replace("http://","https://")},summarizeCoupons:function(){var t=this.order.coupons.map((function(t){return t.value}));return t.length>0?t.reduce((function(t,e){return t+e})):0},changeProductPrice:function(t){var e=this;return ht(r().mark((function s(){var n,o;return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e.settings.edit_purchase_price){s.next=2;break}return s.abrupt("return",f.kX.error((0,a.__)("You don't have the right to edit the purchase price.")).subscribe());case 2:if("dynamic"!==t.product_type){s.next=4;break}return s.abrupt("return",f.kX.error((0,a.__)("Dynamic product can't have their price updated.")).subscribe());case 4:if(!e.settings.unit_price_editable){s.next=25;break}return s.prev=5,s.next=8,new Promise((function(e,s){return i.G.show(lt,{product:Object.assign({},t),resolve:e,reject:s})}));case 8:return n=s.sent,o=vt(vt({},t.$quantities()),{custom_price_edit:n}),t.$quantities=function(){return o},t.mode="custom",t=POS.computeProductTax(t),POS.recomputeProducts(POS.products.getValue()),POS.refreshCart(),s.abrupt("return",f.kX.success((0,a.__)("The product price has been updated.")).subscribe());case 18:if(s.prev=18,s.t0=s.catch(5),!1===s.t0){s.next=23;break}throw f.kX.error(s.t0).subscribe(),s.t0;case 23:s.next=26;break;case 25:return s.abrupt("return",f.kX.error((0,a.__)("The editable price feature is disabled.")).subscribe());case 26:case"end":return s.stop()}}),s,null,[[5,18]])})))()},selectCoupon:function(){return ht(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){i.G.show(rt.Z,{resolve:t,reject:e})}));case 3:t.sent,t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))()},defineOrderSettings:function(){var t=this;return ht(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.settings.edit_settings){e.next=2;break}return e.abrupt("return",f.kX.error((0,a.__)("You're not allowed to edit the order settings.")).subscribe());case 2:return e.prev=2,e.next=5,new Promise((function(e,s){i.G.show(ot,{resolve:e,reject:s,order:t.order})}));case 5:s=e.sent,POS.order.next(vt(vt({},t.order),s)),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,null,[[2,9]])})))()},openNotePopup:function(){var t=this;return ht(r().mark((function e(){var s,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,s){var n=t.order.note,r=t.order.note_visibility;i.G.show(et,{resolve:e,reject:s,note:n,note_visibility:r})}));case 3:s=e.sent,n=vt(vt({},t.order),s),POS.order.next(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),!1!==e.t0&&f.kX.error(e.t0.message).subscribe();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},selectTaxGroup:function(){var t=arguments,e=this;return ht(r().mark((function s(){var n,o,a;return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:"settings",s.prev=1,s.next=4,new Promise((function(t,s){var r=e.order.taxes,o=e.order.tax_group_id,a=e.order.tax_type;i.G.show(nt,{resolve:t,reject:s,taxes:r,tax_group_id:o,tax_type:a,activeTab:n})}));case 4:o=s.sent,a=vt(vt({},e.order),o),POS.order.next(a),POS.refreshCart(),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(1),console.error(s.t0);case 13:case"end":return s.stop()}}),s,null,[[1,10]])})))()},openTaxSummary:function(){this.selectTaxGroup("summary")},voidOngoingOrder:function(){POS.voidOrder(this.order)},holdOrder:function(){var t=this;return ht(r().mark((function e(){var s,n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("hold"!==t.order.payment_status&&t.order.payments.length>0)){e.next=2;break}return e.abrupt("return",f.kX.error((0,a.__)("Unable to hold an order which payment status has been updated already.")).subscribe());case 2:s=f.kq.applyFilters("ns-hold-queue",[I,H,Y]),e.t0=r().keys(s);case 4:if((e.t1=e.t0()).done){e.next=18;break}return n=e.t1.value,e.prev=6,o=new s[n](t.order),e.next=10,o.run();case 10:e.sent,e.next=16;break;case 13:return e.prev=13,e.t2=e.catch(6),e.abrupt("return",!1);case 16:e.next=4;break;case 18:f.kq.applyFilters("ns-override-hold-popup",(function(){new Promise((function(e,s){i.G.show(J,{resolve:e,reject:s,order:t.order})})).then((function(e){t.order.title=e.title,t.order.payment_status="hold",POS.order.next(t.order);var s=i.G.show(j.default);POS.submitOrder().then((function(t){s.close(),POS.printOrderReceipt(t.data.order,"silent"),f.kX.success(t.message).subscribe()}),(function(t){s.close(),POS.printOrderReceipt(e.data.order,"silent"),f.kX.error(t.message).subscribe()}))}))}))();case 20:case"end":return e.stop()}}),e,null,[[6,13]])})))()},openDiscountPopup:function(t,e){return this.settings.products_discount||"product"!==e?this.settings.cart_discount||"cart"!==e?void i.G.show(p,{reference:t,type:e,onSubmit:function(s){"product"===e?POS.updateProduct(t,s):"cart"===e&&POS.updateCart(t,s)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"}):f.kX.error((0,a.__)("You're not allowed to add a discount on the cart.")).subscribe():f.kX.error((0,a.__)("You're not allowed to add a discount on the product.")).subscribe()},selectCustomer:function(){i.G.show(q.Z)},toggleMode:function(t){if(!this.options.ns_pos_allow_wholesale_price)return f.kX.error((0,a.__)("Unable to change the price mode. This feature has been disabled.")).subscribe();"normal"===t.mode?i.G.show(_.default,{title:(0,a.__)("Enable WholeSale Price"),message:(0,a.__)("Would you like to switch to wholesale price ?"),onAction:function(e){e&&POS.updateProduct(t,{mode:"wholesale"})}}):i.G.show(_.default,{title:(0,a.__)("Enable Normal Price"),message:(0,a.__)("Would you like to switch to normal price ?"),onAction:function(e){e&&POS.updateProduct(t,{mode:"normal"})}})},remove:function(t){i.G.show(_.default,{title:(0,a.__)("Confirm Your Action"),message:(0,a.__)("Would you like to delete this product ?"),onAction:function(e){e&&POS.removeProduct(t)}})},allowQuantityModification:function(t){return"product"===t.product_type},changeQuantity:function(t){this.allowQuantityModification(t)&&new E.$(t).run({unit_quantity_id:t.unit_quantity_id,unit_name:t.unit_name,$quantities:t.$quantities}).then((function(e){POS.updateProduct(t,e)}))},plusQuantity:function(t){if(this.allowQuantityModification(t)){var e=t.quantity+=1;POS.updateProduct(t,e)}},minusQuantity:function(t){if(t.quantity>1&&this.allowQuantityModification(t)){var e=t.quantity-=1;POS.updateProduct(t,e)}},payOrder:function(){var t=this;return ht(r().mark((function e(){var s,n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=f.kq.applyFilters("ns-pay-queue",[I,H,Y,G]),e.t0=r().keys(s);case 2:if((e.t1=e.t0()).done){e.next=16;break}return n=e.t1.value,e.prev=4,i=new s[n](t.order),e.next=8,i.run();case 8:e.sent,e.next=14;break;case 11:return e.prev=11,e.t2=e.catch(4),e.abrupt("return",!1);case 14:e.next=2;break;case 16:case"end":return e.stop()}}),e,null,[[4,11]])})))()},openOrderType:function(){i.G.show(R.Z)},openShippingPopup:function(){i.G.show(M.Z)}}};const xt=(0,d.Z)(yt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-cart"}},["cart"===t.visibleSection?s("div",{staticClass:"flex pl-2 ns-tab",attrs:{id:"tools"}},[s("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold active tab",on:{click:function(e){return t.switchTo("cart")}}},[s("span",[t._v(t._s(t.__("Cart")))]),t._v(" "),t.order?s("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[t._v(t._s(t.order.products.length))]):t._e()]),t._v(" "),s("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 border-t border-r border-l inactive tab",on:{click:function(e){return t.switchTo("grid")}}},[t._v("\n            "+t._s(t.__("Products"))+"\n        ")])]):t._e(),t._v(" "),s("div",{staticClass:"rounded ns-tab-item flex-auto flex overflow-hidden"},[s("div",{staticClass:"cart-table flex flex-auto flex-col overflow-hidden"},[s("div",{staticClass:"w-full mb-10",attrs:{id:"cart-toolbox"}},[s("div",{staticClass:"overflow-hidden"},[s("div",{staticClass:"flex flex-wrap"},[s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none",on:{click:function(e){return t.openNotePopup()}}},[s("img",{attrs:{src:"/images/comment.png",alt:"",srcset:""}}),t._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Comments")))])])]),t._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.selectTaxGroup()}}},[s("img",{attrs:{src:"/images/taxes.png",alt:"",srcset:""}}),t._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Taxes")))]),t._v(" "),t.order.taxes&&t.order.taxes.length>0?s("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},[t._v(t._s(t.order.taxes.length))]):t._e()])]),t._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.selectCoupon()}}},[s("img",{attrs:{src:"/images/coupons.png",alt:"",srcset:""}}),t._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Coupons")))]),t._v(" "),t.order.coupons&&t.order.coupons.length>0?s("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},[t._v(t._s(t.order.coupons.length))]):t._e()])]),t._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.defineOrderSettings()}}},[s("img",{attrs:{src:"/images/settings.png",alt:"",srcset:""}}),t._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Settings")))])])]),t._v(" "),"yes"===t.options.ns_pos_quick_product?s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.openAddQuickProduct()}}},[s("i",{staticClass:"las la-plus"}),t._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Product")))])])]):t._e(),t._v(" "),s("hr",{staticClass:"h-10",staticStyle:{width:"1px"}})])])]),t._v(" "),s("div",{staticClass:"flex flex-auto flex-col overflow-auto dskfjdksjf",attrs:{id:"cart-products-table"}},[s("h2",{staticClass:"bills-heading"},[t._v("Bills")]),t._v(" "),0===t.products.length?s("div",{staticClass:"text-primary flex"},[s("div",{staticClass:"w-full text-center py-4"},[s("h3",{staticClass:"text-header"},[t._v(t._s(t.__("No products added...")))])])]):t._e(),t._v('\n                    console.log("product")\n                    '),s("pre",[t._v("dddddddds")]),t._v(" "),t._l(t.products,(function(e,n){return s("div",{key:e.barcode,staticClass:"product-item flex",attrs:{"product-index":n}},[s("pre",[t._v("dddddddds")]),t._v(" "),s("pre",[t._v(t._s(e))]),t._v(" "),s("img",{staticStyle:{"margin-right":"10px"},attrs:{src:t.getHttpsUrl(e.galleries[0].url),width:"90",height:"",alt:"",srcset:""}}),t._v(" "),s("div",{staticClass:"w-full lg:w-4/6"},[s("div",{staticClass:"flex justify-between product-details mb-1"},[s("h3",{staticClass:"font-semibold text-header"},[t._v("\n                                "+t._s(e.name)+" — "+t._s(e.unit_name)+"\n                            ")])]),t._v(" "),s("div",{staticClass:"flex justify-between product-controls mb-3"},[s("div",{staticClass:"-mx-1 flex flex-wrap text-description"},[s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[s("a",{staticClass:"cursor-pointer outline-none py-1 text-sm",class:"wholesale"===e.mode?"text-success-secondary hover:text-success-secondary border-success-secondary":"border-info-primary",on:{click:function(s){return t.changeProductPrice(e)}}},[t._v(t._s(t.__("Price"))+" : "+t._s(t._f("currency")(e.unit_price)))])]),t._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[t.allowQuantityModification(e)?s("a",{staticClass:"cursor-pointer outline-none py-1 text-sm",on:{click:function(s){return t.openDiscountPopup(e,"product")}}},[t._v(t._s(t.__("Discount"))+" "),"percentage"===e.discount_type?s("span",[t._v(t._s(e.discount_percentage)+"%")]):t._e(),t._v(" : "+t._s(t._f("currency")(e.discount)))]):t._e()]),t._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[t.allowQuantityModification(e)?s("a",{staticClass:"cursor-pointer outline-none py-1 text-sm",on:{click:function(s){return t.changeQuantity(e)}}},[t._v(t._s(t.__("Quantity"))+": "+t._s(e.quantity))]):t._e()]),t._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[s("span",{staticClass:"cursor-pointer outline-none py-1 text-sm"},[t._v(t._s(t.__("Total"))+": "+t._s(t._f("currency")(e.total_price)))])])])]),t._v(" "),s("div",{staticClass:"flex product-options items-center data"},[s("div",{staticClass:"px-1"},[s("a",{staticClass:"hover:text-error-secondary cursor-pointer outline-none py-1 text-sm",class:t.allowQuantityModification(e)?"cursor-pointer ns-numpad-key":"",staticStyle:{display:"block","border-radius":"3px",border:"1px solid #828282",padding:"0 !important",background:"#fff"},on:{click:function(s){return t.minusQuantity(e)}}},[s("img",{attrs:{src:"/images/minus.png",alt:""}})])]),t._v(" "),s("div",{staticClass:"hidden text-header lg:flex mr-2 items-center justify-center"},[t.allowQuantityModification(e)?s("span",[t._v(t._s(e.quantity))]):t._e()]),t._v(" "),s("div",{staticClass:"px-1"},[s("a",{staticClass:"hover:text-error-secondary cursor-pointer outline-none py-1 text-sm",class:t.allowQuantityModification(e)?"cursor-pointer ns-numpad-key":"",staticStyle:{display:"block","border-radius":"3px",border:"1px solid #828282",padding:"0 !important",background:"#fff"},on:{click:function(s){return t.plusQuantity(e)}}},[s("img",{attrs:{src:"/images/plus.png",alt:""}})])]),t._v(" "),s("div",{staticClass:"px-1"},[s("a",{staticClass:"hover:text-error-secondary cursor-pointer outline-none py-1 text-sm",on:{click:function(s){return t.remove(e)}}},[s("img",{attrs:{src:"/images/trash.png",alt:""}})])]),t._v(" "),t.options.ns_pos_allow_wholesale_price&&t.allowQuantityModification(e)?s("div",{staticClass:"px-1"},[s("a",{staticClass:"cursor-pointer outline-none text-sm",class:(e.mode,""),on:{click:function(s){return t.toggleMode(e)}}},[s("i",{staticClass:"las la-award text-xl"})])]):t._e()])]),t._v(" "),s("div",{staticClass:"hidden lg:flex w-1/6 p-2 price-text items-center justify-center"},[t._v(t._s(t._f("currency")(e.total_price)))])])}))],2),t._v(" "),s("div",{staticClass:"flex",attrs:{id:"cart-products-summary"}},["both"===t.visibleSection?s("table",{staticClass:"table custom-table ns-table w-full text-sm"},[s("tr",[s("td",{staticClass:"p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 -b text-sm",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Customer"))+": "+t._s(t.customerName))])]),t._v(" "),s("td",{staticClass:"p-2",attrs:{width:"200"}},[t._v(t._s(t.__("Sub Total")))]),t._v(" "),s("td",{staticClass:"p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.subtotal)))])]),t._v(" "),t.order.coupons.length>0?s("tr",[s("td",{staticClass:"p-2",attrs:{width:"200"}}),t._v(" "),s("td",{staticClass:"p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none -dashed py-1 -b text-sm",on:{click:function(e){return t.selectCoupon()}}},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),s("td",{staticClass:"p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.summarizeCoupons())))])]):t._e(),t._v(" "),s("tr",[s("td",{staticClass:"p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outlin py-1 -b text-sm",on:{click:function(e){return t.openOrderType()}}},[t._v(t._s(t.__("Type"))+": "+t._s(t.selectedType))])]),t._v(" "),s("td",{staticClass:"p-2",attrs:{width:"200"}},[s("span",[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?s("span",[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?s("span",[t._v("("+t._s(t.__("Flat"))+")")]):t._e()]),t._v(" "),s("td",{staticClass:"p-2 text-right",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outlin py-1 -b text-sm",on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[t._v(t._s(t._f("currency")(t.order.discount)))])])]),t._v(" "),t.order.type&&"delivery"===t.order.type.identifier?s("tr",[s("td",{staticClass:"p-2",attrs:{width:"200"}}),t._v(" "),s("td",{staticClass:"p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openShippingPopup()}}},[t._v(t._s(t.__("Shipping")))])]),t._v(" "),s("td",{staticClass:"p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.shipping)))])]):t._e(),t._v(" "),s("tr",{staticClass:"success"},[s("td",{staticClass:"p-2",attrs:{width:"200"}},[t.order&&"exclusive"===t.options.ns_pos_tax_type||t.order&&"inclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Included"))+": "+t._s(t._f("currency")(t.order.total_tax_value+t.order.products_exclusive_tax_value)))]):"no"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):t._e()]:t._e()],2),t._v(" "),s("td",{staticClass:"p-2",attrs:{width:"200"}},[t._v(t._s(t.__("Total")))]),t._v(" "),s("td",{staticClass:"p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.total)))])])]):t._e(),t._v(" "),"cart"===t.visibleSection?s("table",{staticClass:"table ns-table w-full text-sm"},[s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Customer"))+": "+t._s(t.customerName))])]),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between"},[s("span",[t._v(t._s(t.__("Sub Total")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.subtotal)))])])])]),t._v(" "),t.order.coupons.length>0?s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.selectCoupon()}}},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),s("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.summarizeCoupons())))])]):t._e(),t._v(" "),s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openOrderType()}}},[t._v(t._s(t.__("Type"))+": "+t._s(t.selectedType))])]),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between items-center"},[s("p",[s("span",[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?s("span",[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?s("span",[t._v("("+t._s(t.__("Flat"))+")")]):t._e()]),t._v(" "),s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[t._v(t._s(t._f("currency")(t.order.discount)))])])])]),t._v(" "),t.order.type&&"delivery"===t.order.type.identifier?s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openShippingPopup()}}},[t._v(t._s(t.__("Shipping")))]),t._v(" "),s("span")])]):t._e(),t._v(" "),s("tr",{staticClass:"success"},[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[t.order&&"exclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):"no"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Inclusive"))+": "+t._s(t._f("currency")(t.order.total_tax_value+t.order.products_exclusive_tax_value)))]):t._e()]:t.order&&"inclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Included"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):"no"===t.options.ns_pos_price_with_tax?s("a",{staticClass:"cursor-pointer outline-none py-1 border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Included"))+": "+t._s(t._f("currency")(t.order.total_tax_value+t.order.products_exclusive_tax_value)))]):t._e()]:t._e()],2),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between w-full"},[s("span",[t._v(t._s(t.__("Total")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.total)))])])])])]):t._e()]),t._v(" "),s("div",{staticClass:"flex flex-shrink-0 border-tox-edge",attrs:{id:"cart-bottom-buttons"}},[s("div",{staticClass:"side-button",attrs:{id:"pay-button"},on:{click:function(e){return t.payOrder()}}},[s("img",{staticClass:"mr-2",attrs:{src:"/images/pay.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.__("Pay")))])]),t._v(" "),s("div",{staticClass:"side-button block",attrs:{id:"hold-button"},on:{click:function(e){return t.holdOrder()}}},[s("img",{staticClass:"mr-2",attrs:{src:"/images/kithen.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.__("Hold")))])]),t._v(" "),s("div",{staticClass:"side-button",attrs:{id:"discount-button"},on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[s("img",{staticClass:"mr-2",attrs:{src:"/images/discount.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.__("Discount")))])]),t._v(" "),s("div",{staticClass:"side-button",attrs:{id:"void-button"},on:{click:function(e){return t.voidOngoingOrder(t.order)}}},[s("img",{staticClass:"mr-2",attrs:{src:"/images/void.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.__("Void")))])])])])])])}),[],!1,null,null,null).exports},800:(t,e,s)=>{s.d(e,{Z:()=>z});var n=s(7700),r=s(9020),i=s(2277),o=s(4679),a=s(665),c=s(3632);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const p={mounted:function(){this.popuCloser(),this.loadFields(),this.product=this.$popupParams.product},data:function(){return{formValidation:new o.Z,fields:[],product:null}},methods:{__:c.__,popuCloser:a.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},addProduct:function(){if(this.formValidation.validateFields(this.fields),this.formValidation.fieldsValid(this.fields)){var t=this.formValidation.extractFields(this.fields),e=u(u({},this.product),t);return this.$popupParams.resolve(e),console.log(t,e),this.close()}n.kX.error((0,c.__)("The form is not valid.")).subscribe()},loadFields:function(){var t=this;n.ih.get("/api/nexopos/v4/fields/ns.refund-product").subscribe((function(e){t.fields=t.formValidation.createFields(e),t.fields.forEach((function(e){e.value=t.product[e.name]||""}))}))}}};var _=s(1900);const f=(0,_.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl ns-box w-95vw md:w-3/5-screen lg:w-3/7-screen h-95vh md:h-3/5-screen lg:h-3/7-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 flex justify-between border-b ns-box-header items-center"},[s("h3",{staticClass:"text-semibold"},[t._v(t._s(t.__("Products")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto relative ns-scrollbar"},[s("div",{staticClass:"p-2"},t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),0===t.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):t._e()]),t._v(" "),s("div",{staticClass:"p-2 flex justify-between items-center border-t ns-box-body"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Add Product")))])],1)])])}),[],!1,null,null,null).exports;var v=s(2830),m=s(7751);const b={components:{nsNumpad:m.Z},data:function(){return{product:null,seeValue:0,availableQuantity:0}},mounted:function(){this.product=this.$popupParams.product,this.availableQuantity=this.$popupParams.availableQuantity,this.seeValue=this.product.quantity},methods:{__:c.__,popupResolver:v.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},setChangedValue:function(t){this.seeValue=t},updateQuantity:function(t){if(t>this.availableQuantity)return n.kX.error("Unable to proceed as the quantity provided is exceed the available quantity.").subscribe();this.product.quantity=parseFloat(t),this.$popupParams.resolve(this.product),this.$popup.close()}}};const h=(0,_.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl ns-box overflow-hidden w-95vw md:w-4/6-screen lg:w-3/7-screen"},[s("div",{staticClass:"p-2 flex justify-between ns-box-header"},[s("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Quantity")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),t.product?s("div",{staticClass:"border-t border-b ns-box-body py-2 flex items-center justify-center text-2xl font-semibold"},[s("span",[t._v(t._s(t.seeValue))]),t._v(" "),s("span",{staticClass:"text-primary text-sm"},[t._v("("+t._s(t.availableQuantity)+" "+t._s(t.__("available"))+")")])]):t._e(),t._v(" "),t.product?s("div",{staticClass:"flex-auto overflow-y-auto p-2"},[s("ns-numpad",{attrs:{value:t.product.quantity},on:{next:function(e){return t.updateQuantity(e)},changed:function(e){return t.setChangedValue(e)}}})],1):t._e()])}),[],!1,null,null,null).exports;var y=s(2614),x=s(914),C=s(6979),w=s(282);function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){k(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function k(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const S={components:{nsNumpad:m.Z},props:["order"],computed:{screenValue:function(){var t=parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join(""));return this.screen/t},total:function(){return this.refundables.length>0?this.refundables.map((function(t){return parseFloat(t.unit_price)*parseFloat(t.quantity)})).reduce((function(t,e){return t+e}))+this.shippingFees:0+this.shippingFees},shippingFees:function(){return this.refundShipping?this.order.shipping:0}},data:function(){return{isSubmitting:!1,formValidation:new o.Z,refundables:[],paymentOptions:[],paymentField:[],print:new w.Z({urls:systemUrls,options:systemOptions}),refundShipping:!1,selectedPaymentGateway:!1,screen:0,selectFields:[{type:"select",options:this.order.products.map((function(t){return{label:"".concat(t.name," - ").concat(t.unit.name," (x").concat(t.quantity,")"),value:t.id}})),validation:"required",name:"product_id",label:(0,c.__)("Product"),description:(0,c.__)("Select the product to perform a refund.")}]}},methods:{__:c.__,updateScreen:function(t){this.screen=t},toggleRefundShipping:function(t){this.refundShipping=t,this.refundShipping},proceedPayment:function(){var t=this;return!1===this.selectedPaymentGateway?n.kX.error((0,c.__)("Please select a payment gateway before proceeding.")).subscribe():0===this.total?n.kX.error((0,c.__)("There is nothing to refund.")).subscribe():0===this.screenValue?n.kX.error((0,c.__)("Please provide a valid payment amount.")).subscribe():void C.G.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The refund will be made on the current order."),onAction:function(e){e&&t.doProceed()}})},doProceed:function(){var t=this,e={products:this.refundables,total:this.screenValue,payment:this.selectedPaymentGateway,refund_shipping:this.refundShipping};this.isSubmitting=!0,n.ih.post("/api/nexopos/v4/orders/".concat(this.order.id,"/refund"),e).subscribe({next:function(e){t.isSubmitting=!1,t.$emit("changed",!0),"refunded"===e.data.order.payment_status&&t.$emit("loadTab","details"),t.print.process(e.data.orderRefund.id,"refund"),n.kX.success(e.message).subscribe()},error:function(e){t.isSubmitting=!1,n.kX.error(e.message).subscribe()}})},addProduct:function(){var t=this;if(this.formValidation.validateFields(this.selectFields),!this.formValidation.fieldsValid(this.selectFields))return n.kX.error((0,c.__)("Please select a product before proceeding.")).subscribe();var e=this.formValidation.extractFields(this.selectFields),s=this.order.products.filter((function(t){return t.id===e.product_id})),r=this.refundables.filter((function(t){return t.id===e.product_id}));if(r.length>0){var i=r.map((function(t){return parseInt(t.quantity)})).reduce((function(t,e){return t+e}));if(i===s[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe()}if(0===s[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe();var o=P(P({},s[0]),{condition:"",description:""});new Promise((function(t,e){C.G.show(f,{resolve:t,reject:e,product:o})})).then((function(e){e.quantity=t.getProductOriginalQuantity(e.id)-t.getProductUsedQuantity(e.id),t.refundables.push(e)}),(function(t){return t}))},getProductOriginalQuantity:function(t){var e=this.order.products.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},getProductUsedQuantity:function(t){var e=this.refundables.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},openSettings:function(t){var e=this;new Promise((function(e,s){C.G.show(f,{resolve:e,reject:s,product:t})})).then((function(s){var n=e.refundables.indexOf(t);e.$set(e.refundables,n,s)}),(function(t){return t}))},selectPaymentGateway:function(){var t=this;new Promise((function(e,s){C.G.show(y.Z,P({resolve:e,reject:s,value:[t.selectedPaymentOption]},t.paymentField[0]))})).then((function(e){t.selectedPaymentGateway=e[0]}),(function(t){return t}))},changeQuantity:function(t){var e=this;new Promise((function(s,n){var r=e.getProductOriginalQuantity(t.id)-e.getProductUsedQuantity(t.id)+parseFloat(t.quantity);C.G.show(h,{resolve:s,reject:n,product:t,availableQuantity:r})})).then((function(s){if(s.quantity>e.getProductUsedQuantity(t.id)-t.quantity){var n=e.refundables.indexOf(t);e.$set(e.refundables,n,s)}}))},deleteProduct:function(t){var e=this;new Promise((function(s,n){C.G.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this product ?"),onAction:function(s){if(s){var n=e.refundables.indexOf(t);e.refundables.splice(n,1)}}})}))}},mounted:function(){var t=this;this.selectFields=this.formValidation.createFields(this.selectFields),n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.paymentField=e}))}};const O=(0,_.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-m-4 flex-auto flex flex-wrap relative"},[t.isSubmitting?s("div",{staticClass:"bg-overlay h-full w-full flex items-center justify-center absolute z-30"},[s("ns-spinner")],1):t._e(),t._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Refund With Products")))]),t._v(" "),s("div",{staticClass:"my-2"},[s("ul",[s("li",{staticClass:"border-b border-info-primary flex justify-between items-center mb-2"},[s("div",{staticClass:"flex-auto flex-col flex"},[s("div",{staticClass:"p-2 flex"},t._l(t.selectFields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),s("div",{staticClass:"flex justify-between p-2"},[s("div",{staticClass:"flex items-center text-primary"},[t.order.shipping>0?s("span",{staticClass:"mr-2"},[t._v(t._s(t.__("Refund Shipping")))]):t._e(),t._v(" "),t.order.shipping>0?s("ns-checkbox",{attrs:{checked:t.refundShipping},on:{change:function(e){return t.toggleRefundShipping(e)}}}):t._e()],1),t._v(" "),s("div",[s("button",{staticClass:"border rounded-full px-2 py-1 ns-inset-button info",on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Add Product")))])])])])]),t._v(" "),s("li",[s("h4",{staticClass:"py-1 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Products")))])]),t._v(" "),t._l(t.refundables,(function(e){return s("li",{key:e.id,staticClass:"elevation-surface border flex justify-between items-center mb-2"},[s("div",{staticClass:"px-2 text-primary flex justify-between flex-auto"},[s("div",{staticClass:"flex flex-col"},[s("p",{staticClass:"py-2"},[s("span",[t._v(t._s(e.name))]),t._v(" "),"damaged"===e.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-error-tertiary mx-2 text-white"},[t._v(t._s(t.__("Damaged")))]):t._e(),t._v(" "),"unspoiled"===e.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-success-tertiary mx-2 text-white"},[t._v(t._s(t.__("Unspoiled")))]):t._e()]),t._v(" "),s("small",[t._v(t._s(e.unit.name))])]),t._v(" "),s("div",{staticClass:"flex items-center justify-center"},[s("span",{staticClass:"py-1 flex items-center cursor-pointer border-b border-dashed border-info-primary"},[t._v(t._s(t._f("currency")(e.unit_price*e.quantity)))])])]),t._v(" "),s("div",{staticClass:"flex"},[s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.openSettings(e)}}},[s("i",{staticClass:"las la-cog text-xl"})]),t._v(" "),s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.deleteProduct(e)}}},[s("i",{staticClass:"las la-trash"})]),t._v(" "),s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.changeQuantity(e)}}},[t._v(t._s(e.quantity))])])])}))],2)])]),t._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Summary")))]),t._v(" "),s("div",{staticClass:"py-2"},[s("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v(t._s(t.__("Total")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.total)))])]),t._v(" "),s("div",{staticClass:"elevation-surface border success font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v(t._s(t.__("Paid")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),s("div",{staticClass:"elevation-surface border info font-semibold flex mb-2 p-2 justify-between cursor-pointer",on:{click:function(e){return t.selectPaymentGateway()}}},[s("span",[t._v(t._s(t.__("Payment Gateway")))]),t._v(" "),s("span",[t._v(t._s(t.selectedPaymentGateway?t.selectedPaymentGateway.label:"N/A"))])]),t._v(" "),s("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v(t._s(t.__("Screen")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.screenValue)))])]),t._v(" "),s("div",[s("ns-numpad",{attrs:{currency:!0,value:t.screen},on:{changed:function(e){return t.updateScreen(e)},next:function(e){return t.proceedPayment(e)}}})],1)])])])}),[],!1,null,null,null).exports;var j=s(3033);function T(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,s,n;return e=t,(s=[{key:"getTypeLabel",value:function(t){var e=typeLabels.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getDeliveryStatus",value:function(t){var e=deliveryStatuses.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getProcessingStatus",value:function(t){var e=processingStatuses.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getPaymentStatus",value:function(t){var e=paymentLabels.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}}])&&T(e.prototype,s),n&&T(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function V(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function A(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?V(Object(s),!0).forEach((function(e){Z(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Z(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const D={props:["order"],data:function(){return{labels:new $,validation:new o.Z,inputValue:0,fields:[],paymentTypes}},computed:{paymentsLabels:function(){var t=new Object;return this.paymentTypes.forEach((function(e){t[e.value]=e.label})),t}},methods:{__:c.__,updateValue:function(t){this.inputValue=t},loadPaymentFields:function(){var t=this;n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.fields=t.validation.createFields(e)}))},submitPayment:function(t){var e=this;if(this.validation.validateFields(this.fields),!this.validation.fieldsValid(this.fields))return n.kX.error((0,c.__)("Unable to proceed the form is not valid")).subscribe();if(0==parseFloat(t))return n.kX.error((0,c.__)("Please provide a valid value")).subscribe();t=parseFloat(t);var s=A(A({},this.validation.extractFields(this.fields)),{},{value:t});Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("You make a payment for {amount}. A payment can't be canceled. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(t)),onAction:function(t){t&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/payments"),s).subscribe((function(t){n.kX.success(t.message).subscribe(),e.$emit("changed")}),(function(t){n.kX.error(t.message).subscribe()}))}})}},components:{nsNumpad:m.Z},mounted:function(){this.loadPaymentFields()}};const F=(0,_.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{},[s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface info border text-xl font-bold"},[s("span",[t._v(t._s(t.__("Total")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface success border text-xl font-bold"},[s("span",[t._v(t._s(t.__("Paid")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface error border text-xl font-bold"},[s("span",[t._v(t._s(t.__("Unpaid")))]),t._v(" "),t.order.total-t.order.tendered>0?s("span",[t._v(t._s(t._f("currency")(t.order.total-t.order.tendered)))]):t._e(),t._v(" "),t.order.total-t.order.tendered<=0?s("span",[t._v(t._s(t._f("currency")(0)))]):t._e()])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface warning border text-xl font-bold"},[s("span",[t._v(t._s(t.__("Customer Account")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.customer.account_amount)))])])])]),t._v(" "),s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},["paid"!==t.order.payment_status?s("div",[s("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2"},[t._v("\n                    "+t._s(t.__("Payment"))+"\n                ")]),t._v(" "),s("div",{staticClass:"py-2"},[t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),t._v(" "),s("div",{staticClass:"my-2 px-2 h-12 flex justify-end items-center border elevation-surface"},[t._v("\n                        "+t._s(t._f("currency")(t.inputValue))+"\n                    ")]),t._v(" "),s("ns-numpad",{attrs:{floating:!0,value:t.inputValue},on:{next:function(e){return t.submitPayment(e)},changed:function(e){return t.updateValue(e)}}})],2)]):t._e(),t._v(" "),"paid"===t.order.payment_status?s("div",{staticClass:"flex items-center justify-center h-full"},[s("h3",{staticClass:"text-primary font-semibold"},[t._v(t._s(t.__("No payment possible for paid order.")))])]):t._e()]),t._v(" "),s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},[s("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2 mb-2"},[t._v("\n                "+t._s(t.__("Payment History"))+"\n            ")]),t._v(" "),s("ul",t._l(t.order.payments,(function(e){return s("li",{key:e.id,staticClass:"p-2 flex items-center justify-between text-shite border elevation-surface mb-2"},[s("span",[t._v(t._s(t.paymentsLabels[e.identifier]||t.__("Unknown")))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(e.value)))])])})),0)])])])}),[],!1,null,null,null).exports;var E=s(1765);const R={props:["order"],data:function(){return{processingStatuses,deliveryStatuses,labels:new $,showProcessingSelect:!1,showDeliverySelect:!1}},mounted:function(){},methods:{__:c.__,submitProcessingChange:function(){var t=this;C.G.show(x.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The processing status of the order will be changed. Please confirm your action."),onAction:function(e){e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/processing"),{process_status:t.order.process_status}).subscribe({next:function(e){t.showProcessingSelect=!1,n.kX.success(e.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("Unexpected error occurred.")).subscribe()}})}})},openRefunds:function(){var t=this;try{new Promise((function(e,s){var n=t.order;C.G.show(E.Z,{order:n,resolve:e,reject:s})}))}catch(t){}},submitDeliveryStatus:function(){var t=this;C.G.show(x.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The delivery status of the order will be changed. Please confirm your action."),onAction:function(e){e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/delivery"),{delivery_status:t.order.delivery_status}).subscribe({next:function(e){t.showDeliverySelect=!1,n.kX.success(e.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("Unexpected error occurred.")).subscribe()}})}})}}};const q=(0,_.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-mx-4 flex flex-wrap"},[s("div",{staticClass:"flex-auto"},[s("div",{staticClass:"w-full mb-2 flex-wrap flex"},[s("div",{staticClass:"w-full mb-2 px-4"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Payment Summary")))])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"elevation-surface border p-2 flex justify-between items-start"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(t.__("Sub Total")))])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(t.order.subtotal)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[s("div",[s("h4",{staticClass:"text-semibold"},[s("span",{staticClass:"text-white"},[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?s("span",{staticClass:"text-white ml-1"},[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?s("span",{staticClass:"text-white ml-1"},[t._v("(Flat)")]):t._e()])]),t._v(" "),s("div",{staticClass:"font-semibold"},[s("span",[t._v(t._s(t._f("currency")(t.order.discount)))])])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(t.__("Shipping")))])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(t.order.shipping)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[s("div",[s("h4",{staticClass:"text-semibold"},[t._v("\n                            "+t._s(t.__("Coupons"))+"\n                        ")])]),t._v(" "),s("div",{staticClass:"font-semibold"},[s("span",[t._v(t._s(t._f("currency")(t.order.total_coupons)))])])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice info"},[s("div",[s("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Total")))])]),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice warning"},[s("div",[s("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Taxes")))])]),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tax_value)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start text-primary elevation-surface error border"},[s("div",[s("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Change")))])]),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.change)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Paid")))])]),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tendered)))])])])])]),t._v(" "),s("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Order Status")))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[t._v(t._s(t.__("Customer")))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.order.nexopos_customers_name))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[t._v(t._s(t.__("Type")))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.labels.getTypeLabel(t.order.type)))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[t._v(t._s(t.__("Delivery Status")))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[s("div",{staticClass:"w-full text-center"},[t.showDeliverySelect?t._e():s("span",{staticClass:"font-semibold text-secondary border-b border-info-primary cursor-pointer border-dashed",on:{click:function(e){t.showDeliverySelect=!0}}},[t._v(t._s(t.labels.getDeliveryStatus(t.order.delivery_status)))])]),t._v(" "),t.showDeliverySelect?s("div",{staticClass:"flex-auto flex"},[s("div",{staticClass:"ns-select flex items-center justify-center"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.order.delivery_status,expression:"order.delivery_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"delivery_status",e.target.multiple?s:s[0])}}},t._l(t.deliveryStatuses,(function(e,n){return s("option",{key:n,domProps:{value:e.value}},[t._v(t._s(e.label))])})),0)]),t._v(" "),s("div",{staticClass:"pl-2 flex"},[s("ns-close-button",{on:{click:function(e){t.showDeliverySelect=!1}}}),t._v(" "),s("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(e){return t.submitDeliveryStatus(t.order)}}},[t._v(t._s(t.__("Save")))])],1)]):t._e()])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex flex-col md:flex-row justify-between items-center elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[t._v(t._s(t.__("Processing Status")))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[s("div",{staticClass:"w-full text-center"},[t.showProcessingSelect?t._e():s("span",{staticClass:"border-b border-info-primary cursor-pointer border-dashed",on:{click:function(e){t.showProcessingSelect=!0}}},[t._v(t._s(t.labels.getProcessingStatus(t.order.process_status)))])]),t._v(" "),t.showProcessingSelect?s("div",{staticClass:"flex-auto flex"},[s("div",{staticClass:"ns-select flex items-center justify-center"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.order.process_status,expression:"order.process_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"process_status",e.target.multiple?s:s[0])}}},t._l(t.processingStatuses,(function(e,n){return s("option",{key:n,domProps:{value:e.value}},[t._v(t._s(e.label))])})),0)]),t._v(" "),s("div",{staticClass:"pl-2 flex"},[s("ns-close-button",{on:{click:function(e){t.showProcessingSelect=!1}}}),t._v(" "),s("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(e){return t.submitProcessingChange(t.order)}}},[t._v(t._s(t.__("Save")))])],1)]):t._e()])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[t._v(t._s(t.__("Payment Status")))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.labels.getPaymentStatus(t.order.payment_status)))])])]),t._v(" "),s("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Products")))])]),t._v(" "),t._l(t.order.products,(function(e){return s("div",{key:e.id,staticClass:"p-2 flex justify-between items-start elevation-surface border mb-6"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(e.name)+" (x"+t._s(e.quantity)+")")]),t._v(" "),s("p",{staticClass:"text-secondary text-sm"},[t._v(t._s(e.unit.name||"N/A"))])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(e.total_price)))])])})),t._v(" "),s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary flex justify-between"},[s("span",[t._v(t._s(t.__("Refunded Products")))]),t._v(" "),s("a",{staticClass:"border-b border-info-primary border-dashed",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.openRefunds()}}},[t._v(t._s(t.__("All Refunds")))])])]),t._v(" "),t._l(t.order.refunded_products,(function(e,n){return s("div",{key:n,staticClass:"p-2 flex justify-between items-start elevation-surface border mb-6"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(e.order_product.name)+" (x"+t._s(e.quantity)+")")]),t._v(" "),s("p",{staticClass:"text-secondary text-sm"},[t._v(t._s(e.unit.name||"N/A")+" | "),s("span",{staticClass:"rounded-full px-2",class:"damaged"===e.condition?"bg-error-tertiary text-white":"bg-info-tertiary text-white"},[t._v(t._s(e.condition))])])]),t._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(e.total_price)))])])}))],2)])}),[],!1,null,null,null).exports;var N=s(4687),I=s.n(N);function X(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function H(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Q={name:"ns-order-instalments-payment",components:{nsNotice:s(876).nsNotice},data:function(){return{paymentTypes,fields:[{type:"select",name:"payment_type",description:(0,c.__)("Select the payment type that must apply to the current order."),label:(0,c.__)("Payment Type"),validation:"required",options:paymentTypes}],print:new w.Z({urls:systemUrls,options:systemOptions}),validation:new o.Z,order:null,instalment:null}},methods:{__:c.__,popupResolver:v.Z,popupCloser:a.Z,close:function(){this.popupResolver(!1)},updateInstalmentAsDue:function(t){var e=this;nsHttpClient.put("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments/").concat(this.instalment.id,"/"),{instalment:{date:ns.date.moment.format("YYYY-MM-DD HH:mm:ss")}}).subscribe({next:function(t){e.submitPayment()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})},submitPayment:function(){var t=this;if(!this.validation.validateFields(this.fields))return n.kX.error(__m("The form is not valid.")).subcribe();nsHttpClient.post("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments/").concat(this.instalment.id,"/pay"),function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?X(Object(s),!0).forEach((function(e){H(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):X(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},this.validation.extractFields(this.fields))).subscribe({next:function(e){t.popupResolver(!0),t.print.exec(e.data.payment.id,"payment"),n.kX.success(e.message).subscribe()},error:function(e){"failed"===e.status&&Popup.show(x.default,{title:(0,c.__)("Update Instalment Date"),message:(0,c.__)("Would you like to mark that instalment as due today ? If you confirm the instalment will be marked as paid."),onAction:function(e){e&&t.updateInstalmentAsDue(t.instalment)}}),n.kX.error(e.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}},mounted:function(){this.popupCloser(),this.order=this.$popupParams.order,this.instalment=this.$popupParams.instalment,this.fields=this.validation.createFields(this.fields)}};const G=(0,_.Z)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-2/3-screen lg:w-1/3-screen"},[s("div",{staticClass:"p-2 flex justify-between border-b items-center"},[s("h3",[t._v(t._s(t.__("Payment Method")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"p-2 ns-box-body"},[s("ns-notice",{staticClass:"py-2 p-4 text-center border text-primary rounded-lg",attrs:{color:"info"}},[t._v(t._s(t.__("Before submitting the payment, choose the payment type used for that order.")))]),t._v(" "),s("br"),t._v(" "),t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})}))],2),t._v(" "),s("div",{staticClass:"border-t ns-box-footer p-2 flex justify-end"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitPayment()}}},[t._v(t._s(t.__("Submit Payment")))])],1)])}),[],!1,null,null,null).exports;function L(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}const U={props:["order"],name:"ns-order-instalments",data:function(){return{labels:new $,original:[],instalments:[],print:new w.Z({urls:systemUrls,options:systemOptions,type:"payment"})}},mounted:function(){this.loadInstalments()},computed:{totalInstalments:function(){return this.instalments.length>0?this.instalments.map((function(t){return t.amount})).reduce((function(t,e){return parseFloat(t)+parseFloat(e)})):0}},methods:{__:c.__,loadInstalments:function(){var t=this;n.ih.get("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments")).subscribe((function(e){t.original=e,t.instalments=e.map((function(t){return t.price_clicked=!1,t.date_clicked=!1,t.date=moment(t.date).format("YYYY-MM-DD"),t}))}))},showReceipt:function(t){if(null===t.payment_id)return n.kX.error((0,c.__)("This instalment doesn't have any payment attached.")).subscribe();this.print.process(t.payment_id,"payment")},addInstalment:function(){this.instalments.push({date:ns.date.moment.format("YYYY-MM-DD"),amount:this.order.total-this.totalInstalments,paid:!1})},createInstalment:function(t){var e=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to create this instalment ?"),onAction:function(s){s&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments"),{instalment:t}).subscribe({next:function(t){e.loadInstalments(),n.kX.success(t.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},deleteInstalment:function(t){var e=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this instalment ?"),onAction:function(s){s&&n.ih.delete("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments/").concat(t.id)).subscribe({next:function(s){var r=e.instalments.indexOf(t);e.instalments.splice(r,1),n.kX.success(s.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},markAsPaid:function(t){var e,s=this;return(e=I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,n){Popup.show(G,{order:s.order,instalment:t,resolve:e,reject:n})}));case 3:e.sent,s.loadInstalments(),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function o(t){L(i,n,r,o,a,"next",t)}function a(t){L(i,n,r,o,a,"throw",t)}o(void 0)}))})()},togglePriceEdition:function(t){var e=this;t.paid||(t.price_clicked=!t.price_clicked,this.$forceUpdate(),t.price_clicked&&setTimeout((function(){e.$refs.amount[0].select()}),100))},updateInstalment:function(t){var e=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to update that instalment ?"),onAction:function(s){s&&n.ih.put("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments/").concat(t.id),{instalment:t}).subscribe({next:function(t){n.kX.success(t.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},toggleDateEdition:function(t){var e=this;t.paid||(t.date_clicked=!t.date_clicked,this.$forceUpdate(),t.date_clicked&&setTimeout((function(){e.$refs.date[0].select()}),200))}}};const Y=(0,_.Z)(U,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-mx-4 flex-auto flex flex-wrap"},[s("div",{staticClass:"flex flex-auto"},[s("div",{staticClass:"w-full mb-2 flex-wrap"},[s("div",{staticClass:"w-full mb-2 px-4"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Instalments")))])]),t._v(" "),s("div",{staticClass:"px-4"},[s("ul",{staticClass:"border-table-th-edge border-t text-primary"},[t._l(t.instalments,(function(e){return s("li",{key:e.id,staticClass:"border-b border-l flex justify-between elevation-surface",class:e.paid?"success":"info"},[s("span",{staticClass:"p-2"},[e.date_clicked?t._e():s("span",{on:{click:function(s){return t.toggleDateEdition(e)}}},[t._v(t._s(e.date))]),t._v(" "),e.date_clicked?s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.date,expression:"instalment.date"}],ref:"date",refInFor:!0,staticClass:"border border-info-primary rounded",attrs:{type:"date"},domProps:{value:e.date},on:{blur:function(s){return t.toggleDateEdition(e)},input:function(s){s.target.composing||t.$set(e,"date",s.target.value)}}})]):t._e()]),t._v(" "),s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"flex items-center px-2 h-full border-r"},[e.price_clicked?t._e():s("span",{on:{click:function(s){return t.togglePriceEdition(e)}}},[t._v(t._s(t._f("currency")(e.amount)))]),t._v(" "),e.price_clicked?s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.amount,expression:"instalment.amount"}],ref:"amount",refInFor:!0,staticClass:"border border-info-primary p-1",attrs:{type:"text"},domProps:{value:e.amount},on:{blur:function(s){return t.togglePriceEdition(e)},input:function(s){s.target.composing||t.$set(e,"amount",s.target.value)}}})]):t._e()]),t._v(" "),!e.paid&&e.id?s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"success",className:"la-money-bill-wave-alt"},on:{click:function(s){return t.markAsPaid(e)}}})],1),t._v(" "),s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"info",className:"la-save"},on:{click:function(s){return t.updateInstalment(e)}}})],1),t._v(" "),s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"error",className:"la-trash-alt"},on:{click:function(s){return t.deleteInstalment(e)}}})],1)]):t._e(),t._v(" "),e.paid||e.id?t._e():s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[s("div",{staticClass:"px-2"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"px-3 py-1 rounded-full",on:{click:function(s){return t.createInstalment(e)}}},[s("i",{staticClass:"las la-plus"}),t._v("\n                                            "+t._s(t.__("Create"))+"\n                                        ")])])])]),t._v(" "),e.paid?s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"px-3 text-xs py-1 rounded-full",on:{click:function(s){return t.showReceipt(e)}}},[s("i",{staticClass:"las la-print"}),t._v("\n                                        "+t._s(t.__("Receipt"))+"\n                                    ")])])]):t._e()])])})),t._v(" "),s("li",{staticClass:"flex justify-between p-2 border-r border-b border-l elevation-surface"},[s("div",{staticClass:"flex items-center justify-center"},[s("span",[t._v("\n                                "+t._s(t.__("Total :"))+" "+t._s(t._f("currency")(t.order.total))+"\n                            ")]),t._v(" "),s("span",{staticClass:"ml-1 text-sm"},[t._v("\n                                ("+t._s(t.__("Remaining :"))+" "+t._s(t._f("currency")(t.order.total-t.totalInstalments))+")\n                            ")])]),t._v(" "),s("div",{staticClass:"-mx-2 flex flex-wrap items-center"},[s("span",{staticClass:"px-2"},[t._v("\n                                "+t._s(t.__("Instalments:"))+" "+t._s(t._f("currency")(t.totalInstalments))+"\n                            ")]),t._v(" "),s("span",{staticClass:"px-2"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"rounded-full px-3 py-1",on:{click:function(e){return t.addInstalment()}}},[t._v(t._s(t.__("Add Instalment")))])])])])])],2)])])])])}),[],!1,null,null,null).exports;var W={filters:{nsCurrency:r.W},name:"ns-preview-popup",data:function(){return{active:"details",order:new Object,products:[],payments:[],options:null,print:new w.Z({urls:systemUrls,options:systemOptions}),settings:null}},components:{nsOrderRefund:O,nsOrderPayment:F,nsOrderDetails:q,nsOrderInstalments:Y},computed:{isVoidable:function(){return["paid","partially_paid","unpaid"].includes(this.order.payment_status)},isDeleteAble:function(){return["hold"].includes(this.order.payment_status)}},methods:{__:c.__,popupResolver:v.Z,popupCloser:a.Z,closePopup:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.popupResolver(t)},setActive:function(t){this.active=t},printOrder:function(){this.print.process(this.order.id,"sale")},refresh:function(){this.$popupParams.component.$emit("updated"),this.loadOrderDetails(this.order.id)},loadOrderDetails:function(t){var e=this;(0,i.D)([n.ih.get("/api/nexopos/v4/orders/".concat(t)),n.ih.get("/api/nexopos/v4/orders/".concat(t,"/products")),n.ih.get("/api/nexopos/v4/orders/".concat(t,"/payments"))]).subscribe((function(t){e.order=t[0],e.products=t[1],e.payments=t[2]}))},deleteOrder:function(){var t=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this order"),onAction:function(e){e&&n.ih.delete("/api/nexopos/v4/orders/".concat(t.order.id)).subscribe({next:function(e){n.kX.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup(!0)},error:function(t){n.kX.error(t.message).subscribe()}})}})},voidOrder:function(){var t=this;try{new Promise((function(e,s){Popup.show(j.default,{resolve:e,reject:s,title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The current order will be void. This action will be recorded. Consider providing a reason for this operation"),onAction:function(e){!1!==e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/void"),{reason:e}).subscribe({next:function(e){n.kX.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup(!0)},error:function(t){n.kX.error(t.message).subscribe()}})}})}))}catch(t){console.log(t)}},refreshCrudTable:function(){this.$popupParams.component.$emit("updated",!0)}},watch:{active:function(){"details"===this.active&&this.loadOrderDetails(this.order.id)}},mounted:function(){this.order=this.$popupParams.order,this.options=systemOptions,this.urls=systemUrls,this.loadOrderDetails(this.order.id),this.popupCloser()}};window.nsOrderPreviewPopup=W;const M=W;const z=(0,_.Z)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-95vh w-95vw md:h-6/7-screen md:w-6/7-screen overflow-hidden shadow-xl ns-box flex flex-col"},[s("div",{staticClass:"border-b ns-box-header p-3 flex items-center justify-between"},[s("div",[s("h3",[t._v(t._s(t.__("Order Options")))])]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup(!0)}}})],1)]),t._v(" "),s("div",{staticClass:"p-2 overflow-scroll ns-box-body flex flex-auto"},[t.order.id?s("ns-tabs",{attrs:{active:t.active},on:{active:function(e){return t.setActive(e)}}},[s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:t.__("Details"),identifier:"details"}},[s("ns-order-details",{attrs:{order:t.order}})],1),t._v(" "),["order_void","hold","refunded","partially_refunded"].includes(t.order.payment_status)?t._e():s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:t.__("Payments"),identifier:"payments"}},[s("ns-order-payment",{attrs:{order:t.order},on:{changed:function(e){return t.refresh()}}})],1),t._v(" "),["order_void","hold","refunded"].includes(t.order.payment_status)?t._e():s("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:t.__("Refund & Return"),identifier:"refund"}},[s("ns-order-refund",{attrs:{order:t.order},on:{loadTab:function(e){return t.setActive(e)},changed:function(e){return t.refresh()}}})],1),t._v(" "),["partially_paid","unpaid"].includes(t.order.payment_status)&&t.order.support_instalments?s("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:t.__("Installments"),identifier:"instalments"}},[s("ns-order-instalments",{attrs:{order:t.order},on:{changed:function(e){return t.refresh()}}})],1):t._e()],1):t._e(),t._v(" "),t.order.id?t._e():s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1)],1),t._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[s("div",[t.isVoidable?s("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.voidOrder()}}},[s("i",{staticClass:"las la-ban"}),t._v("\n                "+t._s(t.__("Void"))+"\n            ")]):t._e(),t._v(" "),t.isDeleteAble?s("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.deleteOrder()}}},[s("i",{staticClass:"las la-trash"}),t._v("\n                "+t._s(t.__("Delete"))+"\n            ")]):t._e()],1),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.printOrder()}}},[s("i",{staticClass:"las la-print"}),t._v("\n                "+t._s(t.__("Print"))+"\n            ")])],1)])])}),[],!1,null,null,null).exports},1765:(t,e,s)=>{s.d(e,{Z:()=>l});var n=s(3632),r=s(665),i=s(2830),o=s(7700),a=s(282);const c={name:"ns-orders-refund-popup",data:function(){return{order:null,refunds:[],view:"summary",previewed:null,loaded:!1,options:systemOptions,systemUrls,print:new a.Z({urls:systemUrls,options:systemOptions})}},methods:{__:n.__,popupCloser:r.Z,popupResolver:i.Z,toggleProductView:function(t){this.view="details",this.previewed=t},loadOrderRefunds:function(){var t=this;nsHttpClient.get("/api/nexopos/v4/orders/".concat(this.order.id,"/refunds")).subscribe((function(e){t.loaded=!0,t.refunds=e.refunds}),(function(t){o.kX.error(t.message).subscribe()}))},close:function(){this.$popup.close()},printRefundReceipt:function(t){this.print.process(t.id,"refund")}},mounted:function(){this.order=this.$popupParams.order,this.popupCloser(),this.loadOrderRefunds()}};const l=(0,s(1900).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen ns-box flex flex-col overflow-hidden"},[s("div",{staticClass:"border-b p-2 flex items-center justify-between ns-box-header"},[s("h3",[t._v(t._s(t.__("Order Refunds")))]),t._v(" "),s("div",{staticClass:"flex"},["details"===t.view?s("div",{staticClass:"flex items-center justify-center cursor-pointer rounded-full px-3 border hover:bg-info-primary hover:text-white mr-1",on:{click:function(e){t.view="summary"}}},[t._v(t._s(t.__("Go Back")))]):t._e(),t._v(" "),s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"overflow-auto flex-auto ns-box-body"},["summary"===t.view?[t.loaded?t._e():s("div",{staticClass:"flex h-full w-full items-center justify-center"},[s("ns-spinner",{attrs:{size:"24"}})],1),t._v(" "),t.loaded&&0===t.refunds.length?s("div",{staticClass:"flex h-full w-full items-center justify-center"},[s("i",{staticClass:"lar la-frown-open"})]):t._e(),t._v(" "),t.loaded&&t.refunds.length>0?t._l(t.refunds,(function(e){return s("div",{key:e.id,staticClass:"border-b flex flex-col md:flex-row"},[s("div",{staticClass:"w-full md:flex-auto p-2"},[s("h3",{staticClass:"font-semibold mb-1"},[t._v(t._s(t.order.code))]),t._v(" "),s("div",[s("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[s("li",{staticClass:"px-1"},[t._v(t._s(t.__("Total"))+" : "+t._s(t._f("currency")(e.total)))]),t._v(" "),s("li",{staticClass:"px-1"},[t._v(t._s(t.__("By"))+" : "+t._s(e.author.username))])])])]),t._v(" "),s("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(s){return t.toggleProductView(e)}}},[s("i",{staticClass:"las la-eye"})]),t._v(" "),s("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(s){return t.printRefundReceipt(e)}}},[s("i",{staticClass:"las la-print"})])])})):t._e()]:t._e(),t._v(" "),"details"===t.view?t._l(t.previewed.refunded_products,(function(e){return s("div",{key:e.id,staticClass:"border-b flex flex-col md:flex-row"},[s("div",{staticClass:"w-full md:flex-auto p-2"},[s("h3",{staticClass:"font-semibold mb-1"},[t._v(t._s(e.product.name))]),t._v(" "),s("div",[s("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[s("li",{staticClass:"px-1"},[t._v(t._s(t.__("Condition"))+" : "+t._s(e.condition))]),t._v(" "),s("li",{staticClass:"px-1"},[t._v(t._s(t.__("Quantity"))+" : "+t._s(e.quantity))]),t._v(" "),s("li",{staticClass:"px-1"},[t._v(t._s(t.__("Total"))+" : "+t._s(t._f("currency")(e.total_price)))])])])])])})):t._e()],2)])}),[],!1,null,null,null).exports},3630:(t,e,s)=>{s.d(e,{Z:()=>l});var n=s(665),r=s(2830),i=s(7700),o=s(3632),a=s(3815);s(9093);const c={name:"ns-pos-coupons-load-popup",components:{nsNotice:s(2404).Z},data:function(){return{placeHolder:(0,o.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var t=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e,t.order.coupons.length>0&&(t.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(e){t.customerCoupon=e,t.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:o.__,popupCloser:n.Z,popupResolver:r.Z,selectCustomer:function(){Popup.show(a.Z)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(t){this.order.coupons.splice(t,1),POS.refreshCart()},apply:function(){var t=this;try{var e=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();var s=this.customerCoupon.coupon.products;if(s.length>0){var n=s.map((function(t){return t.product_id}));if(0===this.order.products.filter((function(t){return n.includes(t.product_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var r=this.customerCoupon.coupon.categories;if(r.length>0){var a=r.map((function(t){return t.category_id}));if(0===this.order.products.filter((function(t){return a.includes(t.$original().category_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var c={active:e.coupon.active,customer_coupon_id:e.id,minimum_cart_value:e.coupon.minimum_cart_value,maximum_cart_value:e.coupon.maximum_cart_value,name:e.coupon.name,type:e.coupon.type,value:0,limit_usage:e.coupon.limit_usage,code:e.coupon.code,discount_value:e.coupon.discount_value,categories:e.coupon.categories,products:e.coupon.products};POS.pushCoupon(c),this.activeTab="active-coupons",setTimeout((function(){t.popupResolver(c)}),500),i.kX.success((0,o.__)("The coupon has applied to the cart.")).subscribe()}catch(t){console.log(t)}},getCouponType:function(t){switch(t){case"percentage_discount":return(0,o.__)("Percentage");case"flat_discount":return(0,o.__)("Flat");default:return(0,o.__)("Unknown Type")}},getDiscountValue:function(t){switch(t.type){case"percentage_discount":return t.discount_value+"%";case"flat_discount":return this.$options.filters.currency(t.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(t){this.activeTab=t},getCoupon:function(t){return!this.order.customer_id>0?i.kX.error((0,o.__)("You must select a customer before applying a coupon.")).subscribe():i.ih.post("/api/nexopos/v4/customers/coupons/".concat(t),{customer_id:this.order.customer_id})},loadCoupon:function(){var t=this,e=this.couponCode;this.getCoupon(e).subscribe({next:function(e){t.customerCoupon=e,i.kX.success((0,o.__)("The coupon has been loaded.")).subscribe()},error:function(t){i.kX.error(t.message||(0,o.__)("An unexpected error occurred.")).subscribe()}})}}};const l=(0,s(1900).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/6-screen lg:w-2/6-screen"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[s("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Load Coupon")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"p-1 ns-box-body"},[s("ns-tabs",{attrs:{active:t.activeTab},on:{changeTab:function(e){return t.setActiveTab(e)}}},[s("ns-tabs-item",{attrs:{label:t.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[s("div",{staticClass:"border-2 input-group info rounded flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full text-primary p-2 outline-none",attrs:{type:"text",placeholder:t.placeHolder},domProps:{value:t.couponCode},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadCoupon()},input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),t._v(" "),s("button",{staticClass:"px-3 py-2",on:{click:function(e){return t.loadCoupon()}}},[t._v(t._s(t.__("Load")))])]),t._v(" "),s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"info"},scopedSlots:t._u([{key:"description",fn:function(){return[t._v(t._s(t.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))]},proxy:!0}])})],1),t._v(" "),t.order&&void 0===t.order.customer_id?s("div",{staticClass:"pt-2 flex"},[s("button",{staticClass:"w-full border p-2 outline-none ns-numpad-key info cursor-pointer text-center",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Click here to choose a customer.")))])]):t._e(),t._v(" "),t.order&&void 0!==t.order.customer_id?s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"success"},scopedSlots:t._u([{key:"description",fn:function(){return[t._v(t._s(t.__("Loading Coupon For : ")+t.order.customer.name+" "+t.order.customer.surname))]},proxy:!0}],null,!1,2531213351)})],1):t._e(),t._v(" "),s("div",{staticClass:"overflow-hidden"},[t.customerCoupon?s("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto ns-scrollbar h-64"},[s("table",{staticClass:"w-full ns-table"},[s("tbody",[s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Coupon Name")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.name))])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Discount"))+" ("+t._s(t.getCouponType(t.customerCoupon.coupon.type))+")")]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.getDiscountValue(t.customerCoupon.coupon)))])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Usage")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.usage+"/"+(t.customerCoupon.limit_usage||t.__("Unlimited"))))])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Valid From")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_start||t.__("N/A")))])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Valid Till")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_end||t.__("N/A")))])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Categories")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",[t._l(t.customerCoupon.coupon.categories,(function(e){return s("li",{key:e.id,staticClass:"rounded-full px-3 py-1 border"},[t._v(t._s(e.category.name))])})),t._v(" "),0===t.customerCoupon.coupon.categories.length?s("li",[t._v(t._s(t.__("Not applicable")))]):t._e()],2)])]),t._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Products")))]),t._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",[t._l(t.customerCoupon.coupon.products,(function(e){return s("li",{key:e.id,staticClass:"rounded-full px-3 py-1 border"},[t._v(t._s(e.product.name))])})),t._v(" "),0===t.customerCoupon.coupon.products.length?s("li",[t._v(t._s(t.__("Not applicable")))]):t._e()],2)])])])])]):t._e()])]),t._v(" "),s("ns-tabs-item",{attrs:{label:t.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[t.order?s("ul",[t._l(t.order.coupons,(function(e,n){return s("li",{key:n,staticClass:"flex justify-between elevation-surface border items-center px-2 py-1"},[s("div",{staticClass:"flex-auto"},[s("h3",{staticClass:"font-semibold text-primary p-2 flex justify-between"},[s("span",[t._v(t._s(e.name))]),t._v(" "),s("span",[t._v(t._s(t.getDiscountValue(e)))])])]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.removeCoupon(n)}}})],1)])})),t._v(" "),0===t.order.coupons.length?s("li",{staticClass:"flex justify-between elevation-surface border items-center p-2"},[t._v("\n                        "+t._s(t.__("No coupons applies to the cart."))+"\n                    ")]):t._e()],2):t._e()])],1)],1),t._v(" "),t.customerCoupon?s("div",{staticClass:"flex"},[s("button",{staticClass:"w-1/2 px-3 py-2 bg-success-tertiary text-white font-bold",on:{click:function(e){return t.apply()}}},[t._v("\n            "+t._s(t.__("Apply"))+"\n        ")]),t._v(" "),s("button",{staticClass:"w-1/2 px-3 py-2 bg-error-tertiary text-white font-bold",on:{click:function(e){return t.cancel()}}},[t._v("\n            "+t._s(t.__("Cancel"))+"\n        ")])]):t._e()])}),[],!1,null,null,null).exports},3815:(t,e,s)=>{s.d(e,{Z:()=>c});var n=s(7700),r=s(2830),i=s(6979),o=s(9354);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(t){var e=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){e.searchCustomer(t)}),500)}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){t.order=e})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:s(3632).__,resolveIfQueued:r.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);n.kX.info("Too many result.").subscribe()},openCustomerHistory:function(t,e){e.stopImmediatePropagation(),this.$popup.close(),i.G.show(o.Z,{customer:t,activeTab:"account-payment"})},selectCustomer:function(t){var e=this;this.customers.forEach((function(t){return t.selected=!1})),t.selected=!0,this.isLoading=!0,POS.selectCustomer(t).then((function(s){e.isLoading=!1,e.resolveIfQueued(t)})).catch((function(t){e.isLoading=!1}))},searchCustomer:function(t){var e=this;n.ih.post("/api/nexopos/v4/customers/search",{search:t}).subscribe((function(t){t.forEach((function(t){return t.selected=!1})),e.customers=t}))},createCustomerWithMatch:function(t){this.resolveIfQueued(!1),i.G.show(o.Z,{name:t})},getRecentCustomers:function(){var t=this;this.isLoading=!0,n.ih.get("/api/nexopos/v4/customers/recently-active").subscribe({next:function(e){t.isLoading=!1,e.forEach((function(t){return t.selected=!1})),t.customers=e},error:function(e){t.isLoading=!1}})}}};const c=(0,s(1900).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108",attrs:{id:"ns-pos-customer-select-popup"}},[s("div",{staticClass:"border-b ns-box-header text-center font-semibold text-2xl py-2",attrs:{id:"header"}},[s("h2",[t._v(t._s(t.__("Select Customer")))])]),t._v(" "),s("div",{staticClass:"relative"},[s("div",{staticClass:"p-2 border-b ns-box-body items-center flex justify-between"},[s("span",[t._v(t._s(t.__("Selected"))+" : ")]),t._v(" "),s("div",{staticClass:"flex items-center justify-between"},[s("span",[t._v(t._s(t.order.customer?t.order.customer.name:"N/A"))]),t._v(" "),t.order.customer?s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button hover:border-transparent",on:{click:function(e){return t.openCustomerHistory(t.order.customer,e)}}},[s("i",{staticClass:"las la-eye"})]):t._e()])]),t._v(" "),s("div",{staticClass:"p-2 border-b ns-box-body flex justify-between text-primary"},[s("div",{staticClass:"input-group flex-auto border-2 rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"outline-none w-full p-2",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:t.searchCustomerValue},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.attemptToChoose()},input:function(e){e.target.composing||(t.searchCustomerValue=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto ns-scrollbar"},[s("ul",{staticClass:"ns-vertical-menu"},[t.customers&&0===t.customers.length?s("li",{staticClass:"p-2 text-center text-primary"},[t._v("\n                    "+t._s(t.__("No customer match your query..."))+"\n                ")]):t._e(),t._v(" "),t.customers&&0===t.customers.length?s("li",{staticClass:"p-2 cursor-pointer text-center text-primary",on:{click:function(e){return t.createCustomerWithMatch(t.searchCustomerValue)}}},[s("span",{staticClass:"border-b border-dashed border-info-primary"},[t._v(t._s(t.__("Create a customer")))])]):t._e(),t._v(" "),t._l(t.customers,(function(e){return s("li",{key:e.id,staticClass:"cursor-pointer p-2 border-b text-primary flex justify-between items-center",on:{click:function(s){return t.selectCustomer(e)}}},[s("span",[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"flex items-center"},[e.owe_amount>0?s("span",{staticClass:"text-error-primary"},[t._v("-"+t._s(t._f("currency")(e.owe_amount)))]):t._e(),t._v(" "),e.owe_amount>0?s("span",[t._v("/")]):t._e(),t._v(" "),s("span",{staticClass:"purchase-amount"},[t._v(t._s(t._f("currency")(e.purchases_amount)))]),t._v(" "),s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button info",on:{click:function(s){return t.openCustomerHistory(e,s)}}},[s("i",{staticClass:"las la-eye"})])])])}))],2)]),t._v(" "),t.isLoading?s("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[s("ns-spinner",{attrs:{size:"24",border:"8"}})],1):t._e()])])}),[],!1,null,null,null).exports},9354:(t,e,s)=>{s.d(e,{Z:()=>C});var n=s(4687),r=s.n(n),i=s(665),o=s(7700),a=s(6979),c=s(3815),l=s(4679),u=s(3632);const d={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new l.Z}},methods:{__:u.__,closeWithOverlayClicked:i.Z,proceed:function(){var t=this,e=this.$popupParams.customer,s=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,o.ih.post("/api/nexopos/v4/customers/".concat(e.id,"/account-history"),s).subscribe({next:function(e){t.isSubmiting=!1,o.kX.success(e.message).subscribe(),t.$popupParams.resolve(e),t.$popup.close()},error:function(e){t.isSubmiting=!1,o.kX.error(e.message).subscribe(),t.$popupParams.reject(e)}})},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var t=this;o.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe({next:function(e){t.fields=t.formValidation.createFields(e)}})}}};var p=s(1900);const _=(0,p.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg ns-box flex flex-col relative"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t.__("New Transaction")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[0===t.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):t._e(),t._v(" "),t.fields.length>0?s("div",{staticClass:"p-2"},t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1):t._e()]),t._v(" "),s("div",{staticClass:"p-2 ns-box-footer justify-between border-t flex"},[s("div"),t._v(" "),s("div",{staticClass:"px-1"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.__("Close")))])],1),t._v(" "),s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.proceed()}}},[t._v(t._s(t.__("Proceed")))])],1)])])]),t._v(" "),0===t.isSubmiting?s("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[s("ns-spinner")],1):t._e()])}),[],!1,null,null,null).exports;var f=s(3630),v=s(914),m=s(2830),b=s(3502),h=s(800);function y(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}const x={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,isLoadingHistory:!1,isLoadingOrders:!1,coupons:[],rewardsResponse:[],order:null,walletHistories:[]}},components:{nsPaginate:b.Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var t=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),this.subscription=POS.order.subscribe((function(e){t.order=e,void 0!==t.$popupParams.customer?(t.activeTab="account-payment",t.customer=t.$popupParams.customer,t.loadCustomerOrders()):void 0!==e.customer&&(t.activeTab="account-payment",t.customer=e.customer,t.loadCustomerOrders())})),this.popupCloser()},methods:{__:u.__,reload:function(){this.loadCustomerOrders()},popupResolver:m.Z,popupCloser:i.Z,getWalletHistoryLabel:function(t){switch(t){case"add":return(0,u.__)("Crediting");case"deduct":return(0,u.__)("Removing");case"refund":return(0,u.__)("Refunding");case"payment":return(0,u.__)("Payment");default:return(0,u.__)("Unknow")}},getType:function(t){switch(t){case"percentage_discount":return(0,u.__)("Percentage Discount");case"flat_discount":return(0,u.__)("Flat Discount")}},closeWithOverlayClicked:i.Z,openOrderOptions:function(t){var e,s=this;return(e=r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,s){a.G.show(h.Z,{order:t,resolve:e,reject:s})}));case 3:e.sent,s.reload(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o.kX.error((0,u.__)("An error occurred while opening the order options")).subscribe();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function o(t){y(i,n,r,o,a,"next",t)}function a(t){y(i,n,r,o,a,"throw",t)}o(void 0)}))})()},doChangeTab:function(t){this.selectedTab=t,"coupons"===t&&this.loadCoupons(),"rewards"===t&&this.loadRewards(),"wallet-history"===t&&this.loadAccounHistory(),"orders"===t&&this.loadCustomerOrders()},loadAccounHistory:function(){var t=this;this.isLoadingHistory=!0,o.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/account-history")).subscribe({next:function(e){t.walletHistories=e.data,t.isLoadingHistory=!1},error:function(e){t.isLoadingHistory=!1}})},loadCoupons:function(){var t=this;this.isLoadingCoupons=!0,o.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(e){t.coupons=e,t.isLoadingCoupons=!1},error:function(e){t.isLoadingCoupons=!1}})},loadRewards:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,o.ih.get(e).subscribe({next:function(e){t.rewardsResponse=e,t.isLoadingRewards=!1},error:function(e){t.isLoadingRewards=!1}})},prefillForm:function(t){void 0!==this.$popupParams.name&&(t.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),a.G.show(c.Z)},loadCustomerOrders:function(){var t=this;this.isLoadingOrders=!0,o.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/orders")).subscribe({next:function(e){t.orders=e,t.isLoadingOrders=!1},error:function(e){t.isLoadingOrders=!1}})},newTransaction:function(t){new Promise((function(e,s){a.G.show(_,{customer:t,resolve:e,reject:s})})).then((function(e){POS.loadCustomer(t.id).subscribe((function(t){POS.selectCustomer(t)}))}))},applyCoupon:function(t){var e=this;void 0===this.order.customer?a.G.show(v.default,{title:(0,u.__)("Use Customer ?"),message:(0,u.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(s){s&&POS.selectCustomer(e.customer).then((function(s){e.proceedApplyingCoupon(t)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(t):this.order.customer.id!==this.customer.id&&a.G.show(v.default,{title:(0,u.__)("Change Customer ?"),message:(0,u.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(s){s&&POS.selectCustomer(e.customer).then((function(s){e.proceedApplyingCoupon(t)}))}})},proceedApplyingCoupon:function(t){var e=this;new Promise((function(e,s){a.G.show(f.Z,{apply_coupon:t.code,resolve:e,reject:s})})).then((function(t){e.popupResolver(!1)})).catch((function(t){}))},handleSavedCustomer:function(t){o.kX.success(t.message).subscribe(),POS.selectCustomer(t.entry),this.$popup.close()}}};const C=(0,p.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg rounded modal-customers-width flex flex-col overflow-hidden modal-customer-section",attrs:{id:"ns-pos-customers"}},[s("div",{staticClass:"ns-header flex justify-between items-center border-b"},[s("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Customers")))]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),s("div",{staticClass:"ns-body tabs-nav flex-auto flex p-2 overflow-y-auto"},[s("ns-tabs",{attrs:{active:t.activeTab},on:{active:function(e){t.activeTab=e}}},[s("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===t.options.ns_pos_customers_creation_enabled?s("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(e){return t.prefillForm(e)},save:function(e){return t.handleSavedCustomer(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[t._v(t._s(t.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):t._e(),t._v(" "),"yes"!==t.options.ns_pos_customers_creation_enabled?s("div",{staticClass:"h-full flex-col w-full flex items-center justify-center text-primary"},[s("i",{staticClass:"lar la-hand-paper ns-icon text-6xl"}),t._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[t._v(t._s(t.__("Not Authorized")))]),t._v(" "),s("p",[t._v(t._s(t.__("Creating customers has been explicitly disabled from the settings.")))])]):t._e()],1),t._v(" "),s("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:t.__("Customer Account")}},[null===t.customer?s("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[s("i",{staticClass:"lar la-frown text-6xl"}),t._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[t._v(t._s(t.__("No Customer Selected")))]),t._v(" "),s("p",[t._v(t._s(t.__("In order to see a customer account, you need to select one customer.")))]),t._v(" "),s("div",{staticClass:"my-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.openCustomerSelection()}}},[t._v(t._s(t.__("Select Customer")))])],1)]):t._e(),t._v(" "),t.customer?s("div",{staticClass:"flex flex-col flex-auto"},[s("div",{staticClass:"flex-auto flex flex-col"},[s("div",{staticClass:"-mx-4 flex flex-wrap ns-tab-cards mb-4"},[s("div",{staticClass:"px-4 my-4 w-full"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t.__("Summary For"))+" : "+t._s(t.customer.name))])]),t._v(" "),s("div",{staticClass:"pr-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"tab-box tab-secondary"},[s("div",{staticClass:"flex justify-between items-center"},[s("div",{staticClass:"tabs-card-img"},[s("img",{attrs:{src:"/images/bags.png",alt:""}})]),t._v(" "),s("h3",{staticClass:"text-end"},[t._v(t._s(t.__("Total Purchases")))])]),t._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.customer.purchases_amount)))])])])]),t._v(" "),s("div",{staticClass:"pr-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"tab-box tab-red"},[s("div",{staticClass:"flex justify-between items-center"},[s("div",{staticClass:"tabs-card-img"},[s("img",{attrs:{src:"/images/owed.png",alt:""}})]),t._v(" "),s("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Total Owed")))])]),t._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.customer.owed_amount)))])])])]),t._v(" "),s("div",{staticClass:"pr-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"tab-box tab-blue"},[s("div",{staticClass:"flex justify-between items-center"},[s("div",{staticClass:"tabs-card-img"},[s("img",{attrs:{src:"/images/wallet.png",alt:""}})]),t._v(" "),s("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Wallet Amount")))])]),t._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.customer.account_amount)))])])])]),t._v(" "),s("div",{staticClass:"pr-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"tab-box tab-pink"},[s("div",{staticClass:"flex justify-between items-center"},[s("div",{staticClass:"tabs-card-img"},[s("img",{attrs:{src:"/images/card.png",alt:""}})]),t._v(" "),s("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Credit Limit")))])]),t._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.customer.credit_limit_amount))+" ")])])])])]),t._v(" "),s("div",{staticClass:"flex flex-auto flex-col overflow-hidden tabs-nav-container"},[s("ns-tabs",{attrs:{active:t.selectedTab},on:{changeTab:function(e){return t.doChangeTab(e)}}},[s("ns-tabs-item",{attrs:{identifier:"orders",label:t.__("Orders")}},[t.isLoadingOrders?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingOrders?t._e():[s("div",{staticClass:"py-3 w-full"},[s("h2",{staticClass:"font-semibold text-black"},[t._v(t._s(t.__("Last Purchases")))])]),t._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto modal-height"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-black"},[s("th",{staticClass:"p-3 font-semibold",attrs:{colspan:"3",width:"150"}},[s("div",{staticClass:"flex flex-col items-start"},[s("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[s("div",{staticClass:"md:px-2 flex items-center w-full md:w-1/4"},[s("small",[t._v("Order")])]),t._v(" "),s("div",{staticClass:"md:px-2 flex items-center justify-center w-full md:w-1/4"},[s("small",[t._v(t._s(t.__("Status")))])]),t._v(" "),s("div",{staticClass:"md:px-2 flex items-center justify-center w-full md:w-1/4"},[s("small",[t._v(t._s(t.__("Delivery")))])]),t._v(" "),s("div",{staticClass:"md:px-2 flex items-center justify-center w-full md:w-1/4"},[s("small",[t._v(t._s(t.__("Options")))])])])])])])]),t._v(" "),s("tbody",{staticClass:"text-black"},[0===t.orders.length?s("tr",[s("td",{staticClass:"p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No orders...")))])]):t._e(),t._v(" "),t._l(t.orders,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"p-3 text-center",attrs:{colspan:"3"}},[s("div",{staticClass:"flex flex-col items-start"},[s("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[s("div",{staticClass:"md:px-2 w-full md:w-1/4 text-left"},[s("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Code"))+": "+t._s(e.code))]),t._v(" "),s("small",[t._v(t._s(t.__("Total"))+": "+t._s(t._f("currency")(e.total)))])]),t._v(" "),s("div",{staticClass:"md:px-2 w-full md:w-1/4 td-main"},[s("small",[t._v(t._s(t.__("Status"))+": "+t._s(e.human_status))])]),t._v(" "),s("div",{staticClass:"md:px-2 w-full md:w-1/4 td-main"},[s("small",[t._v(t._s(t.__("Delivery"))+": "+t._s(e.human_delivery_status))])]),t._v(" "),s("div",{staticClass:"md:px-2 text-center w-full md:w-1/4"},[s("button",{staticClass:"custom-btn",on:{click:function(s){return t.openOrderOptions(e)}}},[s("img",{staticClass:"mr-2",attrs:{src:"/images/tab-wallet.png",alt:""}}),t._v(" "),s("span",{staticClass:"ml-1"},[t._v(t._s(t.__("Options")))])])])])])])])}))],2)])])])]],2),t._v(" "),s("ns-tabs-item",{attrs:{identifier:"wallet-history",label:t.__("Wallet History")}},[t.isLoadingHistory?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingHistory?t._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Wallet History")))])]),t._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{colspan:"3",width:"150"}},[t._v(t._s(t.__("Transaction")))])])]),t._v(" "),s("tbody",{staticClass:"text-primary"},[0===t.walletHistories.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[t._v(t._s(t.__("No History...")))])]):t._e(),t._v(" "),t._l(t.walletHistories,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[s("div",{staticClass:"flex flex-col items-start"},[s("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Transaction"))+": "+t._s(t.getWalletHistoryLabel(e.operation)))]),t._v(" "),s("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[s("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/3"},[s("small",[t._v(t._s(t.__("Amount"))+": "+t._s(t._f("currency")(e.amount)))])]),t._v(" "),s("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/3"},[s("small",[t._v(t._s(t.__("Date"))+": "+t._s(e.created_at))])])])])])])}))],2)])])])]],2),t._v(" "),s("ns-tabs-item",{attrs:{identifier:"coupons",label:t.__("Coupons")}},[t.isLoadingCoupons?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingCoupons?t._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Type")))]),t._v(" "),s("th",{staticClass:"p-2 border font-semibold"})])]),t._v(" "),s("tbody",{staticClass:"text-primary text-sm"},[0===t.coupons.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No coupons for the selected customer...")))])]):t._e(),t._v(" "),t._l(t.coupons,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",[t._v(t._s(e.name))]),t._v(" "),s("div",{},[s("ul",{staticClass:"-mx-2 flex"},[s("li",{staticClass:"text-xs text-primary px-2"},[t._v(t._s(t.__("Usage :"))+" "+t._s(e.usage)+"/"+t._s(e.limit_usage))]),t._v(" "),s("li",{staticClass:"text-xs text-primary px-2"},[t._v(t._s(t.__("Code :"))+" "+t._s(e.code))])])])]),t._v(" "),s("td",{staticClass:"border p-2 text-center"},[t._v(t._s(t.getType(e.coupon.type))+"\n                                                                "),"percentage_discount"===e.coupon.type?s("span",[t._v("\n                                                                    ("+t._s(e.coupon.discount_value)+"%)\n                                                                ")]):t._e(),t._v(" "),"flat_discount"===e.coupon.type?s("span",[t._v("\n                                                                    ("+t._s(t._f("currency")(e.coupon.discount_value))+")\n                                                                ")]):t._e()]),t._v(" "),s("td",{staticClass:"border p-2 text-right"},[s("ns-button",{attrs:{type:"info"},on:{click:function(s){return t.applyCoupon(e)}}},[t._v(t._s(t.__("Use Coupon")))])],1)])}))],2)])])])]],2),t._v(" "),s("ns-tabs-item",{attrs:{identifier:"rewards",label:t.__("Rewards")}},[t.isLoadingRewards?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingRewards?t._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Rewards")))])]),t._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Points")))]),t._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Target")))])])]),t._v(" "),t.rewardsResponse.data?s("tbody",{staticClass:"text-primary text-sm"},[0===t.rewardsResponse.data.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No rewards available the selected customer...")))])]):t._e(),t._v(" "),t._l(t.rewardsResponse.data,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[t._v(t._s(e.reward_name))])]),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[t._v(t._s(e.points))])]),t._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[t._v(t._s(e.target))])])])}))],2):t._e()])])]),t._v(" "),s("div",{staticClass:"py-1 flex justify-end"},[s("ns-paginate",{attrs:{pagination:t.rewardsResponse},on:{load:function(e){return t.loadRewards(e)}}})],1)]],2)],1)],1)]),t._v(" "),s("div",{staticClass:"p-2 flex justify-center"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.newTransaction(t.customer)}}},[t._v(t._s(t.__("Account Transaction")))])],1)])]):t._e()])],1)],1)])}),[],!1,null,null,null).exports},409:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});const n={name:"ns-pos-loading-popup"};const r=(0,s(1900).Z)(n,(function(){var t=this.$createElement;return(this._self._c||t)("ns-spinner")}),[],!1,null,null,null).exports},4523:(t,e,s)=>{s.d(e,{Z:()=>u});var n=s(4687),r=s.n(n),i=s(2830),o=s(3632),a=s(665);function c(t,e,s,n,r,i,o){try{var a=t[i](o),c=a.value}catch(t){return void s(t)}a.done?e(c):Promise.resolve(c).then(n,r)}const l={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(e){t.types=e,1===Object.values(t.types).length&&t.select(Object.keys(t.types)[0])})),this.popupCloser()},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:o.__,popupCloser:a.Z,popupResolver:i.Z,resolveIfQueued:i.Z,select:function(t){var e,s=this;return(e=r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.values(s.types).forEach((function(t){return t.selected=!1})),s.types[t].selected=!0,n=s.types[t],e.prev=3,e.next=6,POS.triggerOrderTypeSelection(n);case 6:e.sent,POS.types.next(s.types),s.resolveIfQueued(n),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function o(t){c(i,n,r,o,a,"next",t)}function a(t){c(i,n,r,o,a,"throw",t)}o(void 0)}))})()}}};const u=(0,s(1900).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen shadow-lg",attrs:{id:"ns-order-type"}},[s("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[s("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Define The Order Type")))])]),t._v(" "),0===Object.values(t.types).length?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-1 grid-rows-1"},[s("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[s("i",{staticClass:"las la-frown text-7xl"}),t._v(" "),s("div",{staticClass:"p-4 md:w-2/3"},[s("p",{staticClass:"text-center"},[t._v(t._s(t.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),t._v(" "),s("div",{staticClass:"flex justify-center py-1"},[s("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[t._v(t._s(t.__("Read More")))])],1)])])]):t._e(),t._v(" "),Object.values(t.types).length>0?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-2 grid-rows-2"},t._l(t.types,(function(e){return s("div",{key:e.identifier,staticClass:"ns-numpad-key info h-56 flex items-center justify-center flex-col cursor-pointer border",class:e.selected?"active":"",on:{click:function(s){return t.select(e.identifier)}}},[s("img",{staticClass:"w-32 h-32",attrs:{src:e.icon,alt:""}}),t._v(" "),s("h4",{staticClass:"font-semibold text-xl my-2"},[t._v(t._s(e.label))])])})),0):t._e()])}),[],!1,null,null,null).exports},9958:(t,e,s)=>{s.d(e,{Z:()=>l});var n=s(7700),r=s(3632),i=s(665),o=s(7751),a=s(8909);const c={components:{nsNumpad:o.Z,nsNumpadPlus:a.Z},data:function(){return{finalValue:1,virtualStock:null,options:{},optionsSubscription:null,allSelected:!0,isLoading:!1}},beforeDestroy:function(){this.optionsSubscription.unsubscribe()},mounted:function(){var t=this;this.optionsSubscription=POS.options.subscribe((function(e){t.options=e})),this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),this.popupCloser()},destroyed:function(){nsHotPress.destroy("pos-quantity-numpad"),nsHotPress.destroy("pos-quantity-backspace"),nsHotPress.destroy("pos-quantity-enter")},methods:{__:r.__,popupCloser:i.Z,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},updateQuantity:function(t){this.finalValue=t},defineQuantity:function(t){var e=this.$popupParams,s=e.product,i=e.data;if(0===t)return n.kX.error((0,r.__)("Please provide a quantity")).subscribe();if("enabled"===s.$original().stock_management&&"materialized"===s.$original().type){var o=POS.getStockUsage(s.$original().id,i.unit_quantity_id)-(s.quantity||0);if(t>parseFloat(i.$quantities().quantity)-o)return n.kX.error((0,r.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",i.$quantities().quantity-o)).subscribe()}this.resolve({quantity:t})},resolve:function(t){this.$popupParams.resolve(t),this.$popup.close()}}};const l=(0,s(1900).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[t.isLoading?s("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[s("ns-spinner")],1):t._e(),t._v(" "),s("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[s("div",[s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Define Quantity")))])]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"h-24 border-b primary ns-box-body flex items-center justify-center",attrs:{id:"screen"}},[s("h1",{staticClass:"font-bold text-3xl"},[t._v(t._s(t.finalValue))])]),t._v(" "),"default"===t.options.ns_pos_numpad?s("ns-numpad",{attrs:{floating:t.options.ns_pos_allow_decimal_quantities,value:t.finalValue},on:{changed:function(e){return t.updateQuantity(e)},next:function(e){return t.defineQuantity(e)}}}):t._e(),t._v(" "),"advanced"===t.options.ns_pos_numpad?s("ns-numpad-plus",{attrs:{value:t.finalValue},on:{changed:function(e){return t.updateQuantity(e)},next:function(e){return t.defineQuantity(e)}}}):t._e()],1)}),[],!1,null,null,null).exports},6071:(t,e,s)=>{s.d(e,{Z:()=>u});var n=s(7700),r=s(2830),i=s(4679);function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function a(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){c(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const l={name:"ns-pos-shipping-popup",computed:{activeTabFields:function(){if(null!==this.tabs)for(var t in this.tabs)if(this.tabs[t].active)return this.tabs[t].fields;return[]},useBillingInfo:function(){return null!==this.tabs?this.tabs.billing.fields[0].value:new Object},useShippingInfo:function(){return null!==this.tabs?this.tabs.shipping.fields[0].value:new Object}},destroyed:function(){this.orderSubscription.unsubscribe()},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){return t.order=e})),this.loadForm()},data:function(){return{tabs:null,orderSubscription:null,order:null,formValidation:new i.Z}},watch:{useBillingInfo:function(t){var e=this;1===t&&this.tabs.billing.fields.forEach((function(t){"_use_customer_billing"!==t.name&&(t.value=e.order.customer.billing?e.order.customer.billing[t.name]:t.value)}))},useShippingInfo:function(t){var e=this;1===t&&this.tabs.shipping.fields.forEach((function(t){"_use_customer_shipping"!==t.name&&(t.value=e.order.customer.shipping?e.order.customer.shipping[t.name]:t.value)}))}},methods:{__,resolveIfQueued:r.Z,submitInformations:function(){var t=this.formValidation.extractForm({tabs:this.tabs});for(var e in t.general)["shipping","shipping_rate"].includes(e)&&(t.general[e]=parseFloat(t.general[e]));this.order=a(a({},this.order),t.general),delete t.general,delete t.shipping._use_customer_shipping,delete t.billing._use_customer_billing,this.order.addresses=t,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup:function(){this.resolveIfQueued(!1)},toggle:function(t){for(var e in this.tabs)this.tabs[e].active=!1;this.tabs[t].active=!0},loadForm:function(){var t=this;n.ih.get("/api/nexopos/v4/forms/ns.pos-addresses").subscribe((function(e){var s=e.tabs,n=function(e){"general"===e?s[e].fields.forEach((function(e){e.value=t.order[e.name]||""})):s[e].fields.forEach((function(s){s.value=t.order.addresses[e]?t.order.addresses[e][s.name]:""}))};for(var r in s)n(r);t.tabs=t.formValidation.initializeTabs(s)}))}}};const u=(0,s(1900).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"font-bold text-primary"},[t._v(t._s(t.__("Shipping & Billing")))]),t._v(" "),s("div",{staticClass:"tools"},[s("button",{staticClass:"ns-close-button rounded-full h-8 w-8 border items-center justify-center",on:{click:function(e){return t.closePopup()}}},[s("i",{staticClass:"las la-times"})])])]),t._v(" "),s("div",{staticClass:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},[s("div",{attrs:{id:"tabs-container"}},[s("div",{staticClass:"header flex",staticStyle:{"margin-bottom":"-1px"}},t._l(t.tabs,(function(e,n){return s("div",{key:n,staticClass:"tab rounded-tl rounded-tr border tab px-3 py-2 text-primary cursor-pointer",class:e.active?"border-b-0 active":"inactive",staticStyle:{"margin-right":"-1px"},on:{click:function(e){return t.toggle(n)}}},[t._v(t._s(e.label))])})),0),t._v(" "),s("div",{staticClass:"border ns-tab-item"},[s("div",{staticClass:"px-4"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},t._l(t.activeTabFields,(function(e,n){return s("div",{key:n,class:"p-4 w-full md:w-1/2 lg:w-1/3"},[s("ns-field",{attrs:{field:e},on:{blur:function(s){return t.formValidation.checkField(e)},change:function(s){return t.formValidation.checkField(e)}}})],1)})),0)])])])]),t._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitInformations()}}},[t._v(t._s(t.__("Save")))])],1)])])}),[],!1,null,null,null).exports},3033:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});const n={data:function(){return{title:"",message:"",input:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var t=this;this.input=this.$popupParams.input||"",this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())}))},methods:{__:s(3632).__,emitAction:function(t){this.$popupParams.onAction(t?this.input:t),this.$popup.close()},reject:function(t){void 0!==this.$popupParams.reject&&this.$popupParams.reject(t),this.$popup.close()}}};const r=(0,s(1900).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-5/7-screen md:w-3/7-screen flex flex-col shadow-lg",class:t.size,attrs:{id:"prompt-popup"}},[s("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-2"},[s("h2",{staticClass:"text-3xl font-body"},[t._v(t._s(t.title))]),t._v(" "),s("p",{staticClass:"w-full md:mx-auto md:w-2/3 py-4 text-center"},[t._v(t._s(t.message))])]),t._v(" "),s("div",{staticClass:"p-2"},[s("div",{staticClass:"ns-input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"w-full border-2 p-2",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"flex border-t action-buttons"},[s("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.emitAction(!0)}}},[t._v(t._s(t.__("Ok")))]),t._v(" "),s("hr",{staticClass:"border-r"}),t._v(" "),s("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.reject(!1)}}},[t._v(t._s(t.__("Cancel")))])])])}),[],!1,null,null,null).exports},2614:(t,e,s)=>{s.d(e,{Z:()=>o});var n=s(665),r=s(3632);const i={data:function(){return{value:[],options:[],description:"",label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.description=this.$popupParams.description||"",this.type=this.$popupParams.type||this.type},methods:{popupCloser:n.Z,__:r.__,toggle:function(t){var e=this.value.indexOf(t);-1===e?this.value.unshift(t):this.value.splice(e,1)},isSelected:function(t){return this.value.indexOf(t)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(t){void 0!==t&&(this.value=[t]),this.$popupParams.resolve(this.value),this.close()}}};const o=(0,s(1900).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl ns-box w-6/7-screen md:w-4/7-screen lg:w-3/7-screen max-h-5/6-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 flex justify-between border-b items-center ns-box-header"},[s("span",{staticClass:"text-semibold text-primary"},[t._v("\n            "+t._s(t.label)+"\n        ")]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex flex-col overflow-hidden"},[t.description.length>0?s("p",{staticClass:"p-2 text-center text-sm bg-info-primary"},[t._v(t._s(t.description))]):t._e(),t._v(" "),s("div",{staticClass:"overflow-y-auto"},[s("ul",{staticClass:"ns-vertical-menu"},["select"===t.type?t._l(t.options,(function(e){return s("li",{key:e.value,staticClass:"p-2 border-b border-box-edge text-primary cursor-pointer",on:{click:function(s){return t.select(e)}}},[t._v(t._s(e.label))])})):t._e(),t._v(" "),"multiselect"===t.type?t._l(t.options,(function(e){return s("li",{key:e.value,staticClass:"p-2 border-b text-primary cursor-pointer",class:t.isSelected(e)?"active":"",on:{click:function(s){return t.toggle(e)}}},[t._v(t._s(e.label))])})):t._e()],2)])]),t._v(" "),"multiselect"===t.type?s("div",{staticClass:"flex justify-between"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.select()}}},[t._v(t._s(t.__("Select")))])],1)]):t._e()])}),[],!1,null,null,null).exports}}]);