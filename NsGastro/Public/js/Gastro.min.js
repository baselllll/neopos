(()=>{var e,t={757:(e,t,s)=>{e.exports=s(666)},790:(e,t,s)=>{"use strict";var r=s(757),n=s.n(r);function o(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=s(232).Z,a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,s;return t=e,(s=[{key:"run",value:function(e){var t=this;return new Promise((function(e,s){return function(e,t,s,r){return new(s||(s=Promise))((function(n,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))}(t,void 0,void 0,n().mark((function t(){var r,o,i,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("product"===(r=this.product).$original().gastro_item_type&&r.$original().modifiers_groups.length>0)){t.next=21;break}o=JSON.parse(r.$original().modifiers_groups),i=new Array,t.t0=n().keys(o);case 5:if((t.t1=t.t0()).done){t.next=20;break}return a=t.t1.value,t.prev=7,t.t2=i,t.next=11,this.loadModifier(o[a],r);case 11:t.t3=t.sent,t.t2.push.call(t.t2,t.t3),t.next=18;break;case 15:return t.prev=15,t.t4=t.catch(7),t.abrupt("return",s(t.t4));case 18:t.next=5;break;case 20:return t.abrupt("return",e({modifiersGroups:i}));case 21:return t.abrupt("return",e({}));case 22:case"end":return t.stop()}}),t,this,[[7,15]])})))}))}},{key:"loadModifier",value:function(e,t){return new Promise((function(s,r){Popup.show(i,{resolve:s,reject:r,product:t,modifierGroupId:e})}))}},{key:"computeProduct",value:function(e,t){var s=new Object;return["excl_tax_sale_price","excl_tax_wholesale_price","incl_tax_sale_price","incl_tax_wholesale_price","sale_price","sale_price_edit","sale_price_tax","wholesale_price","wholesale_price_edit","wholesale_price_tax"].forEach((function(r){s[r]=Object.values(e).map((function(e){return e.modifiers.map((function(e){return e.unit_quantities[0][r]*e.quantity}))})).flat().reduce((function(e,t){return e+t}))+t.$quantities()[r]})),function(){return Object.assign(Object.assign({},t.$quantities()),s)}}}])&&o(t.prototype,s),e}();function c(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,s;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){Popup.show(nsConfirmPopup,{title:"Send the order to the kitchen",message:"An order send to the kitchen can be seen and cooked by kitchen staff.",onAction:function(r){r?(e.order.gastro_order_status="pending",t(!0)):(e.order.gastro_order_status="hold",s(!1))}})}))}}])&&c(t.prototype,s),e}();function u(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(e,t,s,r){return new(s||(s=Promise))((function(n,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},p=s(337).Z,f=s(43).Z,v=s(129).Z,_=s(465).Z,m=(s(606).Z,s(736).Z),h=s(277).Z,b=s(631).Z,x=s(635).Z,y=(s(931).Z,function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addButtonsVisible=new RxJS.ReplaySubject,this.tableOpenedSubject=new RxJS.ReplaySubject,this.tableOpenedStatus=!1,this.selectedOrder=new RxJS.BehaviorSubject,nsHooks.addAction("ns-pos-header","gastro-add-table-button",(function(e){return t.addHeaderButton(e)})),nsHooks.addAction("ns-after-product-computed","gastro-update-product",(function(e){return t.computeProduct(e)})),nsHooks.addAction("ns-cart-after-refreshed","gastro-build-modifier",(function(e){return setTimeout((function(){return t.buildModifierVue(e)}),100)})),nsHooks.addAction("ns-before-load-order","gastro-catch-order",(function(e){return t.retrictOrderEdition()})),nsHooks.addFilter("ns-pending-orders-right-column","gastro-right-column",(function(e){return e.push({label:__m("Table Name","Gastro"),value:function(e){return e.table_name||__m("N/A","Gastro")}}),e})),this.tableOpenedSubject.subscribe((function(e){return t.tableOpenedStatus=e}))}var t,s;return t=e,s=[{key:"getType",value:function(){return{identifier:"dine-in",label:"Dine in ".concat((POS.order.getValue().table,"")),icon:GastroSettings.icons.chair,selected:!1}}},{key:"retrictOrderEdition",value:function(){if(!GastroSettings.permissions.gastroEditOrder&&!this.tableOpenedStatus)throw nsSnackBar.error(__("You're not allowed to edit orders.")).subscribe(),"Not allowed"}},{key:"printOrderCanceledMealKitchen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!GastroSettings.ns_gastro_allow_cancelation_print)return!1;var s=nsHooks.applyFilters("ns-gastro-print-order-canceled-meal",{status:"failed",message:__m("No Print Handler for canceled meals","NsGastro"),data:{order_id:e,products_id:t}});"failed"===s.status&&nsSnackBar.error(s.message).subscribe()}},{key:"setAddButtonsVisibility",value:function(e){"visible"===e?this.addButtonsVisible.next(!0):this.addButtonsVisible.next(!1)}},{key:"boot",value:function(){var e=this;this.bindPromise(),this.registerCustomOrderType(),this.injectSendToKitchenPopup(),POS.visibleSection.subscribe((function(t){e.currentScreen=t,["both","cart"].includes(t)&&setTimeout((function(){e.injectAddToOrderButtons(),e.toggleAddButtonsVisibility()}),20)})),this.subscribeToAddButtonVisibility()}},{key:"replaceHoldButton",value:function(){if(null===document.querySelector("#to-kitchen-button")){var e=document.createElement("gastro-to-kitchen-button"),t=document.querySelector("#hold-button");t.classList.add("hidden"),t.parentNode.insertBefore(e,t.nextElementSibling),(new(Vue.extend(x))).$mount("gastro-to-kitchen-button")}}},{key:"subscribeToAddButtonVisibility",value:function(){var e=this;this.addButtonsVisible.subscribe((function(t){e.addButtonsVisibility=t,["both","cart"].includes(e.currentScreen)&&e.toggleAddButtonsVisibility()}))}},{key:"toggleAddButtonsVisibility",value:function(){["both","cart"].includes(this.currentScreen)&&(this.addButtonsVisibility?(null!==document.querySelector("#cart-bottom-buttons")&&document.querySelector("#cart-bottom-buttons").classList.remove("flex"),null!==document.querySelector("#cart-bottom-buttons")&&document.querySelector("#cart-bottom-buttons").classList.add("hidden"),null!==document.querySelector("#gastro-add-buttons")&&document.querySelector("#gastro-add-buttons").classList.remove("hidden"),null!==document.querySelector("#gastro-add-buttons")&&document.querySelector("#gastro-add-buttons").classList.add("flex")):(null!==document.querySelector("#cart-bottom-buttons")&&document.querySelector("#cart-bottom-buttons").classList.remove("hidden"),null!==document.querySelector("#cart-bottom-buttons")&&document.querySelector("#cart-bottom-buttons").classList.add("flex"),null!==document.querySelector("#gastro-add-buttons")&&document.querySelector("#gastro-add-buttons").classList.remove("flex"),null!==document.querySelector("#gastro-add-buttons")&&document.querySelector("#gastro-add-buttons").classList.add("hidden")),this.replaceHoldButton())}},{key:"injectAddToOrderButtons",value:function(){var e,t,s;if(null!==document.querySelector("#gastro-add-buttons"))return!1;if(document.querySelector(".cart-table")){document.querySelector(".cart-table").insertAdjacentHTML("beforeend","<gastro-add-buttons></gastro-add-buttons>");var r=new(Vue.extend(m));r.template=(null===(e=null==m?void 0:m.options)||void 0===e?void 0:e.template)||void 0,r.render=m.render||void 0,r.methods=(null===(t=null==m?void 0:m.options)||void 0===t?void 0:t.methods)||(null==m?void 0:m.methods),r.data=(null===(s=null==m?void 0:m.options)||void 0===s?void 0:s.data)||(null==m?void 0:m.data),r.$mount("gastro-add-buttons")}}},{key:"bindPromise",value:function(){POS.addToCartQueue.ModifierPromise=a}},{key:"addHeaderButton",value:function(e){return e.buttons.GastroTableButton=v,e.buttons.GastroOrdersButton=_,e.buttons.GastroSplitOrderButton=h,e.buttons.GastroMergeOrderButton=b,e}},{key:"registerCustomOrderType",value:function(){var e=this;POS.types.getValue(),POS.orderTypeQueue.push({identifier:"gastro.table",promise:function(t){return d(e,void 0,void 0,n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,s){"dine-in"===t.identifier&&GastroSettings.ns_gastro_tables_enabled?Popup.show(f,{resolve:e,reject:s}):e(!0)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}})}},{key:"computeProduct",value:function(e){if(void 0!==e.modifiersGroups&&e.modifiersGroups.length>0){var t=0;e.modifiersGroups.length>0&&e.modifiersGroups.forEach((function(e){e.modifiers.forEach((function(e){t+=e.total_price}))})),e.modifiers_total=t*e.quantity,e.modifiers_net_total=t*e.quantity,e.modifiers_gross_total=t*e.quantity,e.total_price=(e.unit_price+t)*e.quantity,e.total_price_with_tax=(e.unit_price+t)*e.quantity,e.total_price_without_tax=(e.unit_price+t)*e.quantity}}},{key:"buildModifierVue",value:function(e){var t=this;e.products.forEach((function(e,s){var r=document.querySelector('[product-index="'.concat(s,'"]'));if(null===r)return!1;null!==r.querySelector(".modifier-container")&&r.querySelector(".modifier-container").remove(),t.injectModifiersGroups(e,s),t.injectCutleryOptions(e,s)}))}},{key:"injectSendToKitchenPopup",value:function(){nsHooks.addFilter("ns-hold-queue","gastro-inject-send-to-kitchen",(function(e){return e.push(l),e}))}},{key:"injectModifiersGroups",value:function(e,t){if(e.modifiersGroups&&e.modifiersGroups.length>0){var s=document.querySelector('[product-index="'.concat(t,'"]')),r=document.createElement("div");r.className="modifier-container mt-2 text-sm cursor-pointer",r.setAttribute("product-reference",t),s.querySelector("div").appendChild(r),e.modifiersGroups.forEach((function(e){e.modifiers.forEach((function(t){var r=document.createElement("template"),n='\n                    <div class="single-modifier p-1 flex justify-between">\n                        <span>'.concat(e.name," : ").concat(t.name," (x").concat(t.quantity,')</span>\n                        <div class="flex">\n                            <span>').concat(Vue.filter("currency")(t.total_price),"</span>\n                            <ns-close-button></ns-close-button>\n                        </div>\n                    </div>\n                    ");r.innerHTML=n.trim(),s.querySelector(".modifier-container").appendChild(r.content.firstChild)}))})),r.addEventListener("click",(function(){return d(this,void 0,void 0,n().mark((function e(){var t,s,r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getAttribute("product-reference"),s=POS.order.getValue().products[t],e.prev=2,r=new a(s),e.next=6,r.run(s);case 6:o=e.sent,i=Object.assign(Object.assign({},s),o),POS.updateProduct(s,i,t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])})))}))}}},{key:"injectCutleryOptions",value:function(e,t){var s=document.querySelector('[product-index="'.concat(t,'"]'));if(e=POS.products.getValue()[t],0===s.querySelectorAll(".cutlery-options").length){var r=document.createElement("template");r.innerHTML='\n                <div class="px-1 cutlery-options">\n                    <a class="hover:text-blue-600 cursor-pointer outline-none border-dashed py-1 border-b  text-sm border-blue-400">\n                        <i class="las la-utensils text-xl"></i>\n                    </a>\n                </div>\n            '.trim(),s.querySelector(".product-options").appendChild(r.content.firstChild),s.querySelector(".cutlery-options a").addEventListener("click",(function(){e=POS.products.getValue()[t],new Promise((function(t,s){Popup.show(p,{resolve:t,reject:s,product:e})})).then((function(e){console.log(e)})).catch((function(e){return console.log(e)}))}))}}}],s&&u(t.prototype,s),e}());window.Gastro=new y,document.addEventListener("DOMContentLoaded",(function(){window.Gastro.boot()}))},910:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s(645),n=s.n(r)()((function(e){return e[1]}));n.push([e.id,".light .modifier-item[data-v-2f3194d0]{background:hsla(0,0%,100%,.73)}.dark .modifier-item[data-v-2f3194d0]{background:rgba(0,0,0,.73)}",""]);const o=n},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=e(t);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(n[i]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&n[c[0]]||(s&&(c[2]?c[2]="".concat(s," and ").concat(c[2]):c[2]=s),t.push(c))}},t}},38:()=>{},666:e=>{var t=function(e){"use strict";var t,s=Object.prototype,r=s.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,s){return Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,s){return e[t]=s}}function l(e,t,s,r){var n=t&&t.prototype instanceof m?t:m,o=Object.create(n.prototype),i=new P(r||[]);return o._invoke=function(e,t,s){var r=d;return function(n,o){if(r===f)throw new Error("Generator is already running");if(r===v){if("throw"===n)throw o;return T()}for(s.method=n,s.arg=o;;){var i=s.delegate;if(i){var a=O(i,s);if(a){if(a===_)continue;return a}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(r===d)throw r=v,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);r=f;var c=u(e,t,s);if("normal"===c.type){if(r=s.done?v:p,c.arg===_)continue;return{value:c.arg,done:s.done}}"throw"===c.type&&(r=v,s.method="throw",s.arg=c.arg)}}}(e,s,i),o}function u(e,t,s){try{return{type:"normal",arg:e.call(t,s)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",f="executing",v="completed",_={};function m(){}function h(){}function b(){}var x={};c(x,o,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(S([])));g&&g!==s&&r.call(g,o)&&(x=g);var w=b.prototype=m.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function s(n,o,i,a){var c=u(e[n],e,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){s("next",e,i,a)}),(function(e){s("throw",e,i,a)})):t.resolve(d).then((function(e){l.value=e,i(l)}),(function(e){return s("throw",e,i,a)}))}a(c.arg)}var n;this._invoke=function(e,r){function o(){return new t((function(t,n){s(e,r,t,n)}))}return n=n?n.then(o,o):o()}}function O(e,s){var r=e.iterator[s.method];if(r===t){if(s.delegate=null,"throw"===s.method){if(e.iterator.return&&(s.method="return",s.arg=t,O(e,s),"throw"===s.method))return _;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var n=u(r,e.iterator,s.arg);if("throw"===n.type)return s.method="throw",s.arg=n.arg,s.delegate=null,_;var o=n.arg;return o?o.done?(s[e.resultName]=o.value,s.next=e.nextLoc,"return"!==s.method&&(s.method="next",s.arg=t),s.delegate=null,_):o:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,_)}function G(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(G,this),this.reset(!0)}function S(e){if(e){var s=e[o];if(s)return s.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function s(){for(;++n<e.length;)if(r.call(e,n))return s.value=e[n],s.done=!1,s;return s.value=t,s.done=!0,s};return i.next=i}}return{next:T}}function T(){return{value:t,done:!0}}return h.prototype=b,c(w,"constructor",b),c(b,"constructor",h),h.displayName=c(b,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},C(k.prototype),c(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,s,r,n,o){void 0===o&&(o=Promise);var i=new k(l(t,s,r,n),o);return e.isGeneratorFunction(s)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(w),c(w,a,"Generator"),c(w,o,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var s in e)t.push(s);return t.reverse(),function s(){for(;t.length;){var r=t.pop();if(r in e)return s.value=r,s.done=!1,s}return s.done=!0,s}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var s in this)"t"===s.charAt(0)&&r.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var s=this;function n(r,n){return a.type="throw",a.arg=e,s.next=r,n&&(s.method="next",s.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),N(s),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===e){var r=s.completion;if("throw"===r.type){var n=r.arg;N(s)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,s,r){return this.delegate={iterator:S(e),resultName:s,nextLoc:r},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},379:(e,t,s)=>{"use strict";var r,n=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),o=[];function i(e){for(var t=-1,s=0;s<o.length;s++)if(o[s].identifier===e){t=s;break}return t}function a(e,t){for(var s={},r=[],n=0;n<e.length;n++){var a=e[n],c=t.base?a[0]+t.base:a[0],l=s[c]||0,u="".concat(c," ").concat(l);s[c]=l+1;var d=i(u),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(o[d].references++,o[d].updater(p)):o.push({identifier:u,updater:_(p,t),references:1}),r.push(u)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=s.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var i=n(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function d(e,t,s,r){var n=s?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,n);else{var o=document.createTextNode(n),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}function p(e,t,s){var r=s.css,n=s.media,o=s.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,v=0;function _(e,t){var s,r,n;if(t.singleton){var o=v++;s=f||(f=c(t)),r=d.bind(null,s,o,!1),n=d.bind(null,s,o,!0)}else s=c(t),r=p.bind(null,s,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var s=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<s.length;r++){var n=i(s[r]);o[n].references--}for(var c=a(e,t),l=0;l<s.length;l++){var u=i(s[l]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}s=c}}}},736:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});const r={name:"",data:function(){return{selectedOrder:null,subscription:null}},mounted:function(){var e=this;this.subscription=Gastro.selectedOrder.subscribe((function(t){e.selectedOrder=t}))},methods:{__m:__m,cancelAddToOrder:function(){Gastro.selectedOrder.next({}),Gastro.setAddButtonsVisibility("hidden"),POS.reset()},submitAddToOrder:function(){var e=this,t=POS.products.getValue();if(0===t.length)return nsSnackBar.error(__m("Unable to submit if the cart is empty.","NsGastro"),null,{duration:4e3}).subscribe();Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("Would you like to add {products} items to the order {order}","NsGastro").replace("{products}",t.length).replace("{order}",this.selectedOrder.code),onAction:function(s){s&&nsHttpClient.post("/api/nexopos/v4/gastro/orders/".concat(e.selectedOrder.id,"/add-products"),{products:t}).subscribe((function(t){nsSnackBar.success(t.message,"OK",{duration:3e3}).subscribe(),"local_print"===GastroSettings.ns_gastro_kitchen_print_gateway&&Gastro.printOrderToKichen(e.selectedOrder.id,t.data.orderProducts.map((function(e){return e.id}))),nsHooks.doAction("ns-gastro-after-add-products",{order:e.selectedOrder,products:t.data.orderProducts}),e.cancelAddToOrder()}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured","NsGastro"),"OK",{duration:0}).subscribe()}))}})}}},n=(0,s(810).Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-16 flex flex-shrink-0 border-t border-gray-200",attrs:{id:"gastro-add-buttons"}},[s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto",attrs:{id:"kitchen-button"},on:{click:function(t){return e.submitAddToOrder()}}},[s("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-paper-plane"}),e._v(" "),s("span",{staticClass:"text-lg lg:text-2xl"},[e._v(e._s(e.__m("To Kitchen")))])]),e._v(" "),s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-r hover:bg-red-600 border-red-600 flex-auto",attrs:{id:"hold-button"},on:{click:function(t){return e.cancelAddToOrder()}}},[s("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-times"}),e._v(" "),s("span",{staticClass:"text-lg lg:text-2xl"},[e._v(e._s(e.__m("Cancel","NsGastro")))])])])}),[],!1,null,null,null).exports},631:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var r=s(757),n=s.n(r);const o={name:"gastro-pos-merge",watch:{search:function(){var e=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.searchOrderWithQuery(e.search)}),500)}},mounted:function(){var e=this;this.popupCloser(),this.$refs.searchField.focus(),this.$refs.searchField.addEventListener("blur",(function(){setTimeout((function(){e.searchResults=[]}),300)})),RxJS.forkJoin([this.loadCustomers(),this.loadOrderType(),this.loadTables()]).subscribe((function(t){e.customers=t[0].map((function(e){return{label:e.name,value:e.id}})),e.orderTypes=Object.values(t[1].types).map((function(e){return{label:e.label,value:e.identifier}})),e.tables=t[2].map((function(e){return{label:e.name,value:e.id}})),e.buildFields()}))},data:function(){return{search:"",searchResults:[],validation:new FormValidation,orderFields:[],queuedOrders:[],customers:[],totalOrders:0,totalProducts:0,tables:[],orderTypes:[],typeLabels:{},mergeResult:{}}},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,detectOrderType:function(e){if("type"===e.name)if("dine-in"===e.value)this.orderFields.push({label:__m("Table","NsGastro"),name:"table_id",type:"select",options:this.tables,description:__m("Assign the order to a table.","NsGastro"),validation:"required"});else{var t=this.orderFields.filter((function(e){return"table_id"==e.name}));if(t.length>0){var s=this.orderFields.indexOf(t[0]);this.orderFields.splice(s,1)}}},submitOrderMerging:function(){var e=this;return this.queuedOrders.length<2?nsSnackBar.error(__m("There should be at least 2 queued orders for merging.","NsGastro")).subscribe():this.queuedOrders.length>5?nsSnackBar.error(__m("At most 5 orders can be merged.","NsGastro")).subscribe():this.validation.validateFields(this.orderFields)?void Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("The provided order will be merged. Note that this operation can't be undone","NsGastro"),onAction:function(t){t&&e.proceedOrderMerging()}}):nsSnackBar.error(__m("Unable to proceed the form is not valid.","NsGastro")).subscribe()},proceedOrderMerging:function(){var e=this;nsHttpClient.post("/api/nexopos/v4/gastro/orders/merge",{orders:this.queuedOrders,fields:this.validation.extractFields(this.orderFields)}).subscribe((function(t){e.mergeResult=t.data,nsSnackBar.success(__m("The orders has been marged into {order} successfully.","NsGastro").replace("{order}",t.data.order.code),__m("Ok","NsGastro"),{duraton:1e4}).subscribe(),e.popupResolver(!0)}),(function(e){nsSnackBar.error(__m("An unexpected error has occured.","NsGastro")).subscribe()}))},removeOrderFromQueue:function(e){var t=this.queuedOrders.indexOf(e);this.queuedOrders.splice(t,1),this.computeOrders()},buildFields:function(){this.orderFields=this.validation.createFields([{label:__m("Customer","NsGastro"),name:"customer_id",type:"select",options:this.customers,description:__m("Assign a customer to the order.","NsGastro")},{label:__m("Name","NsGastro"),name:"name",type:"text",description:__m("Define the order name. Might be useful to retreive the order.","NsGastro")},{label:__m("Order Type","NsGastro"),name:"type",type:"select",options:this.orderTypes,description:__m("Set what is the order type.","NsGastro")}])},computeOrders:function(){this.queuedOrders.length>0?(this.totalOrders=this.queuedOrders.map((function(e){return e.total})).reduce((function(e,t){return e+t})),this.totalProducts=this.queuedOrders.map((function(e){return e.products.map((function(e){return e.quantity})).flat()})).flat().reduce((function(e,t){return e+t}))):(this.totalOrders=0,this.totalProducts=0)},getOrderType:function(e){return this.typeLabels[e]||__m("Unknown","NsGastro")},loadCustomers:function(){return nsHttpClient.get("/api/nexopos/v4/customers")},loadOrderType:function(){return nsHttpClient.get("/api/nexopos/v4/gastro/order-types")},loadTables:function(){return nsHttpClient.get("/api/nexopos/v4/gastro/tables")},addToTheQueue:function(e){var t=this,s=this.queuedOrders.map((function(e){return e.id}));if(this.search="",s.includes(e.id))return nsSnackBar.error(__m("The order has already been added to the queue.","NsGastro")).subscribe();e.products=[],this.queuedOrders.push(e),nsHttpClient.get("/api/nexopos/v4/gastro/orders/".concat(e.id,"/products")).subscribe((function(s){e.products=s,t.computeOrders()}))},searchOrderWithQuery:function(e){var t=this;e.length>0&&nsHttpClient.get("/api/nexopos/v4/gastro/orders/search?search=".concat(e)).subscribe((function(e){0===e.length&&(t.$refs.searchField.focus(),t.$refs.searchField.select(),nsSnackBar.info(__m("No results match your query, please try again.","NsGastro","OK",{duration:4e3})).subscribe()),t.searchResults=e}),(function(e){return nsSnacBar.error(__m("An error has occured while searching orders","NsGastro"),"OK",{duration:4e3}).subscribe()}))}}};var i=s(810);const a=(0,i.Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadowl-lg w-95vw h-95vh lg:w-2/3-screen flex flex-col text-gray-700 overflow-hidden"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[s("span",{staticClass:"font-semibold"},[e._v(e._s(e.__m("Merge Orders","NsGastro")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver(!1)}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 ns-box-body flex flex-col flex-auto overflow-hidden"},[s("div",{staticClass:"rounded overflow-hidden border-2 flex flex-shrink-0 input-group info w-full"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],ref:"searchField",staticClass:"flex-auto p-2 outline-none",attrs:{placeholder:e.__m("Order Code","NsGastro"),type:"text"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-3 py-2",on:{click:function(t){return e.searchOrderWithQuery(e.search)}}},[e._v(e._s(e.__m("Search","NsGastro")))])]),e._v(" "),s("div",{staticClass:"h-0 relative"},[s("div",{staticClass:"shadow elevation-surface w-full absolute z-10"},[s("ul",e._l(e.searchResults,(function(t){return s("li",{key:t.id,staticClass:"cursor-pointer p-2 border-b border-box-edge flex flex-col justify-between",on:{click:function(s){return e.addToTheQueue(t)}}},[s("div",{staticClass:"flex justify-between"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(t.code))]),e._v(" "),s("span",{staticClass:"text-primary"},[e._v(e._s(e._f("currency")(t.total)))])]),e._v(" "),s("div",{staticClass:"flex justify-between"},[s("div",[s("span",{staticClass:"text-sm text-secondary"},[e._v(e._s(e.__m("Customer: ","NsGastro"))+" "+e._s(t.customer.name))])]),e._v(" "),s("div",[s("span",{staticClass:"text-sm text-secondary"},[e._v(e._s(e.__m("Order Type: ","NsGastro"))+" "+e._s(e.getOrderType(t.type)))])])])])})),0)])]),e._v(" "),s("div",{staticClass:"py-2 md:py-4"},[s("div",{staticClass:"-mx-2 md:-mx-4 flex flex-wrap"},[s("div",{staticClass:"px-2 md:px-4 w-1/2"},[s("div",{staticClass:"shadow elevation-surface border rounded p-2"},[s("h4",{staticClass:"font-semibold"},[e._v(e._s(e.__m("Total","NsGastro")))]),e._v(" "),s("h2",{staticClass:"font-bold text-2xl md:text-4xl"},[e._v(e._s(e._f("currency")(e.totalOrders)))])])]),e._v(" "),s("div",{staticClass:"px-2 md:px-4 w-1/2"},[s("div",{staticClass:"shadow elevation-surface border rounded p-2"},[s("h4",{staticClass:"font-semibold"},[e._v(e._s(e.__m("Products","NsGastro")))]),e._v(" "),s("h2",{staticClass:"font-bold text-2xl md:text-4xl"},[e._v(e._s(e.totalProducts))])])])])]),e._v(" "),s("div",{staticClass:"overflow-y-auto flex-auto"},[s("div",{staticClass:"p-2"},[s("div",{staticClass:"flex -mx-2 md:flex-nowrap flex-wrap"},[s("div",{staticClass:"w-full md:w-1/2 lg:w-2/6 px-2"},[s("h3",{staticClass:"border-b font-semibold text-sm border-info-tertiary py-2"},[e._v(e._s(e.__m("Queued Orders","NsGastro")))]),e._v(" "),s("ul",{staticClass:"py-2"},[e._l(e.queuedOrders,(function(t){return s("li",{key:t.id,staticClass:"shadow elevation-surface border rounded p-2 flex items-center justify-between"},[s("div",{staticClass:"flex flex-auto justify-between"},[s("span",[e._v(e._s(t.code))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total)))])]),e._v(" "),s("div",{staticClass:"ml-2"},[s("ns-close-button",{on:{click:function(s){return e.removeOrderFromQueue(t)}}})],1)])})),e._v(" "),0===e.queuedOrders.length?s("li",{staticClass:"p-2 shadow elevation-surface border text-center"},[e._v(e._s(e.__m("No order has been queued.","NsGastro")))]):e._e()],2)]),e._v(" "),s("div",{staticClass:"w-full md:w-1/2 lg:w-4/6 px-2"},[s("h3",{staticClass:"border-b font-semibold text-sm border-info-tertiary py-2"},[e._v(e._s(e.__m("Order Settings","NsGastro")))]),e._v(" "),s("div",{staticClass:"elevation-surface my-4 p-2"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},e._l(e.orderFields,(function(t,r){return s("div",{key:r,staticClass:"p-2 w-full md:w-1/2"},[s("ns-field",{attrs:{field:t},on:{change:function(t){return e.detectOrderType(t)}}})],1)})),0)])])])])])]),e._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t border-box-edge"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.submitOrderMerging()}}},[e._v(e._s(e.__m("Submit","NsGastro")))])],1)])])}),[],!1,null,null,null).exports;function c(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const l={methods:{__m:__m,openMergeOrderPopup:function(){return(e=n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Popup.show(a,{resolve:e,reject:t})}));case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){c(o,r,n,i,a,"next",e)}function a(e){c(o,r,n,i,a,"throw",e)}i(void 0)}))})();var e}}},u=(0,i.Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button hover-warning"},[s("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm",on:{click:function(t){return e.openMergeOrderPopup()}}},[s("i",{staticClass:"text-xl las la-compress-arrows-alt mr-2"}),e._v(" "),s("span",[e._v(e._s(e.__m("Merge Orders","NsGastro")))])])])}),[],!1,null,null,null).exports},232:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var r=s(757),n=s.n(r);const o={name:"gastro-keyboard",data:function(){return{keyboardComponent:function(){return nsComponents.nsNumpad}}},methods:{__m:__m,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},updateModifierQuantity:function(e){this.modifier.quantity=e,this.$forceUpdate()},saveQuantity:function(e){parseFloat(e)>0?(this.modifier.quantity=parseFloat(this.modifier.quantity),this.$popup.close(),this.$popupParams.resolve(this.modifier)):nsSnackBar.error(__m("Invalid quantity provided.","NsGastro")).subscribe()}},computed:{modifier:function(){return this.$popupParams.modifier}},mounted:function(){}};var i=s(810);const a=(0,i.Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/5-screen"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between"},[s("h3",[e._v(e._s(e.__m("Define Quantity","NsGastro")))]),e._v(" "),s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1),e._v(" "),s("div",{staticClass:"p-2 border-b ns-box-body"},[s("div",{staticClass:"text-3xl flex justify-end p-2"},[e._v(e._s(e.modifier.quantity))])]),e._v(" "),s("div",{staticClass:"p-2"},[s(e.keyboardComponent(),{tag:"component",attrs:{value:e.modifier.quantity},on:{next:function(t){return e.saveQuantity(t)},changed:function(t){return e.updateModifierQuantity(t)}}})],1)])}),[],!1,null,null,null).exports;function c(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const l={name:"gastro-modifier-group",mounted:function(){this.loadModifierGroup()},data:function(){return{modifierGroup:null}},methods:{__m:__m,select:function(e){var t=this;if(!this.modifierGroup.multiselect){var s=this.modifierGroup.modifiers.indexOf(e);this.modifierGroup.modifiers.forEach((function(e,t){t!==s&&(e.selected=!1,e.quantity=0)}))}e.selected=!e.selected,this.modifierGroup.countable?e.selected?new Promise(function(){var s,r=(s=n().mark((function s(r,o){return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,Popup.show(a,{resolve:r,reject:o,modifier:e,product:t.$popupParams.product});case 3:e=s.sent,s.next=10;break;case 6:s.prev=6,s.t0=s.catch(0),console.log(s.t0),e.selected=!1;case 10:case"end":return s.stop()}}),s,null,[[0,6]])})),function(){var e=this,t=arguments;return new Promise((function(r,n){var o=s.apply(e,t);function i(e){c(o,r,n,i,a,"next",e)}function a(e){c(o,r,n,i,a,"throw",e)}i(void 0)}))});return function(e,t){return r.apply(this,arguments)}}()):e.quantity=0:e.selected?e.quantity=1:e.quantity=0},loadModifierGroup:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/gastro/modifiers-groups/".concat(this.$popupParams.modifierGroupId)).subscribe((function(t){t.modifiers=t.modifiers.map((function(t){t.modifier_id=t.id,delete t.id;var s=[];if(e.$popupParams.product.modifiersGroups){var r=e.$popupParams.product.modifiersGroups.filter((function(t){return t.modifier_group_id===e.$popupParams.modifierGroupId}));r.length>0&&(s=r[0].modifiers.filter((function(e){return e.modifier_id===t.modifier_id})))}return t.selected=0!==s.length&&s[0].selected,t.quantity=0===s.length?0:s[0].quantity,t})),e.modifierGroup=t}),(function(e){nsSnackBar.error(e.message||"An unexpected error has occured.").subscribe()}))},nextStep:function(){var e=this.modifierGroup;return 0===this.modifierGroup.modifiers.filter((function(e){return e.selected})).length&&1===parseInt(e.forced)?nsSnackBar.error("You must select a modifier before proceeding.").subscribe():this.modifierGroup.modifiers.filter((function(e){return e.selected})).length>0&&1===parseInt(e.countable)&&1===parseInt(e.forced)&&this.modifierGroup.modifiers.map((function(e){return e.quantity})).reduce((function(e,t){return e+t}))<=0?nsSnackBar.error("The current modifier group is require modifier with valid quantities.").subscribe():(e.modifier_group_id=e.id,e.modifiers=e.modifiers.filter((function(e){return e.selected})),e.modifiers.forEach((function(e){e.unit_price=e.unit_quantities[0].sale_price,e.unit_quantity_id=e.unit_quantities[0].id,e.unit_id=e.unit_quantities[0].unit_id,e.total_price=e.unit_quantities[0].sale_price*e.quantity})),delete e.id,this.$popupParams.resolve(e),void this.$popup.close())},close:function(){this.$popupParams.reject(!1),this.$popup.close()}}};var u=s(379),d=s.n(u),p=s(910);d()(p.Z,{insert:"head",singleton:!1}),p.Z.locals;const f=(0,i.Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box h-95vh md:h-4/5-screen w-95vw md:w-3/5-screen flex flex-col"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",[e._v(e._s(e.__m("Modifier","NsGastro")))]),e._v(" "),s("ns-close-button",{on:{click:function(t){return e.close()}}})],1),e._v(" "),null===e.modifierGroup?s("div",{staticClass:"h-84 flex items-center justify-center"},[s("ns-spinner")],1):e._e(),e._v(" "),null!==e.modifierGroup?s("div",{staticClass:"overflow-hidden flex-auto flex flex-col"},[s("div",{staticClass:"m-2 p-2 ns-notice success text-center"},[s("p",[e._v(e._s(e.modifierGroup.description||"No description provided."))])]),e._v(" "),s("div",{staticClass:"grid grid-cols-2 md:grid-cols-3 overflow-hidden cursor-pointer overflow-y-auto"},e._l(e.modifierGroup.modifiers,(function(t){return s("div",{key:t.id,staticClass:"border h-44 md:h-56 ns-numpad-key",class:t.selected?"info":"",on:{click:function(s){return e.select(t)}}},[s("div",{staticClass:"relative h-full w-full flex items-center justify-center overflow-hidden"},[t.quantity>0?s("div",{staticClass:"flex items-center justify-center text-white absolute right-4 top-4 rounded-full h-8 w-8 bg-info-secondary font-bold"},[e._v(e._s(t.quantity))]):e._e(),e._v(" "),t.galleries[0]?s("img",{staticClass:"object-cover h-full",attrs:{src:t.galleries[0].url,alt:t.name}}):e._e(),e._v(" "),t.galleries[0]?e._e():s("i",{staticClass:"las la-image text-secondary text-6xl"})]),e._v(" "),s("div",{staticClass:"h-0 w-full"},[s("div",{staticClass:"relative w-full flex items-center justify-center -top-10 h-20 py-2 flex-col modifier-item"},[s("h3",{staticClass:"font-bold text-primary py-2 text-center"},[e._v(e._s(t.name))]),e._v(" "),s("span",{staticClass:"text-xs font-bold text-secondary py-1 text-center"},[e._v(e._s(e._f("currency")(t.unit_quantities[0].sale_price)))])])])])})),0),e._v(" "),s("div",{staticClass:"border-t ns-box-footer border-gray p-2 flex justify-between items-center"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.nextStep()}}},[e._v(e._s(e.__m("Continue","NsGastro")))])],1)])]):e._e()])}),[],!1,null,"2f3194d0",null).exports},337:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(757),n=s.n(r);function o(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const i={name:"gastro-pos-meal",mounted:function(){var e=this;this.product=this.$popupParams.product,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.closePopup()}))},data:function(){return{product:null}},methods:{__m:__m,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},printKitchen:function(){var e=this.$popupParams.product;["pending","ongoing"].includes(e.cooking_status)&&e.id,nsSnackBar.error("Unable to print a meal that is not yet send at the kitchen or which is already cooked.").subscribe()},cancelMeal:function(){var e=this.$popupParams.product;["pending","ongoing"].includes(e.cooking_status)&&e.id,nsSnackBar.error("Unable to cancel a meal that is not send to the kitchen or which is already cookied.").subscribe()},addProductNote:function(){var e,t=this;return(e=n().mark((function e(){var s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,s){Popup.show(nsPromptPopup,{resolve:e,reject:s,input:t.$popupParams.product.cooking_note,title:"Meal Note",message:"The following note will be visible at the kitchen and on the kitchen slip.",onAction:function(t){e(t)}})}));case 3:!1!==(s=e.sent)&&(t.$popupParams.product.cooking_note=s),t.closePopup(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function a(e){o(i,r,n,a,c,"next",e)}function c(e){o(i,r,n,a,c,"throw",e)}a(void 0)}))})()}}},a=(0,s(810).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen bg-white"},[s("div",{staticClass:"p-2 flex justify-between border-b items-center"},[s("h3",{staticClass:"w-full"},[s("span",[e._v(e._s(e.__m("Meal Status: ","NsGastro")))]),e._v(" "),e.product?s("span",[e._v(e._s(e.product.name))]):e._e()]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",[s("div",{staticClass:"go-grid go-grid-cols-2 go-text-gray-700"},[s("div",{staticClass:"cursor-pointer hover:go-bg-blue-400 hover:go-text-white go-border go-border-gray-100 go-h-36 flex items-center flex-col justify-center",on:{click:function(t){return e.printKitchen()}}},[s("i",{staticClass:"go-text-6xl las la-print"}),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(e._s(e.__m("Print","NsGastro")))])]),e._v(" "),s("div",{staticClass:"cursor-pointer hover:go-bg-blue-400 hover:go-text-white go-border go-border-gray-100 go-h-36 flex items-center flex-col justify-center",on:{click:function(t){return e.cancelMeal()}}},[s("i",{staticClass:"go-text-6xl las la-ban"}),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(e._s(e.__m("Cancel","NsGastro")))])]),e._v(" "),s("div",{staticClass:"cursor-pointer hover:go-bg-blue-400 hover:go-text-white go-border go-border-gray-100 go-h-36 flex items-center flex-col justify-center",on:{click:function(t){return e.addProductNote()}}},[s("i",{staticClass:"go-text-6xl las la-comment-alt"}),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(e._s(e.__m("Note","NsGastro")))])])])])])}),[],!1,null,null,null).exports},931:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var r=s(757),n=s.n(r);const o={name:"gastro-pos-order-move",data:function(){return{order:null,tableName:"",watchTimeout:null,tables:[]}},watch:{tableName:function(){var e=this;clearTimeout(this.watchTimeout),this.watchTimeout=setTimeout((function(){e.searchTables(e.tableName)}),1e3)}},methods:{popupResolver:popupResolver,popupCloser:popupCloser,__m:__m,closePopup:function(){this.popupResolver(!1)},moveTo:function(e){var t=this;Popup.show(nsConfirmPopup,{title:__m('Move The Order To "{table}" ?',"NsGastro").replace("{table}",e.name),message:__m("The order will be moved to a new table. Would you like to confirm ? ","NsGastro"),onAction:function(s){s&&t.proceedMove(t.order,e)}})},proceedMove:function(e,t){var s=this;nsHttpClient.post("/api/nexopos/v4/gastro/orders/".concat(e.id,"/change-table"),{table_id:t.id}).subscribe((function(e){nsSnackBar.success(e.message,"OK",{duration:3e3}).subscribe(),s.popupResolver(!0)}),(function(e){var t=e.message||__m("An unexpected error occured while moving the order.","NsGastro");nsSnackBar.error(t,"OK",{duration:3e3}).subscribe()}))},searchTables:function(e){var t=this;nsHttpClient.post("/api/nexopos/v4/gastro/tables/search",{search:e}).subscribe((function(e){t.tables=e}))}},mounted:function(){this.popupCloser(),this.order=this.$popupParams.order}};var i=s(810);const a=(0,i.Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.order?s("div",{staticClass:"shadow-full ns-box w-95vw h-95vh md:w-3/4-screen lg:w-3/6-screen md:h-half overflow-hidden flex flex-col"},[s("div",{staticClass:"border-b ns-box-header p-2 flex flex-col md:flex-row justify-between items-center"},[s("div",{staticClass:"flex-auto"},[s("h3",{staticClass:"font-semibold mb-1 md:mb-0"},[e._v(e._s(e.__m("Move Order","NsGastro")))])]),e._v(" "),s("div",{staticClass:"flex items-center justify-between w-full md:w-auto"},[s("div",{staticClass:"px-1"},[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)])]),e._v(" "),s("div",{staticClass:"p-2 ns-box-body flex-auto flex flex-col overflow-hidden"},[s("p",{staticClass:"text-center mb-4 text-primary"},[e._v(e._s(e.__m("You're about to move the order {order}. Please select the table where you would like to move the order.","NsGastro").replace("{order}",this.order.code)))]),e._v(" "),s("div",{staticClass:"shadow rounded elevation-surface flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 flex-col flex border-b"},[s("div",{staticClass:"input-group border-2 overflow-hidden"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tableName,expression:"tableName"}],staticClass:"w-full p-2",attrs:{type:"text",placeholder:e.__m("Search a table","NsGastro")},domProps:{value:e.tableName},on:{input:function(t){t.target.composing||(e.tableName=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"overflow-y-auto"},[s("ul",e._l(e.tables,(function(t){return s("li",{key:t.id,staticClass:"hover:bg-blue-100 cursor-pointer text-primary p-2 border-b flex justify-between",on:{click:function(s){return e.moveTo(t)}}},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("div",[t.busy?e._e():s("span",{staticClass:"rounded-full px-2 text-xs py-1 bg-green-400"},[e._v(e._s(e.__m("Available","NsGastro")))]),e._v(" "),t.busy?s("span",{staticClass:"rounded-full px-2 text-xs py-1 bg-yellow-400"},[e._v(e._s(e.__m("Busy","NsGastro")))]):e._e()])])})),0)])])])]):e._e()}),[],!1,null,null,null).exports;function c(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function l(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){c(o,r,n,i,a,"next",e)}function a(e){c(o,r,n,i,a,"throw",e)}i(void 0)}))}}const u={name:"gastro-pos-order-options",data:function(){var e=this;return{options:nsHooks.applyFilters("ns-gastro-order-options",[{label:__m("Move","NsGastro"),icon:"la-expand-arrows-alt ",onClick:function(t){return e.moveOrder(t)}},{label:__m("Request","NsGastro"),icon:"la-mitten",onClick:function(t){return e.requestOrder(t)}}]),order:null}},mounted:function(){this.popupCloser(),this.order=this.$popupParams.order,this.popupCloser()},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,closePopup:function(){this.popupResolver(!1)},requestOrder:function(e){var t=this;return l(n().mark((function s(){return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if("ready"===e.gastro_order_status){s.next=2;break}return s.abrupt("return",nsSnackBar.error(__m("Unable to request an order that is not ready.","NsGastro")).subscribe());case 2:Popup.show(nsConfirmPopup,{title:__m("Confirm Request","NsGastro"),message:__m("The request will be submitted to the kitchen.","NsGastro"),onAction:function(s){s&&nsHttpClient.get("/api/nexopos/v4/gastro/orders/".concat(e.id,"/request")).subscribe((function(e){t.popupResolver(!0),nsSnackBar.success(e.message,__m("Ok","NsGastro"),{duration:3e3}).subscribe()}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error has occured.","NsGastro"),__m("Ok","NsGastro"),{duration:3e3}).subscribe()}))}});case 3:case"end":return s.stop()}}),s)})))()},moveOrder:function(e){var t=this;return l(n().mark((function s(){return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,new Promise((function(s,r){Popup.show(a,{resolve:s,reject:r,$parent:t,order:e})}));case 3:s.sent,t.popupResolver(!0),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})))()}}},d=(0,i.Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-full ns-box w-95vw h-1/2 md:w-3/4-screen lg:w-3/6-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"grid grid-cols-2"},e._l(e.options,(function(t,r){return s("div",{key:r,staticClass:"border ns-numpad-key flex cursor-pointer items-center justify-center go-h-52 flex-col",on:{click:function(s){return t.onClick(e.order)}}},[s("i",{staticClass:"las go-text-8xl mr-1",class:t.icon}),e._v(" "),s("span",[e._v(e._s(t.label))])])})),0)])}),[],!1,null,null,null).exports},465:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var r=s(757),n=s.n(r);function o(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function i(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function a(e){o(i,r,n,a,c,"next",e)}function c(e){o(i,r,n,a,c,"throw",e)}a(void 0)}))}}const a={name:"gastro-pos-ready-meals",mounted:function(){this.popupCloser(),this.getReadyMeals()},data:function(){return{response:null,prevPage:null,nextPage:null,loaded:!1}},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,serveMeal:function(e){var t=this;return i(n().mark((function s(){return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,new Promise((function(s,r){Popup.show(nsConfirmPopup,{resolve:s,reject:r,title:__m("Would You Mark As Served ?","NsGastro"),message:__m("The meal will be marked as served. Please confirm your action.","NsGastro"),onAction:function(s){s&&nsHttpClient.post("/api/nexopos/v4/gastro/products/".concat(e.id,"/serve")).subscribe((function(e){var s=t.response.links.filter((function(e){return parseInt(e.label)===parseInt(t.response.current_page)}));1===s.length?t.gotToPage(s[0]):t.getReadyMeals(),nsSnackBar.success(e.message).subscribe()}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))}})}));case 3:s.sent,s.next=9;break;case 6:s.prev=6,s.t0=s.catch(0),console.log(s.t0);case 9:case"end":return s.stop()}}),s,null,[[0,6]])})))()},markListedAsServed:function(){var e=this;return i(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.response.data.length){t.next=2;break}return t.abrupt("return",nsSnackBar.error(__m("There is nothing to mark as served.","NsGastro")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){var r=e.response.data.map((function(e){return e.id}));Popup.show(nsConfirmPopup,{resolve:t,reject:s,title:__m("Confirm Yout Action ?","NsGastro"),message:__m("Would you like to mark all listed products as served ?","NsGastro"),onAction:function(t){t&&nsHttpClient.post("/api/nexopos/v4/gastro/products/serve",{products:r}).subscribe((function(t){var s=e.response.links.filter((function(t){return parseInt(t.label)===parseInt(e.response.current_page)}));1===s.length?e.gotToPage(s[0]):e.getReadyMeals(),nsSnackBar.success(t.message).subscribe()}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))}})}));case 5:t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()},getReadyMeals:function(){var e=this;this.loaded=!1,nsHttpClient.get("/api/nexopos/v4/gastro/products/ready").subscribe((function(t){e.loaded=!0,e.response=t}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))},gotToPage:function(e){var t=this;null!==e.url&&nsHttpClient.get(e.url).subscribe((function(e){t.loaded=!0,t.response=e}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))}}};var c=s(810);const l=(0,c.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-95vw h-95vh ns-box flex flex-col shadow-xl md:w-3/5-screen md:h-4/5-screen overflow-hidden"},[s("div",{staticClass:"border-b ns-box-body p-2 flex justify-between items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__m("Ready Meals","NsGastro")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver(!1)}}})],1)]),e._v(" "),e.loaded&&0===e.response.data.length?s("div",{staticClass:"flex flex-auto justify-center items-center flex-col text-primary"},[s("i",{staticClass:"go-text-9xl las la-laugh-wink"}),e._v(" "),s("span",[e._v(e._s(e.__m("Looks like there is nothing to worry about.","NsGastro")))])]):e._e(),e._v(" "),e.loaded&&e.response.data.length>0?s("div",{staticClass:"overflow-y-auto flex-auto"},[s("table",{staticClass:"w-full ns-table"},[s("thead",[s("tr",[s("th",{staticClass:"p-2 border text-left",attrs:{width:"300"}},[e._v(e._s(e.__m("Product","NsGastro")))])])]),e._v(" "),s("tbody",e._l(e.response.data,(function(t){return s("tr",{key:t.id,on:{click:function(s){return e.serveMeal(t)}}},[s("td",{staticClass:"p-2 cursor-pointer border-b"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("div",{staticClass:"grid grid-cols-2 text-sm"},[s("div",[e._v(e._s(e.__m("Placed By","NsGastro"))+" : "+e._s(t.meal_placed_by_name||e.__m("N/A","NsGastro")))]),e._v(" "),s("div",[e._v(e._s(e.__m("Order","NsGastro"))+" : "+e._s(t.order.code))]),e._v(" "),s("div",[e._v(e._s(e.__m("Table","NsGastro"))+" : "+e._s(t.order.table_name||e.__m("N/A","NsGastro")))]),e._v(" "),s("div",[e._v(e._s(e.__m("Type","NsGastro"))+" : "+e._s(t.order.type))])])])])})),0)])]):e._e(),e._v(" "),e.loaded?e._e():s("div",{staticClass:"overflow-y-auto flex-auto flex items-center justify-center"},[s("ns-spinner")],1),e._v(" "),s("div",{staticClass:"p-2 flex justify-between items-center ns-box-footer border-t"},[s("div",[null!==e.response?s("div",{staticClass:"rounded-lg overflow-hidden flex"},e._l(e.response.links,(function(t,r){return s("div",{key:r,staticClass:"ns-button hover-info"},[["pagination.previous","pagination.next"].includes(t.label)?e._e():s("button",{staticClass:"border rounded-lg text-sm mx-1 px-2 py-1",domProps:{innerHTML:e._s(t.label)},on:{click:function(s){return e.gotToPage(t)}}})])})),0):e._e()]),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.markListedAsServed()}}},[e._v(e._s(e.__m("Listed As Served","NsGastro")))])],1)])])}),[],!1,null,null,null).exports;function u(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const d={name:"gastro-pos-orders-button",data:function(){return{readyMeals:0}},methods:{__m:__m,openReadyOrder:function(){return(e=n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Popup.show(l,{resolve:e,reject:t})}));case 3:e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){u(o,r,n,i,a,"next",e)}function a(e){u(o,r,n,i,a,"throw",e)}i(void 0)}))})();var e},getReadyMealCount:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/gastro/products/count-ready").subscribe((function(t){e.readyMeals=t.readyMeals}))}},mounted:function(){var e=this;this.getReadyMealCount(),"undefined"!=typeof Echo?Echo.private("ns.private-channel").listen("Modules\\NsGastro\\Events\\KitchenAfterUpdatedOrderEvent",(function(t){console.log(t),e.getReadyMealCount()})):setInterval((function(){e.getReadyMealCount()}),1e4)}},p=(0,c.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button hover-info"},[s("button",{staticClass:"relative flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm",on:{click:function(t){return e.openReadyOrder()}}},[s("i",{staticClass:"text-xl las la-check-circle"}),e._v(" "),s("span",{staticClass:"ml-1"},[e._v(e._s(e.__m("Ready Meals","NsGastro")))]),e._v(" "),s("span",{staticClass:"h-6 w-6 ml-1 justify-center rounded-full flex items-center bg-info-tertiary text-white fond-bold"},[e._v(e._s(e.readyMeals))])])])}),[],!1,null,null,null).exports},606:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});const r={name:"gastro-pos-tables",mounted:function(){this.popupCloser()},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,closePopup:function(){this.popupResolver(!1)}}},n=(0,s(810).Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-95vw h-95vh md:w-4/5-screen md:h-4/5-screen bg-white shadow-lg"},[s("div",{staticClass:"header border-b border-gray-200 p-2 flex justify-between items-center"},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__m("Table Management","NsGastro")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)])])}),[],!1,null,null,null).exports},277:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var r=s(757),n=s.n(r);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c={data:function(){return i(i({},GastroSettings),{},{search:"",searchTimeout:null,searchResults:[],selectedOrder:null,validation:new FormValidation,orderProducts:[],splitResult:null,customers:[],tables:[],ordersPortions:[],slices:0,splitSlice:0,orderTypes:[],fields:[{type:"number",label:__m("Slices","NsGastro"),description:__m("In how much parts the order should be split","NsGastro"),validation:"required"}]})},computed:{sliceOrderSelected:function(){return this.ordersPortions.filter((function(e){return e.selected})).length>0}},watch:{search:function(){var e=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.searchOrderWithQuery(e.search)}),500)}},mounted:function(){var e=this;this.popupCloser(),this.$refs.searchField.focus(),this.$refs.searchField.addEventListener("blur",(function(){setTimeout((function(){e.searchResults=[]}),300)}))},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,detectOrderType:function(e,t){if("type"===e.name)if("dine-in"===e.value)t.fields.push({label:__m("Table","NsGastro"),name:"table_id",type:"select",options:this.tables,description:__m("Assign the order to a table.","NsGastro"),validation:"required"});else{var s=t.fields.filter((function(e){return"table_id"==e.name}));if(s.length>0){var r=t.fields.indexOf(s[0]);t.fields.splice(r,1)}}},loadTables:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/gastro/tables").subscribe((function(t){e.tables=t.map((function(e){return{label:e.name,value:e.id}}))}),(function(e){return nsSnackBar.error(__m("An unexpected error has occured while fetching the tables.","NsGastro"),null,{duration:3e3}).subscribe()}))},reduceProduct:function(e,t){if(e.quantity--,0===e.quantity){var s=t.products.indexOf(e);t.products.splice(s,1)}var r=0;e.modifiers.length>0&&(r=e.modifiers.map((function(e){return e.total_price})).reduce((function(e,t){return e+t}))),e.total_price=e.quantity*(e.unit_price+r),this.orderProducts.forEach((function(t){t.id===e.id&&(t.displayed_quantity+=1)}))},addProductToSelectedSlice:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=this.ordersPortions.filter((function(e){return e.selected})),r=this.ordersPortions.filter((function(e){return!e.selected}));if(s.length>0){var n=s[0].products.filter((function(t){return t.id===e.id})),o=r.map((function(e){return e.products})).flat().filter((function(t){return t.id===e.id})),i=0;if(o.length>0&&(i=o.map((function(e){return e.quantity})).reduce((function(e,t){return e+t}))),n.length>0){if(e.quantity-(i+(n[0].quantity+t))<=-1)return nsSnackBar.error(__m("Unable to add more quantity.","NsGastro")).subscribe();n[0].quantity+=t;var a=0;n[0].modifiers.length>0&&(a=n[0].modifiers.map((function(e){return e.total_price})).reduce((function(e,t){return e+t}))),n[0].total_price=(n[0].unit_price+a)*n[0].quantity,e.displayed_quantity=e.quantity-n[0].quantity-i}else{if(e.quantity-(i+t)<=-1)return nsSnackBar.error(__m("Unable to add more quantity.","NsGastro")).subscribe();var c=Object.assign({},e);c.quantity=t;var l=0;c.modifiers.length>0&&(l=c.modifiers.map((function(e){return e.total_price})).reduce((function(e,t){return e+t}))),c.total_price=(c.unit_price+l)*c.quantity,s[0].products.push(c),e.displayed_quantity=e.quantity-t-i}}},selectOrderslice:function(e){this.ordersPortions.forEach((function(e){e.selected=!1})),e.selected=!0},selectOrder:function(e){this.selectedOrder=e,this.searchResults=[],this.search="",this.loadOrderProducts()},getOrderType:function(e){return this.typeLabels[e]||__m("Unknown","NsGastro")},loadCustomers:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/customers").subscribe((function(t){console.log(t),e.customers=t.map((function(e){return{label:e.name,value:e.id}}))}))},loadOrderProducts:function(){var e=this;this.loadCustomers(),this.loadOrderType(),this.loadTables(),nsHttpClient.get("/api/nexopos/v4/gastro/orders/".concat(this.selectedOrder.id,"/products")).subscribe((function(t){e.orderProducts=t,e.orderProducts.forEach((function(e){e.displayed_quantity=e.quantity})),e.$refs.sliceField.addEventListener("focus",(function(){e.$refs.sliceField.select()}))}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))},loadOrderType:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/gastro/order-types").subscribe((function(t){e.orderTypes=Object.values(t.types).map((function(e){return{label:e.label,value:e.identifier}}))}))},proceedSplit:function(){var e=this;return 0===this.ordersPortions.length?nsSnackBar.error(__m("Unable to proceed if there is no portions are defined.","NsGastro")).subscribe():this.ordersPortions.map((function(e){return 0===e.products.length})).filter((function(e){return!0===e})).length>0?nsSnackBar.error(__m("Unable to proceed if an order slice is empty.","NsGastro")).subscribe():this.orderProducts.filter((function(e){return e.displayed_quantity>0})).length>0?nsSnackBar.error(__m("Unable to proceed, as there are unassigned products","NsGastro")).subscribe():this.ordersPortions.filter((function(t){return!e.validation.validateFields(t.fields)})).length>0?nsSnackBar.error(__m("Unable to proceed as one or more slice forms is invalid.","NsGastro")).subscribe():void Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("Would you like to confirm the order split ?","NsGastro"),onAction:function(t){t&&e.confirmSplit()}})},confirmSplit:function(){var e=this,t=this.ordersPortions.map((function(t){var s=e.validation.extractFields(t.fields);return s.products=t.products,s}));nsHttpClient.post("/api/nexopos/v4/gastro/orders/split",{original:this.selectedOrder,slices:t}).subscribe((function(t){e.splitResult=t.data}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error has occured while splitting the order.","NsGastro")).subscribe()}))},generatePortions:function(){var e=this;return parseInt(this.slices)<=1||parseInt(this.slices)>5?nsSnackBar.error(__m("Invalid slices for the order. An order can be splited in 2 slices and up to 5 slices.","NsGastro")).subscribe():this.ordersPortions.length>0?Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("Looks like you already have defined some orders parts. Would you like to delete them ?","NsGastro"),onAction:function(t){t&&e.__generatePortions()}}):this.__generatePortions()},__generatePortions:function(){var e=this;this.ordersPortions=new Array(parseInt(this.slices)).fill("").map((function(t){return{fields:e.validation.createFields([{type:"text",options:e.customers,name:"name",label:__m("Name","NsGastro"),description:__m("A name can help you to identify the order quickly.","NsGastro")},{type:"select",options:e.customers,name:"customer_id",label:__m("Assigned Customer","NsGastro"),description:__m("Choose the customer that is assigned to the order.","NsGastro"),validation:"required"},{type:"select",options:e.orderTypes,label:__m("Order Type","NsGastro"),name:"type",description:__m("Define what is the order type.","NsGastro"),validation:"required"}]),type:null,discount:0,products:[],selected:!1}}))},searchOrderWithQuery:function(e){var t=this;e.length>0&&nsHttpClient.get("/api/nexopos/v4/gastro/orders/search?search=".concat(e)).subscribe((function(e){0===e.length&&(t.$refs.searchField.focus(),t.$refs.searchField.select(),nsSnackBar.info(__m("No results match your query, please try again.","NsGastro","OK",{duration:4e3})).subscribe()),t.searchResults=e}),(function(e){return nsSnacBar.error(__m("An error has occured while searching orders","NsGastro"),"OK",{duration:4e3}).subscribe()}))}}};var l=s(810);const u=(0,l.Z)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-xl flex flex-col w-95vw h-95vh ns-box"},[s("div",{staticClass:"flex justify-between border-b items-center ns-box-header p-2"},[s("h2",[e._v(e._s(e.__m("Split Orders","NsGastro")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver()}}})],1)]),e._v(" "),null===e.splitResult?s("div",{staticClass:"p-2 ns-box-body flex-auto flex flex-col overflow-hidden"},[s("div",{staticClass:"rounded overflow-hidden border-2 flex flex-shrink-0 input-group info w-full"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],ref:"searchField",staticClass:"flex-auto p-2 outline-none",attrs:{placeholder:e.__m("Order Code","NsGastro"),type:"text"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-3 py-2",on:{click:function(t){return e.searchOrderWithQuery(e.search)}}},[e._v(e._s(e.__m("Search","NsGastro")))])]),e._v(" "),s("div",{staticClass:"h-0 relative"},[s("div",{staticClass:"shadow elevation-surface w-full absolute z-10"},[s("ul",e._l(e.searchResults,(function(t){return s("li",{key:t.id,staticClass:"cursor-pointer p-2 border-b bg-box-elevation-edge flex flex-col justify-between",on:{click:function(s){return e.selectOrder(t)}}},[s("div",{staticClass:"flex justify-between"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(t.code))]),e._v(" "),s("span",{staticClass:"text-primary"},[e._v(e._s(e._f("currency")(t.total)))])]),e._v(" "),s("div",{staticClass:"flex justify-between"},[s("div",[s("span",{staticClass:"text-sm text-secondary"},[e._v(e._s(e.__m("Customer: ","NsGastro"))+" "+e._s(t.customer.name))])]),e._v(" "),s("div",[s("span",{staticClass:"text-sm text-secondary"},[e._v(e._s(e.__m("Order Type: ","NsGastro"))+" "+e._s(e.getOrderType(t.type)))])])])])})),0)])]),e._v(" "),null===e.selectedOrder?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("div",{staticClass:"flex flex-col justify-center items-center text-gray-500"},[s("i",{staticClass:"las la-smile go-text-8xl"}),e._v(" "),s("p",{staticClass:"text-sm"},[e._v(e._s(e.__m("Search an order to get started.","NsGastro")))])])]):e._e(),e._v(" "),null!==e.selectedOrder?s("div",{staticClass:"flex flex-auto go-mt-4 flex-wrap overflow-auto md:overflow-hidden"},[s("div",{staticClass:"w-full md:w-1/2 md:h-full p-2 elevation-surface md:flex-auto md:overflow-y-auto"},[s("h1",{staticClass:"text-secondary w-full py-2 border-b border-indigo-400 flex justify-between"},[s("span",[e._v(e._s(e.__m("Original Order","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(e.selectedOrder.code))])]),e._v(" "),s("div",{staticClass:"py-2"},[s("div",{staticClass:"flex mb-2"},[s("div",{staticClass:"rounded border-2 input-group info flex overflow-hidden flex-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.slices,expression:"slices"}],ref:"sliceField",staticClass:"p-2 flex-auto outline-none",attrs:{type:"number"},domProps:{value:e.slices},on:{input:function(t){t.target.composing||(e.slices=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-3 py-1",on:{click:function(t){return e.generatePortions()}}},[e._v(e._s(e.__m("Generate","NsGastro")))])])]),e._v(" "),s("div",{staticClass:"flex flex-wrap -mx-1"},e._l(e.orderProducts,(function(t){return s("div",{key:t.id,staticClass:"p-1 w-full lg:w-1/2"},[s("div",{staticClass:"bg-info-secondary flex p-2"},[s("div",{staticClass:"flex flex-auto"},[s("div",{staticClass:"flex-auto"},[s("span",{staticClass:"text-primary"},[e._v(e._s(t.name)+" (x"+e._s(t.displayed_quantity)+")")]),e._v(" "),s("ul",e._l(t.modifiers,(function(t){return s("li",{key:t.id,staticClass:"text-sm text-secondary p-1 border-b border-blue-400 flex justify-between"},[s("span",[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total_price)))])])})),0)]),e._v(" "),s("span",{staticClass:"flex justify-end"},[e._v(e._s(e._f("currency")(t.total_price)))])])]),e._v(" "),s("div",{staticClass:"w-full flex"},[e.sliceOrderSelected?s("button",{staticClass:"flex-auto bg-blue-400 text-white font-bold outline-none p-1",on:{click:function(s){return e.addProductToSelectedSlice(t)}}},[e._v(e._s(e.__m("Add","NsGastro")))]):e._e()])])})),0)])]),e._v(" "),s("div",{staticClass:"w-full md:w-1/2 md:h-full md:flex-auto overflow-y-auto"},e._l(e.ordersPortions,(function(t,r){return s("div",{key:r,staticClass:"p-2",class:t.selected?"elevation-surface border-t-2 border-b-2 border-box-edge":""},[e._l(t.fields,(function(r,n){return s("ns-field",{key:n,attrs:{field:r},on:{change:function(s){return e.detectOrderType(s,t)}}})})),e._v(" "),t.products.length>0?s("div",{staticClass:"my-2 border border-box-elevation-edge"},[s("div",{staticClass:"head p-2 text-center font-semibold border-b border-box-elevation-edge"},[e._v(e._s(e.__m("Products","NsGastro")))]),e._v(" "),s("div",{staticClass:"p-2"},e._l(t.products,(function(r){return s("div",{key:r.id,staticClass:"mb-2"},[s("div",{staticClass:"flex justify-between text-primary"},[s("span",[e._v(e._s(r.name)+" (x"+e._s(r.quantity)+")")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(r.total_price)))])]),e._v(" "),r.modifiers.length>0?s("ul",e._l(r.modifiers,(function(t){return s("li",{key:t.id,staticClass:"text-secondary py-1 flex justify-between text-xs"},[s("span",[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total_price)))])])})),0):e._e(),e._v(" "),s("div",{staticClass:"ns-button hover-error flex"},[s("button",{staticClass:"cursor-pointer border w-full p-1 font-semibold text-center",on:{click:function(s){return e.reduceProduct(r,t)}}},[e._v(e._s(e.__m("Remove","NsGastro")))])])])})),0)]):e._e(),e._v(" "),t.selected?e._e():s("div",{staticClass:"mt-2 text-primary font-semibold p-2 elevation-surface text-center cursor-pointer",class:t.selected?"":"info",on:{click:function(s){return e.selectOrderslice(t)}}},[t.select?e._e():s("span",[e._v(e._s(e.__m("Select","NsGastro")))]),e._v(" "),t.select?s("span",{staticClass:"opacity-0"},[e._v(e._s(e.__m("Selected","NsGastro")))]):e._e()])],2)})),0)]):e._e()]):e._e(),e._v(" "),e.splitResult?s("div",{staticClass:"p-2 flex-auto"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},e._l(e.splitResult,(function(t,r){return s("div",{key:r,staticClass:"w-full md:w-1/2 lg:w-1/3 px-4"},[s("div",{staticClass:"shadow elevation-surface"},[s("div",{staticClass:"header p-2 font-semibold border-b border-box-edge"},[e._v(e._s(t.data.order.code))]),e._v(" "),s("div",{staticClass:"p-2"},[s("ul",[s("li",{staticClass:"text-sm text-secondary p-2 border-b border-box-edge flex justify-between"},[s("span",[e._v(e._s(e.__m("Net","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.data.order.net_total)))])]),e._v(" "),s("li",{staticClass:"text-sm text-secondary p-2 border-b border-box-edge flex justify-between"},[s("span",[e._v(e._s(e.__m("Total","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.data.order.net_total)))])])])])])])})),0)]):e._e(),e._v(" "),null===e.splitResult?s("div",{staticClass:"p-2 flex justify-end"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.proceedSplit()}}},[e._v(e._s(e.__m("Proceed","NsGastro")))])],1):e._e()])}),[],!1,null,null,null).exports;function d(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}s(43);const p={methods:{__m:__m,openSplitOrderPopup:function(){return(e=n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Popup.show(u,{resolve:e,reject:t})}));case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){d(o,r,n,i,a,"next",e)}function a(e){d(o,r,n,i,a,"throw",e)}i(void 0)}))})();var e}}},f=(0,l.Z)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button"},[s("div",{staticClass:"ns-button hover-warning"},[s("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm",on:{click:function(t){return e.openSplitOrderPopup()}}},[s("i",{staticClass:"text-xl las la-expand-arrows-alt mr-2"}),e._v(" "),s("span",[e._v(e._s(e.__m("Split Orders","NsGastro")))])])])])}),[],!1,null,null,null).exports},129:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s(757),n=s.n(r),o=(s(606),s(43));function i(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const a={methods:{__m:__m,openTableManagement:function(){return(e=n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Popup.show(o.Z,{resolve:e,reject:t,mode:"explore"})}));case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function a(e){i(o,r,n,a,c,"next",e)}function c(e){i(o,r,n,a,c,"throw",e)}a(void 0)}))})();var e}}},c=(0,s(810).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button hover-info"},[s("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm",on:{click:function(t){return e.openTableManagement()}}},[s("i",{staticClass:"text-xl las la-utensils"}),e._v(" "),s("span",[e._v(e._s(e.__m("Tables","NsGastro")))])])])}),[],!1,null,null,null).exports},43:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var r,n=s(757),o=s.n(n);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const a={name:"gastro-kitchen-settings",data:function(){return console.log(this),{validation:new FormValidation,fields:[]}},computed:{title:function(){return this.$popupParams.title||__m("Untitled Popup","NsGastro")}},mounted:function(){this.fields=this.validation.createFields(this.$popupParams.fields),this.popupCloser()},methods:(r={__m:__m,popupResolver:popupResolver,popupCloser:popupCloser,saveForm:function(){this.popupResolver(this.validation.extractFields(this.fields))}},i(r,"popupCloser",popupCloser),i(r,"popupResolver",popupResolver),i(r,"closePopup",(function(){this.popupResolver(!1)})),r)};var c=s(810);const l=(0,c.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-95vw md:w-3/5-screen lg:w-2/5-screen shadow-xl ns-box"},[s("div",{staticClass:"p-2 flex items-center border-b ns-box-header justify-between"},[s("div",{staticClass:"h3 font-semibold"},[e._v(e._s(e.title))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver(!1)}}})],1)]),e._v(" "),s("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"p-2 border-t ns-box-body flex justify-between"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveForm()}}},[e._v(e._s(e.__m("Save","NsGastro")))])],1)])])}),[],!1,null,null,null).exports;var u=s(931);function d(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function p(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){d(o,r,n,i,a,"next",e)}function a(e){d(o,r,n,i,a,"throw",e)}i(void 0)}))}}const f={name:"gastro-pos-product-options",computed:{product:function(){return this.$popupParams.product}},mounted:function(){this.popupCloser()},methods:{__m:__m,popupResolver:popupResolver,popupCloser:popupCloser,updateNote:function(){var e=this;return p(o().mark((function t(){var s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("pending"===e.product.cooking_status){t.next=2;break}return t.abrupt("return",nsSnackBar.error(__m("Unable to edit this product notes.","NsGastro")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){Popup.show(nsPromptPopup,{resolve:t,reject:s,input:e.product.cooking_note,title:"Meal Note",message:"The following note will be visible at the kitchen and on the kitchen slip.",onAction:function(e){t(e)}})}));case 5:s=t.sent,e.product.cooking_note=s,nsHttpClient.post("/api/nexopos/v4/gastro/products/".concat(e.product.id,"/note"),{note:s}).subscribe((function(t){e.popupResolver(e.product),nsSnackBar.success(t.message).subscribe()}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()})),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})))()},serveMeal:function(){var e=this;return p(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ready"===e.product.cooking_status){t.next=2;break}return t.abrupt("return",nsSnackBar.error(__m("Unable to serve a meal that is not ready.","NsGastro")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){Popup.show(nsConfirmPopup,{title:__m("Would You Serve The Meal ?","NsGastro"),resolve:t,reject:s,message:__m("You're about to serve the meal \"{product}\". note that this operation can't be canceled.","NsGastro").replace("{product}",e.product.name),onAction:function(t){t&&nsHttpClient.post("/api/nexopos/v4/gastro/products/".concat(e.product.id,"/serve"),{reason:t}).subscribe((function(t){nsSnackBar.success(t.message).subscribe(),e.popupResolver(t)}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))}})}));case 5:t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()},printCanceledMeal:function(e){Gastro.printOrderCanceledMealKitchen(e)},cancelMeal:function(){var e=this;return p(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("canceled"!==e.product.cooking_status){t.next=2;break}return t.abrupt("return",nsSnackBar.error(__m("Unable to cancel an already canceled product.","NsGastro")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){Popup.show(nsPromptPopup,{title:__m("Confirm Your Action","NsGastro"),resolve:t,reject:s,message:__m('You\'re about to cancel "{product}". Please provide a reason for this action.',"NsGastro").replace("{product}",e.product.name),onAction:function(t){"string"==typeof t&&nsHttpClient.post("/api/nexopos/v4/gastro/products/".concat(e.product.id,"/cancel"),{reason:t}).subscribe((function(t){nsSnackBar.success(t.message).subscribe(),e.$popupParams.product=t.data.product,e.printCanceledMeal(e.product.order_id)}),(function(e){nsSnackBar.error(e.message||__m("An unexpected error occured.","NsGastro")).subscribe()}))}})}));case 5:t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()}}},v=(0,c.Z)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-lg w-2/3-screen md:w-1/3-screen overflow-hidden"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("span",[e._v(e._s(e.__m("Product Options","NsGastro")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver(!1)}}})],1)]),e._v(" "),s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"h-32 border ns-numpad-key flex items-center justify-center flex-col",class:"ready"===e.product.cooking_status?"cursor-pointer":"cursor-not-allowed",on:{click:function(t){return e.serveMeal()}}},[s("i",{staticClass:"text-6xl las la-concierge-bell"}),e._v(" "),s("span",[e._v(e._s(e.__m("Served","NsGastro")))])]),e._v(" "),s("div",{staticClass:"cursor-pointer h-32 border ns-numpad-key flex items-center justify-center flex-col",class:"canceled"!==e.product.cooking_status?"cursor-pointer":"cursor-not-allowed",on:{click:function(t){return e.cancelMeal()}}},[s("i",{staticClass:"text-6xl las la-times"}),e._v(" "),s("span",[e._v(e._s(e.__m("Cancel","NsGastro")))])]),e._v(" "),s("div",{staticClass:"h-32 border ns-numpad-key flex items-center justify-center flex-col",class:"pending"===e.product.cooking_status?"cursor-pointer":"cursor-not-allowed",on:{click:function(t){return e.updateNote()}}},[s("i",{staticClass:"text-6xl las la-comment-alt"}),e._v(" "),s("span",[e._v(e._s(e.__m("Note","NsGastro")))])])])])}),[],!1,null,null,null).exports,_={name:"gastro-keyboard",data:function(){return{keyboardComponent:function(){return nsComponents.nsNumpad}}},methods:{__m:__m,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},updateModifierQuantity:function(e){this.table.selectedSeats=e,this.$forceUpdate()},saveQuantity:function(e){parseFloat(e)>0&&parseFloat(e)<=parseFloat(this.table.seats)?(this.table.selectedSeats=parseFloat(e),this.$popup.close(),this.$popupParams.resolve(this.table)):nsSnackBar.error("Invalid seats provided.").subscribe()}},computed:{selectedSeats:function(){return this.table.selectedSeats||1},table:function(){return this.$popupParams.table}},mounted:function(){}},m=(0,c.Z)(_,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/5-screen"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[s("h3",[e._v(e._s(e.__m("Select Seats","NsGastro")))]),e._v(" "),s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1),e._v(" "),s("div",{staticClass:"p-2 border-b ns-box-body"},[s("div",{staticClass:"bg-gray-100 text-3xl flex justify-end p-2"},[e._v(e._s(e.table.selectedSeats))])]),e._v(" "),s("div",{staticClass:"p-2"},[s(e.keyboardComponent(),{tag:"component",attrs:{value:e.selectedSeats},on:{next:function(t){return e.saveQuantity(t)},changed:function(t){return e.updateModifierQuantity(t)}}})],1)])}),[],!1,null,null,null).exports;function h(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function b(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function i(e){h(o,r,n,i,a,"next",e)}function a(e){h(o,r,n,i,a,"throw",e)}i(void 0)}))}}function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function y(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const g={mounted:function(){var e=this;this.ns_gastro_areas_enabled?(this.loadAreas(),this.screen="areas"):(this.loadTables(),this.screen="tables"),this.mode=this.$popupParams.mode||"select",ns.websocket.enabled?this.listenSockets():this.launchIntervalFetches(),Gastro.tableOpenedSubject.next(!0),this.popupCloser(),nsHooks.addAction("ns-pos-payment-destroyed","gastro-reset-cart",(function(){e.isPaying&&(POS.reset(),e.isPaying=!1)}))},destroyed:function(){Gastro.tableOpenedSubject.next(!1),clearTimeout(this.intervalFetches)},data:function(){var e=JSON.parse(localStorage.getItem("gastro.table.settings")),t=ns.date.moment.startOf("day").format(),s=ns.date.moment.endOf("day").format();return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({screen:"areas",tableLoaded:!1,mouseDown:!1,ordersLoaded:!1,intervalFetches:null,additionalTitle:null,areasLoaded:!1,selectedArea:null,selectedTable:null,selectedSessions:null,isPaying:!1,areas:[],tables:[],showDetails:{},sessions:[],orders:[],filterMode:"",mode:"select",settings:{range_starts:null!==e&&e.range_starts||t,range_ends:null!==e&&e.range_ends||s}},GastroSettings)},computed:{order:function(){return POS.order.getValue()},hasCustomSettings:function(){return null!==localStorage.getItem("gastro.table.settings")}},methods:{__m:__m,popupCloser:popupCloser,popupResolver:popupResolver,toggleDetails:function(e){this.$set(this.showDetails,e.code,!this.showDetails[e.code]),this.$forceUpdate()},launchIntervalFetches:function(){var e=this;this.intervalFetches=setInterval((function(){"orders"===e.screen&&e.showTableHistory(e.selectedTable),"sessions-orders"===e.screen&&e.loadSessionOrders(e.selectedSessions)}),5e3)},toggleTableSessionHistory:function(){var e=this;"sessions"!==this.screen?(this.sessions=[],nsHttpClient.post("/api/nexopos/v4/gastro/tables/".concat(this.selectedTable.id,"/sessions"),this.settings).subscribe({next:function(t){e.sessions=t,e.screen="sessions"},error:function(e){nsSnackBar.error(__m("An unexpected error has occured.","NsGastro")).subscribe()}})):(this.screen="orders",this.showTableHistory(this.selectedTable))},loadSessionOrders:function(e){var t=this;this.screen="sessions-orders",this.selectedSessions=e,nsHttpClient.post("/api/nexopos/v4/gastro/tables/".concat(this.selectedTable.id,"/sessions/").concat(e.id,"/orders"),this.settings).subscribe({next:function(e){t.orders=e},error:function(e){nsSnackBar.error(__m("An unexpected error has occured.","NsGastro")).subscribe()}})},openSession:function(e){var t=this;Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("Would you like to open this session ?","NsGastro"),onAction:function(s){s&&nsHttpClient.put("/api/nexopos/v4/gastro/tables/".concat(t.selectedTable.id,"/sessions/").concat(e.id,"/action"),{action:"open"}).subscribe({next:function(e){t.toggleTableSessionHistory(),nsSnackBar.success(e.message,__m("Okay","NsGastro"),{duration:3e3}).subscribe()},error:function(e){nsSnackBar.error(__m("An unexpected error has occured.","NsGastro")).subscribe()}})}})},closeSession:function(e){var t=this;Popup.show(nsConfirmPopup,{title:__m("Confirm Your Action","NsGastro"),message:__m("Would you like to close this session manually ?","NsGastro"),onAction:function(s){s&&nsHttpClient.put("/api/nexopos/v4/gastro/tables/".concat(t.selectedTable.id,"/sessions/").concat(e.id,"/action"),{action:"close"}).subscribe({next:function(e){t.toggleTableSessionHistory(),nsSnackBar.success(e.message,__m("Okay","NsGastro"),{duration:3e3}).subscribe()},error:function(e){nsSnackBar.error(__m("An unexpected error has occured.","NsGastro")).subscribe()}})}})},listenSockets:function(){var e=this;Echo.private("ns.private-channel").listen("App\\Events\\OrderAfterCreatedEvent",(function(t){e.showTableHistory(e.selectedTable)})).listen("Modules\\NsGastro\\Events\\TableAfterUpdatedEvent",(function(t){e.showTableHistory(e.selectedTable)})).listen("App\\Events\\OrderAfterUpdatedEvent",(function(t){e.showTableHistory(e.selectedTable)}))},filterOnlyBusy:function(){["","free"].includes(this.filterMode)?this.filterMode="busy":this.filterMode="",this.loadTables(this.selectedArea)},filterOnlyAvailable:function(){["","busy"].includes(this.filterMode)?this.filterMode="free":this.filterMode="",this.loadTables(this.selectedArea)},setRange:function(e){switch(e){case"today":this.settings.range_starts=moment(ns.date.current).startOf("day").format("YYYY/MM/DD HH:mm:ss"),this.settings.range_ends=moment(ns.date.current).endOf("day").format("YYYY/MM/DD HH:mm:ss");break;case"yesterday":this.settings.range_starts=moment(ns.date.current).subtract(1,"days").startOf("day").format("YYYY/MM/DD HH:mm:ss"),this.settings.range_ends=moment(ns.date.current).endOf("day").format("YYYY/MM/DD HH:mm:ss");break;case"week":this.settings.range_starts=moment(ns.date.current).subtract(6,"days").startOf("day").format("YYYY/MM/DD HH:mm:ss"),this.settings.range_ends=moment(ns.date.current).endOf("day").format("YYYY/MM/DD HH:mm:ss")}localStorage.setItem("gastro.table.settings",JSON.stringify(this.settings))},debounceForAvailability:function(e,t){var s=this;e.busy&&(this.mouseDown=!0,setTimeout((function(){s.mouseDown&&(s.setAvailable(e),t.preventDefault())}),600))},openOrderOption:function(e){var t=this;return b(o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,new Promise((function(t,s){Popup.show(u.Z,{resolve:t,reject:s,order:e})}));case 3:s.sent,t.showTableHistory(t.selectedTable),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})))()},addProduct:function(e){Gastro.selectedOrder.next(e),Gastro.setAddButtonsVisibility("visible"),this.$popup.close()},printOrder:function(e){POS.print.process(e.id,"sale","aloud")},payOrder:function(e){var t=this;return b(o().mark((function s(){var r,n;return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return r=Popup.show(nsPOSLoadingPopup),n=POS.order.getValue(),s.prev=2,s.next=5,POS.loadOrder(e.id);case 5:if("paid"!==POS.order.getValue().payment_status){s.next=9;break}return POS.reset(),s.abrupt("return",nsSnackBar.error(__m("Unable to make a payment for an already paid order.","NsGastro")).subscribe());case 9:t.proceedCustomerLoading(n),t.isPaying=!0,s.next=16;break;case 13:s.prev=13,s.t0=s.catch(2),console.log(s.t0);case 16:r.close();case 17:case"end":return s.stop()}}),s,null,[[2,13]])})))()},proceedCustomerLoading:function(e){return b(o().mark((function e(){var t,s,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[ProductsQueue,CustomerQueue,TypeQueue,PaymentQueue],s=POS.order.getValue(),e.t0=o().keys(t);case 3:if((e.t1=e.t0()).done){e.next=17;break}return r=e.t1.value,e.prev=5,n=new t[r](s),e.next=9,n.run();case 9:e.sent,e.next=15;break;case 12:return e.prev=12,e.t2=e.catch(5),e.abrupt("return",!1);case 15:e.next=3;break;case 17:case"end":return e.stop()}}),e,null,[[5,12]])})))()},openSettingsOptions:function(){var e=this;return b(o().mark((function t(){var s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,s){Popup.show(l,{fields:[{type:"datetimepicker",name:"range_starts",label:__m("Start Range","NsGastro"),value:e.settings.range_starts,description:__m("Define when from which moment the orders should be fetched.","NsGastro")},{type:"datetimepicker",name:"range_ends",label:__m("End Range","NsGastro"),value:e.settings.range_ends,description:__m("Define till which moment the orders should be fetched.","NsGastro")}],resolve:t,reject:s,settings:e.settings,title:__m("Settings","NsGastro")})}));case 3:s=t.sent,localStorage.setItem("gastro.table.settings",JSON.stringify(e.settings)),e.settings=s,e.showTableHistory(e.selectedTable),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getMealBGClass:function(e){switch(e.cooking_status){case"ready":case"processed":return"bg-success-secondary";case"ongoing":return"bg-info-secondary";case"canceled":return"bg-input-disabled";case"requested":return"bg-warning-secondary"}},getMealProductTextColor:function(e){return"canceled"===e.cooking_status?"text-secondary":"text-primary"},getMealModifierTextColor:function(e){return"canceled"===e.cooking_status?"text-secondary":"text-primary"},closePopup:function(){this.$popup.close(),this.$popupParams.reject(!1)},returnToAreas:function(){this.loadAreas()},returnToTables:function(){this.selectedTable=null,this.loadTables(this.selectedArea)},loadAreas:function(){var e=this;this.screen="areas",this.areasLoaded=!1,nsHttpClient.get("/api/nexopos/v4/gastro/areas").subscribe({next:function(t){e.areasLoaded=!0,e.areas=t},error:function(e){nsSnackBar.error(e.message||__m("An unexpected error has occured.","NsGastro"),__m("OK","NsGastro"),{duration:0}).subscribe()}})},setAvailable:function(e){var t=this;Popup.show(nsConfirmPopup,{title:__m("Set the table as available ?","NsGastro"),message:__m("You'll set the table as available, please confirm your action.","NsGastro"),onAction:function(s){s&&nsHttpClient.post("/api/nexopos/v4/gastro/tables/".concat(e.id,"/change-availability"),{status:"available"}).subscribe({next:function(e){t.loadTables(t.selectedArea),nsSnackBar.success(e.message,__m("OK","NsGastro"),{duration:3e3}).subscribe()},error:function(e){nsSnackBar.success(e.message||__m("An unexpected error has occured.","NsGastro"),__m("OK","NsGastro"),{duration:3e3}).subscribe()}})}})},loadTables:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.selectedArea=t,this.screen="tables",this.tableLoaded=!1,this.additionalTitle=null;var s=null===t?nsHttpClient.get("/api/nexopos/v4/gastro/tables?filter=".concat(this.filterMode)):nsHttpClient.get("/api/nexopos/v4/gastro/areas/".concat(t.id,"/available-tables?filter=").concat(this.filterMode));s.subscribe({next:function(t){e.tableLoaded=!0,e.tables=t.map((function(t){return t.selectedSeats=1,t.selected=!(!e.order.table||e.order.table.id!==t.id)&&e.order.table,t}))},error:function(e){nsSnackBar.error(e.message||__m("An unexpected error has occured.","NsGastro"),__m("OK","NsGastro"),{duration:0}).subscribe()}})},selectQuantity:function(e){return"select"===this.mode?this.proceedSelect(e):this.showTableHistory(e)},showTableHistory:function(e){var t=this;this.selectedTable=e,this.additionalTitle=__m("{table} : Orders History - {availability}","NsGastro").replace("{availability}",e.busy?__m("Busy","NsGastro"):__m("Available","NsGastro")).replace("{table}",e.name),this.screen="orders",this.ordersLoaded=!1,nsHttpClient.post("/api/nexopos/v4/gastro/tables/".concat(e.id,"/orders"),this.settings).subscribe({next:function(e){t.ordersLoaded=!0,e.map((function(e){return void 0===t.showDetails[e.code]&&(t.showDetails[e.code]=!1),e})),t.orders=e}})},showProductOptions:function(e){var t=this;return b(o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,new Promise((function(t,s){Popup.show(v,{resolve:t,reject:s,product:e})}));case 3:s.sent,t.showTableHistory(t.selectedTable),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})))()},proceedSelect:function(e){var t=this;return b(o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!t.ns_gastro_seats_enabled){s.next=11;break}return s.prev=1,t.tables.forEach((function(e){e.selected=!1,e.selectedSeats=1})),s.next=5,new Promise((function(t,s){Popup.show(m,{resolve:t,reject:s,table:e})}));case 5:e=s.sent,s.next=11;break;case 8:return s.prev=8,s.t0=s.catch(1),s.abrupt("return",nsSnackBar.error(__m("You need to define the seats before proceeding.","NsGastro")).subscribe());case 11:e.selected=!0,t.order.table_id=e.id,t.order.table=e,t.order.area_id=e.area_id,void 0===t.order.type&&(t.order.type=Gastro.getType()),t.order.type.label=Gastro.getType().label,POS.order.next(t.order),t.$popup.close(),t.$popupParams.resolve(e);case 20:case"end":return s.stop()}}),s,null,[[1,8]])})))()}}},w=(0,c.Z)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-full ns-box w-95vw h-95vh md:w-4/5-screen lg:w-4/6-screen md:h-4/5-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"border-b ns-box-header p-2 flex flex-col md:flex-row justify-between items-center",class:null!==e.selectedTable&&e.selectedTable.busy?"bg-success-tertiary text-white":""},[s("div",{staticClass:"flex-auto"},[s("h3",{staticClass:"font-semibold mb-1 md:mb-0 text-primary"},[e.additionalTitle?e._e():s("span",[e._v(e._s(e.__m("Table Management","NsGastro")))]),e._v(" "),e.additionalTitle?s("span",[e._v(e._s(e.additionalTitle))]):e._e()])]),e._v(" "),s("div",{staticClass:"flex items-center justify-between w-full md:w-auto"},[s("div",{staticClass:"flex"},[["orders","sessions-orders"].includes(e.screen)?s("div",{staticClass:"px-1"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 border ns-inset-button success",class:e.hasCustomSettings?"info":"",on:{click:function(t){return e.openSettingsOptions()}}},[s("i",{staticClass:"las la-tools"}),e._v(" "),s("span",[e._v(e._s(e.__m("Settings","NsGastro")))])])]):e._e(),e._v(" "),["orders","sessions-orders","sessions"].includes(e.screen)&&e.ns_gastro_enable_table_sessions?s("div",{staticClass:"px-1"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 border ns-inset-button",class:["sessions","sessions-orders"].includes(e.screen)?"info":"",on:{click:function(t){return e.toggleTableSessionHistory()}}},[s("i",{staticClass:"las la-history"}),e._v(" "),s("span",[e._v(e._s(e.__m("Session History","NsGastro")))])])]):e._e(),e._v(" "),"tables"===e.screen?s("div",{staticClass:"px-1 -mx-1 flex flex-col md:flex-row"},[s("div",{staticClass:"px-1"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 border border-gray1200 ns-inset-button success",class:"busy"===e.filterMode?"active":"",on:{click:function(t){return e.filterOnlyBusy()}}},[e._v(e._s(e.__m("Only Busy Tables","NsGastro")))])]),e._v(" "),s("div",{staticClass:"px-1"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 border border1gray-200 ns-inset-button success",class:"free"===e.filterMode?"active":"",on:{click:function(t){return e.filterOnlyAvailable()}}},[e._v(e._s(e.__m("Only Available Tables","NsGastro")))])])]):e._e(),e._v(" "),e.ns_gastro_areas_enabled&&"tables"===e.screen?s("div",{staticClass:"px-1 -mx-2 flex"},[s("div",{staticClass:"px-2"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 ns-inset-button error border",on:{click:function(t){return e.returnToAreas()}}},[e._v(e._s(e.__m("Return","NsGastro")))])])]):e._e(),e._v(" "),["orders","sessions-orders"].includes(e.screen)?s("div",{staticClass:"px-1"},[s("button",{staticClass:"outline-none rounded-full px-3 py-1 ns-inset-button error border",on:{click:function(t){return e.returnToTables()}}},[e._v(e._s(e.__m("Return","NsGastro")))])]):e._e()]),e._v(" "),s("div",{staticClass:"px-1"},[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)])]),e._v(" "),["orders","sessions-orders"].includes(e.screen)?s("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[e.orders.length>0?s("div",{staticClass:"flex-auto overflow-y-auto"},[s("div",{staticClass:"flex flex-wrap"},e._l(e.orders,(function(t){return s("div",{key:t.id,staticClass:"border border-box-edge w-full p-2 md:w-1/2"},[s("div",{staticClass:"flex justify-between p-2"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(t.code))]),e._v(" "),s("div",{staticClass:"-mx-1 flex items-center"},[["canceled","ready"].includes(t.gastro_order_status)?e._e():s("div",{staticClass:"px-1"}),e._v(" "),s("div",{staticClass:"px-1"},[e.showDetails[t.code]?e._e():s("button",{staticClass:"rounded-full px-3 ns-inset-button info border",on:{click:function(s){return e.toggleDetails(t)}}},[s("i",{staticClass:"las la-eye"}),e._v(" "),s("span",{staticClass:"text-sm"},[e._v(e._s(e.__m("Show Details","NsGastro")))])]),e._v(" "),e.showDetails[t.code]?s("button",{staticClass:"rounded-full px-3 ns-inset-button info border",on:{click:function(s){return e.toggleDetails(t)}}},[s("i",{staticClass:"las la-low-vision"}),e._v(" "),s("span",{staticClass:"text-sm"},[e._v(e._s(e.__m("Hide Details","NsGastro")))])]):e._e()]),e._v(" "),s("div",{staticClass:"px-1"},["ready"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 success",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Ready","NsGastro"))+"\n                                ")]):e._e(),e._v(" "),"ongoing"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 info",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Ongoing","NsGastro"))+"\n                                ")]):e._e(),e._v(" "),"pending"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 info",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Pending","NsGastro"))+"\n                                ")]):e._e(),e._v(" "),"canceled"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 error",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Canceled","NsGastro"))+"\n                                ")]):e._e(),e._v(" "),"requested"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 warning",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Requested","NsGastro"))+"\n                                ")]):e._e(),e._v(" "),"processed"===t.gastro_order_status?s("button",{staticClass:"rounded-full ns-inset-button border px-2 info",attrs:{disabled:!0}},[e._v("\n                                    "+e._s(e.__m("Processed","NsGastro"))+"\n                                ")]):e._e()])])]),e._v(" "),e.showDetails[t.code]?s("div",[s("div",{staticClass:"flex my-1 px-2 text-sm text-primary justify-between"},[s("span",[e._v(e._s(e.__m("Total","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total)))])]),e._v(" "),s("div",{staticClass:"flex my-1 px-2 text-sm text-primary justify-between"},[s("span",[e._v(e._s(e.__m("Name","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(t.title||e.__m("N/A","NsGastro")))])]),e._v(" "),s("div",{staticClass:"flex my-1 px-2 text-sm text-primary justify-between"},[s("span",[e._v(e._s(e.__m("Waiter","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(t.user.username||e.__m("N/A","NsGastro")))])]),e._v(" "),s("div",{staticClass:"flex my-1 px-2 text-sm text-primary justify-between"},[s("span",[e._v(e._s(e.__m("Customer","NsGastro")))]),e._v(" "),s("span",[e._v(e._s(t.customer.name||e.__m("N/A","NsGastro")))])])]):e._e(),e._v(" "),s("div",{staticClass:"bg-gray-100"},[s("div",e._l(t.products,(function(t){return s("div",{key:t.id,staticClass:"p-2 hover:bg-blue-100 mb-1 cursor-pointer",class:e.getMealBGClass(t),on:{click:function(s){return e.showProductOptions(t)}}},[s("div",{staticClass:"flex text-sm justify-between",class:e.getMealProductTextColor(t)},[s("h4",{staticClass:"font-semibold"},[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total_price)))])]),e._v(" "),s("ul",{staticClass:"text-xs",class:e.getMealModifierTextColor(t)},e._l(t.modifiers,(function(t){return s("li",{key:t.id,staticClass:"py-1 border-b border-dashed border-blue-400 flex justify-between"},[s("span",[e._v("\n                                            "+e._s(t.name)+" (x"+e._s(t.quantity)+")\n                                        ")]),e._v(" "),s("span",[e._v("\n                                            "+e._s(e._f("currency")(t.total_price))+"\n                                        ")])])})),0)])})),0),e._v(" "),s("div",{staticClass:"flex flex-wrap"},["paid"!==t.payment_status?s("button",{staticClass:"w-1/2 lg:w-1/4 flex items-center justify-center py-1 bg-blue-400 text-white font-semibold",on:{click:function(s){return e.addProduct(t)}}},[s("i",{staticClass:"las la-plus text-2xl mr-1"}),e._v(" "),s("span",[e._v(e._s(e.__m("Add","NsGastro")))])]):e._e(),e._v(" "),"paid"!==t.payment_status?s("button",{staticClass:"w-1/2 lg:w-1/4 flex items-center justify-center py-1 bg-green-400 text-white font-semibold",on:{click:function(s){return e.payOrder(t)}}},[s("i",{staticClass:"las la-money-bill-wave text-2xl mr-1"}),e._v(" "),s("span",[e._v(e._s(e.__m("Pay","NsGastro")))])]):e._e(),e._v(" "),s("button",{staticClass:"w-1/2 lg:w-1/4 flex items-center justify-center py-1 elevation-surface border font-semibold",on:{click:function(s){return e.printOrder(t)}}},[s("i",{staticClass:"las la-print text-2xl mr-1"}),e._v(" "),s("span",[e._v(e._s(e.__m("Print","NsGastro")))])]),e._v(" "),s("button",{staticClass:"w-1/2 lg:w-1/4 flex items-center justify-center py-1 elevation-surface border font-semibold",on:{click:function(s){return e.openOrderOption(t)}}},[s("i",{staticClass:"las la-tools text-2xl mr-1"}),e._v(" "),s("span",[e._v(e._s(e.__m("Options","NsGastro")))])])])])])})),0)]):e._e(),e._v(" "),0!==e.orders.length||e.ordersLoaded?e._e():s("div",{staticClass:"w-full flex items-center justify-center flex-auto"},[s("ns-spinner")],1),e._v(" "),0===e.orders.length&&e.ordersLoaded?s("div",{staticClass:"w-full flex-col text-primary flex items-center justify-center flex-auto"},[s("i",{staticClass:"text-6xl las la-frown"}),e._v(" "),e.ns_gastro_enable_table_sessions?e._e():s("h3",{staticClass:"font-semibold text-lg"},[e._v(e._s(e.__m("No orders has been found","NsGastro")))]),e._v(" "),e.ns_gastro_enable_table_sessions?s("div",{staticClass:"flex flex-col items-center"},[s("h3",{staticClass:"font-semibold text-lg"},[e._v(e._s(e.__m("No active sessions were found.","NsGastro")))]),e._v(" "),s("span",{staticClass:"text-sm"},[e._v(e._s(e.__m("Please use the Session History to browse previous sessions","NsGastro")))])]):e._e()]):e._e(),e._v(" "),s("div",{staticClass:"p-2 flex items-center flex-col md:flex-row justify-between border-t ns-box-footer"},[s("div",{staticClass:"flex -mx-2"},[s("div",{staticClass:"px-2"},[s("button",{staticClass:"rounded-lg shadow hover:shadow-none border px-3 py-1 ns-inset-button",on:{click:function(t){return e.showTableHistory(e.selectedTable)}}},[s("i",{staticClass:"las la-sync text-xl"}),e._v(" "),s("span",[e._v(e._s(e.__m("Refresh","NsGastro")))])])]),e._v(" "),"orders"===e.screen?s("div",{staticClass:"px-2"},[s("button",{staticClass:"outline-none rounded-lg px-3 py-1 ns-inset-button border",class:e.hasCustomSettings?"info":"",on:{click:function(t){e.setRange("today"),e.showTableHistory(e.selectedTable)}}},[s("i",{staticClass:"las la-clock text-xl"}),e._v(" "),s("span",[e._v(e._s(e.__m("Today","NsGastro")))])])]):e._e(),e._v(" "),"orders"===e.screen?s("div",{staticClass:"px-2"},[s("button",{staticClass:"outline-none rounded-lg px-3 py-1 ns-inset-button border",class:e.hasCustomSettings?"info":"",on:{click:function(t){e.setRange("yesterday"),e.showTableHistory(e.selectedTable)}}},[s("i",{staticClass:"las la-clock text-xl"}),e._v(" "),s("span",[e._v(e._s(e.__m("From Yesterday","NsGastro")))])])]):e._e()]),e._v(" "),s("div",{staticClass:"w-full md:w-auto mt-2 md:mt-0 md:m-0 flex -mx-2"},[e.selectedTable.busy?s("div",{staticClass:"px-2"},[s("span",{staticClass:"flex-auto justify-center flex items-center rounded cursor-pointer py-2 px-3 font-semibold shadow bg-green-400 text-white",attrs:{type:"info"},on:{click:function(t){return e.setAvailable(e.selectedTable)}}},[e._v(e._s(e.__m("Set Available","NsGastro")))])]):e._e(),e._v(" "),s("div",{staticClass:"px-2"},[s("span",{staticClass:"flex-auto justify-center flex items-center rounded cursor-pointer py-2 px-3 font-semibold shadow bg-blue-400 text-white",attrs:{type:"info"},on:{click:function(t){return e.proceedSelect(e.selectedTable)}}},[e._v(e._s(e.__m("Select Table","NsGastro")))])])])])]):e._e(),e._v(" "),["sessions"].includes(e.screen)?s("div",{staticClass:"overflow-y-auto flex flex-col p-4 flex-auto bg-gray-100"},[s("div",{staticClass:"flex -m-2 flex-wrap"},e._l(e.sessions,(function(t){return s("div",{key:t.id,staticClass:"w-full mb-2 md:w-1/2 p-2"},[s("div",{staticClass:"rounded flex elevation-surface shadow overflow-hidden"},[e._m(0,!0),e._v(" "),s("div",{staticClass:"p-2 flex-auto justify-center flex flex-col"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(t.name||e.__m("Unnamed Session","NsGastro")))]),e._v(" "),s("p",{staticClass:"text-sm"},[e._v(e._s(e.__m("Active : ","NsGastro"))+" "+e._s(t.active?e.__m("Yes","NsGastro"):e.__m("No","NsGastro")))]),e._v(" "),s("p",{staticClass:"text-sm"},[e._v(e._s(e.__m("Orders : ","NsGastro"))+" "+e._s(t.ordersCount))])]),e._v(" "),1===t.active?s("div",{staticClass:"border-l border-box-edge go-w-14 flex hover:bg-error-primary hover:text-white cursor-pointer items-center justify-center",on:{click:function(s){return e.closeSession(t)}}},[s("i",{staticClass:"las la-lock"})]):e._e(),e._v(" "),0===t.active?s("div",{staticClass:"border-l border-box-edge go-w-14 flex hover:bg-info-primary hover:text-white cursor-pointer items-center justify-center",on:{click:function(s){return e.openSession(t)}}},[s("i",{staticClass:"las la-unlock"})]):e._e(),e._v(" "),s("div",{staticClass:"border-l border-box-edge go-w-14 flex hover:bg-blue-400 hover:text-white cursor-pointer items-center justify-center",on:{click:function(s){return e.loadSessionOrders(t)}}},[s("i",{staticClass:"las la-eye"})])])])})),0),e._v(" "),0===e.sessions.length?s("div",{staticClass:"p-2 flex flex-auto overflow-y-auto flex-wrap"},[s("div",{staticClass:"w-full flex-col text-primary flex items-center justify-center flex-auto"},[s("i",{staticClass:"text-9xl las la-frown"}),e._v(" "),s("h3",{staticClass:"font-semibold text-lg"},[e._v(e._s(e.__m("No sessions have been found","NsGastro")))])])]):e._e()]):e._e(),e._v(" "),"tables"===e.screen?s("div",{staticClass:"overflow-y-auto flex",class:0===e.tables.length?"flex-auto":""},[e.tables.length>0?s("div",{staticClass:"w-full grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 anim-duration-500 fade-in-entrance"},e._l(e.tables,(function(t){return s("div",{key:t.id,staticClass:"border cursor-pointer relative flex-col go-h-52 flex items-center justify-center",class:t.selected?"bg-info-secondary border-info-tertiary":t.busy?"border-success-tertiary bg-success-secondary":"border-box-edge",on:{touchstart:function(s){return e.debounceForAvailability(t,s)},touchend:function(t){e.mouseDown=!1},click:function(s){return e.selectQuantity(t)}}},[t.busy?e._e():s("div",{staticClass:"rounded-full -mb-6 go-h-10 w-10 flex items-center justify-center font-bold fond-bold gastro-pill info"},[e._v(e._s(t.seats))]),e._v(" "),t.busy?s("div",{staticClass:"rounded-full text-center -mb-6 go-h-10 px-3 flex items-center justify-center font-bold gastro-pill success"},[e._v(e._s(e.__m("Currently Busy","NsGastro")))]):e._e(),e._v(" "),s("img",{attrs:{src:e.icons.chair}}),e._v(" "),s("h1",[e._v(e._s(t.name))])])})),0):e._e(),e._v(" "),0===e.tables.length&&e.tableLoaded?s("div",{staticClass:"w-full flex flex-col items-center justify-center flex-auto text-primary"},[s("i",{staticClass:"text-9xl las la-frown"}),e._v(" "),s("h3",{staticClass:"font-semibold text-lg"},[e._v(e._s(e.__m("No tables has been found","NsGastro")))])]):e._e(),e._v(" "),0!==e.tables.length||e.tableLoaded?e._e():s("div",{staticClass:"w-full flex items-center justify-center flex-auto"},[s("ns-spinner")],1)]):e._e(),e._v(" "),"areas"===e.screen?s("div",{staticClass:"overflow-y-auto flex",class:0===e.areas.length?"flex-auto":""},[e.areas.length>0?s("div",{staticClass:"w-full grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 anim-duration-500 fade-in-entrance"},e._l(e.areas,(function(t){return s("div",{key:t.id,staticClass:"cursor-pointer border flex-col border-box-edge go-h-52 flex items-center justify-center",on:{click:function(s){return e.loadTables(t)}}},[s("img",{attrs:{src:e.icons.menu}}),e._v(" "),s("h1",{staticClass:"my-3"},[e._v(e._s(t.name))])])})),0):e._e(),e._v(" "),0===e.areas.length&&e.areasLoaded?s("div",{staticClass:"w-full flex-col flex-auto flex items-center justify-center text-primary"},[s("i",{staticClass:"text-9xl las la-frown"}),e._v(" "),s("h3",{staticClass:"font-semibold text-lg"},[e._v(e._s(e.__m("No areas has been found","NsGastro")))])]):e._e(),e._v(" "),0!==e.areas.length||e.areasLoaded?e._e():s("div",{staticClass:"w-full flex items-center justify-center flex-auto"},[s("ns-spinner")],1)]):e._e()])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"p-2 flex items-center justify-center"},[t("div",{staticClass:"go-w-14 go-h-14 rounded-full bg-blue-400 font-bold text-3xl text-white flex items-center justify-center"},[t("i",{staticClass:"las la-stopwatch"})])])}],!1,null,null,null).exports},635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(757),n=s.n(r);function o(e,t,s,r,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const i={name:"gastro-to-kitchen-button",mounted:function(){var e=this;POS.order.subscribe((function(t){e.order=t}))},data:function(){return{order:{}}},methods:{__m:__m,submitToKitchen:function(){var e,t=this;return(e=n().mark((function e(){var s,r,o,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=nsHooks.applyFilters("ns-hold-queue",[ProductsQueue,CustomerQueue,TypeQueue]),e.t0=n().keys(s);case 2:if((e.t1=e.t0()).done){e.next=16;break}return r=e.t1.value,e.prev=4,o=new s[r](t.order),e.next=8,o.run();case 8:e.sent,e.next=14;break;case 11:return e.prev=11,e.t2=e.catch(4),e.abrupt("return",!1);case 14:e.next=2;break;case 16:return t.order.payment_status="hold",POS.order.next(t.order),i=Popup.show(nsPOSLoadingPopup),e.prev=19,e.next=22,POS.submitOrder();case 22:a=e.sent,i.close(),nsSnackBar.success(a.message).subscribe(),e.next=31;break;case 27:e.prev=27,e.t3=e.catch(19),i.close(),nsSnackBar.error(e.t3.message||__m("An unexpected error occured.","NsGastro")).subscribe();case 31:case"end":return e.stop()}}),e,null,[[4,11],[19,27]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function a(e){o(i,r,n,a,c,"next",e)}function c(e){o(i,r,n,a,c,"throw",e)}a(void 0)}))})()}}},a=(0,s(810).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("button",{staticClass:"outline-none flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center go-bg-blue-500 text-white border-r hover:go-bg-blue-600 go-border-blue-600 flex-auto",attrs:{id:"to-kitchen-button"},on:{click:function(t){return e.submitToKitchen()}}},[s("span",[s("i",{staticClass:"las la-utensils text-2xl lg:text-xl"}),e._v(" "),s("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__m("To Kitchen","NsGastro")))])])])}),[],!1,null,null,null).exports},810:(e,t,s)=>{"use strict";function r(e,t,s,r,n,o,i,a){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=s,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}s.d(t,{Z:()=>r})}},s={};function r(e){var n=s[e];if(void 0!==n)return n.exports;var o=s[e]={id:e,exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,s,n,o)=>{if(!s){var i=1/0;for(u=0;u<e.length;u++){for(var[s,n,o]=e[u],a=!0,c=0;c<s.length;c++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](s[c])))?s.splice(c--,1):(a=!1,o<i&&(i=o));if(a){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,n,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={460:0,786:0};r.O.j=t=>0===e[t];var t=(t,s)=>{var n,o,[i,a,c]=s,l=0;if(i.some((t=>0!==e[t]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)var u=c(r)}for(t&&t(s);l<i.length;l++)o=i[l],r.o(e,o)&&e[o]&&e[o][0](),e[i[l]]=0;return r.O(u)},s=self.webpackChunkNsGastro=self.webpackChunkNsGastro||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),r.O(void 0,[786],(()=>r(790)));var n=r.O(void 0,[786],(()=>r(38)));n=r.O(n)})();
